<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Cyber Evidence Board</title>
  <link rel="icon" href="https://emojicdn.elk.sh/üîç">
  <meta name="description" content="Drag logs and connect the evidence to solve the case">
  <meta property="og:title" content="Cyber Evidence Board">
  <meta property="og:description" content="Drag logs and connect the evidence to solve the case">
  <meta property="og:image" content="https://emojicdn.elk.sh/üîç?style=google">
  <meta property="og:url" content="https://app.sloppy.live/evidence-board">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Orbitron:wght@700&display=swap');

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      min-height: 100vh;
      background: #0a0a0f;
      font-family: 'Share Tech Mono', monospace;
      color: #fff;
      overflow: hidden;
    }

    /* Cork board texture */
    .board {
      width: 100vw;
      height: 100vh;
      background:
        repeating-linear-gradient(
          0deg,
          transparent,
          transparent 2px,
          rgba(255,0,0,0.03) 2px,
          rgba(255,0,0,0.03) 4px
        ),
        repeating-linear-gradient(
          90deg,
          transparent,
          transparent 2px,
          rgba(255,0,0,0.03) 2px,
          rgba(255,0,0,0.03) 4px
        ),
        linear-gradient(135deg, #0a0a12 0%, #12080a 50%, #0a0a12 100%);
      position: relative;
      cursor: crosshair;
    }

    /* Header */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      padding: 15px 20px;
      background: linear-gradient(180deg, rgba(10,10,15,0.95) 0%, transparent 100%);
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 100;
      pointer-events: none;
    }

    .header > * {
      pointer-events: auto;
    }

    .title {
      font-family: 'Orbitron', sans-serif;
      font-size: 1.2rem;
      color: #f00;
      text-shadow: 0 0 20px #f00, 0 0 40px #f00;
      letter-spacing: 4px;
    }

    .case-id {
      font-size: 0.7rem;
      color: #666;
      letter-spacing: 2px;
    }

    .back-link {
      color: rgba(255,255,255,0.3);
      text-decoration: none;
      font-size: 0.8rem;
    }

    /* Toolbar */
    .toolbar {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      padding: 10px 15px;
      background: rgba(10,10,15,0.9);
      border: 1px solid #f00;
      border-radius: 30px;
      box-shadow: 0 0 30px rgba(255,0,0,0.3);
      z-index: 100;
    }

    .tool-btn {
      padding: 10px 15px;
      background: transparent;
      border: 1px solid #444;
      border-radius: 20px;
      color: #888;
      font-family: 'Share Tech Mono', monospace;
      font-size: 0.75rem;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .tool-btn:hover {
      border-color: #f00;
      color: #f00;
      box-shadow: 0 0 15px rgba(255,0,0,0.3);
    }

    .tool-btn.active {
      background: rgba(255,0,0,0.2);
      border-color: #f00;
      color: #f00;
    }

    /* SVG for connections */
    #connections {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 1;
    }

    .connection-line {
      stroke: #f00;
      stroke-width: 2;
      fill: none;
      filter: drop-shadow(0 0 5px #f00);
      stroke-dasharray: 8 4;
      animation: dashMove 1s linear infinite;
    }

    @keyframes dashMove {
      to { stroke-dashoffset: -12; }
    }

    /* Evidence cards */
    .evidence {
      position: absolute;
      background: linear-gradient(145deg, #1a1a20 0%, #0f0f12 100%);
      border: 2px solid #333;
      border-radius: 8px;
      padding: 12px;
      min-width: 180px;
      max-width: 250px;
      cursor: move;
      z-index: 10;
      box-shadow: 0 5px 20px rgba(0,0,0,0.5);
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    .evidence:hover {
      border-color: #f00;
      box-shadow: 0 5px 30px rgba(255,0,0,0.3);
    }

    .evidence.selected {
      border-color: #0ff;
      box-shadow: 0 0 20px rgba(0,255,255,0.5);
    }

    .evidence.connecting {
      border-color: #ff0;
      box-shadow: 0 0 20px rgba(255,255,0,0.5);
      animation: pulse 0.5s ease infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.02); }
    }

    .evidence-pin {
      position: absolute;
      top: -8px;
      left: 50%;
      transform: translateX(-50%);
      width: 16px;
      height: 16px;
      background: radial-gradient(circle at 30% 30%, #f44, #a00);
      border-radius: 50%;
      box-shadow: 0 2px 5px rgba(0,0,0,0.5), 0 0 10px #f00;
    }

    .evidence-type {
      font-size: 0.6rem;
      color: #666;
      text-transform: uppercase;
      letter-spacing: 2px;
      margin-bottom: 6px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .evidence-type .icon {
      font-size: 0.9rem;
    }

    .evidence-title {
      font-size: 0.9rem;
      color: #0ff;
      text-shadow: 0 0 10px #0ff;
      margin-bottom: 8px;
      word-break: break-all;
    }

    .evidence-content {
      font-size: 0.7rem;
      color: #888;
      line-height: 1.5;
    }

    .evidence-content .highlight {
      color: #f00;
      text-shadow: 0 0 5px #f00;
    }

    .evidence-time {
      font-size: 0.6rem;
      color: #444;
      margin-top: 8px;
      border-top: 1px solid #222;
      padding-top: 6px;
    }

    /* Type-specific colors */
    .evidence.type-log .evidence-title { color: #0f0; text-shadow: 0 0 10px #0f0; }
    .evidence.type-ip .evidence-title { color: #f90; text-shadow: 0 0 10px #f90; }
    .evidence.type-suspect .evidence-title { color: #f0f; text-shadow: 0 0 10px #f0f; }
    .evidence.type-file .evidence-title { color: #0ff; text-shadow: 0 0 10px #0ff; }
    .evidence.type-alert .evidence-title { color: #f00; text-shadow: 0 0 10px #f00; }

    .evidence.type-log { border-left: 3px solid #0f0; }
    .evidence.type-ip { border-left: 3px solid #f90; }
    .evidence.type-suspect { border-left: 3px solid #f0f; }
    .evidence.type-file { border-left: 3px solid #0ff; }
    .evidence.type-alert { border-left: 3px solid #f00; }

    /* Delete button */
    .evidence-delete {
      position: absolute;
      top: 5px;
      right: 5px;
      width: 20px;
      height: 20px;
      background: transparent;
      border: none;
      color: #444;
      font-size: 1rem;
      cursor: pointer;
      opacity: 0;
      transition: all 0.2s;
    }

    .evidence:hover .evidence-delete {
      opacity: 1;
    }

    .evidence-delete:hover {
      color: #f00;
    }

    /* Add evidence modal */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.8);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 200;
    }

    .modal.open {
      display: flex;
    }

    .modal-content {
      background: linear-gradient(145deg, #1a1a20 0%, #0f0f12 100%);
      border: 2px solid #f00;
      border-radius: 12px;
      padding: 25px;
      width: 350px;
      box-shadow: 0 0 50px rgba(255,0,0,0.3);
    }

    .modal-title {
      font-family: 'Orbitron', sans-serif;
      color: #f00;
      text-shadow: 0 0 10px #f00;
      margin-bottom: 20px;
      text-align: center;
    }

    .form-group {
      margin-bottom: 15px;
    }

    .form-label {
      display: block;
      font-size: 0.7rem;
      color: #666;
      margin-bottom: 5px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .form-input, .form-select, .form-textarea {
      width: 100%;
      padding: 10px;
      background: #0a0a0f;
      border: 1px solid #333;
      border-radius: 6px;
      color: #fff;
      font-family: 'Share Tech Mono', monospace;
      font-size: 0.85rem;
    }

    .form-input:focus, .form-select:focus, .form-textarea:focus {
      outline: none;
      border-color: #f00;
      box-shadow: 0 0 10px rgba(255,0,0,0.3);
    }

    .form-textarea {
      height: 80px;
      resize: none;
    }

    .form-select {
      cursor: pointer;
    }

    .modal-btns {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }

    .modal-btn {
      flex: 1;
      padding: 12px;
      border: 1px solid;
      border-radius: 6px;
      font-family: 'Share Tech Mono', monospace;
      font-size: 0.8rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .modal-btn.primary {
      background: rgba(255,0,0,0.2);
      border-color: #f00;
      color: #f00;
    }

    .modal-btn.primary:hover {
      background: rgba(255,0,0,0.4);
    }

    .modal-btn.secondary {
      background: transparent;
      border-color: #444;
      color: #888;
    }

    .modal-btn.secondary:hover {
      border-color: #888;
      color: #fff;
    }

    /* Instructions */
    .instructions {
      position: fixed;
      bottom: 80px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 0.6rem;
      color: #333;
      text-align: center;
      letter-spacing: 1px;
    }

    /* Connection mode indicator */
    .connect-mode {
      position: fixed;
      top: 60px;
      left: 50%;
      transform: translateX(-50%);
      padding: 8px 20px;
      background: rgba(255,255,0,0.2);
      border: 1px solid #ff0;
      border-radius: 20px;
      color: #ff0;
      font-size: 0.7rem;
      display: none;
      z-index: 100;
    }

    .connect-mode.active {
      display: block;
      animation: blink 1s ease infinite;
    }

    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
  </style>
</head>
<body>
  <div class="header">
    <a href="https://sloppy.live" class="back-link">‚Üê exit</a>
    <div>
      <div class="title">CYBER EVIDENCE BOARD</div>
      <div class="case-id">CASE #2026-NX-4471</div>
    </div>
    <div style="width: 50px;"></div>
  </div>

  <div class="connect-mode" id="connectMode">SELECT TARGET EVIDENCE</div>

  <div class="board" id="board">
    <svg id="connections"></svg>
  </div>

  <div class="toolbar">
    <button class="tool-btn" onclick="openAddModal()">
      <span>‚ûï</span> Add Evidence
    </button>
    <button class="tool-btn" id="connectBtn" onclick="toggleConnectMode()">
      <span>üîó</span> Connect
    </button>
    <button class="tool-btn" onclick="clearConnections()">
      <span>‚úÇÔ∏è</span> Clear Lines
    </button>
    <button class="tool-btn" onclick="resetBoard()">
      <span>üóëÔ∏è</span> Reset
    </button>
  </div>

  <div class="instructions">
    DRAG TO MOVE ‚Ä¢ CLICK CONNECT THEN TWO CARDS TO LINK ‚Ä¢ DOUBLE-CLICK TO EDIT
  </div>

  <!-- Add Evidence Modal -->
  <div class="modal" id="addModal">
    <div class="modal-content">
      <div class="modal-title">ADD EVIDENCE</div>
      <div class="form-group">
        <label class="form-label">Type</label>
        <select class="form-select" id="evidenceType">
          <option value="log">System Log</option>
          <option value="ip">IP Address</option>
          <option value="suspect">Suspect</option>
          <option value="file">File</option>
          <option value="alert">Alert</option>
        </select>
      </div>
      <div class="form-group">
        <label class="form-label">Title</label>
        <input type="text" class="form-input" id="evidenceTitle" placeholder="e.g., SSH Login Attempt">
      </div>
      <div class="form-group">
        <label class="form-label">Details</label>
        <textarea class="form-textarea" id="evidenceDetails" placeholder="Enter evidence details..."></textarea>
      </div>
      <div class="modal-btns">
        <button class="modal-btn secondary" onclick="closeAddModal()">Cancel</button>
        <button class="modal-btn primary" onclick="addEvidence()">Add Evidence</button>
      </div>
    </div>
  </div>

  <script>
    // State
    let evidence = [];
    let connections = [];
    let connectMode = false;
    let connectSource = null;
    let dragTarget = null;
    let dragOffset = { x: 0, y: 0 };
    let idCounter = 0;

    // Initial evidence
    const initialEvidence = [
      {
        type: 'alert',
        title: 'INTRUSION DETECTED',
        content: 'Unauthorized access attempt on <span class="highlight">PORT 22</span> from external IP',
        time: '2026-01-12 03:42:17 UTC',
        x: 100, y: 120
      },
      {
        type: 'ip',
        title: '192.168.1.105',
        content: 'Internal workstation - Finance Dept<br>User: <span class="highlight">jsmith</span>',
        time: 'Last seen: 2026-01-12 03:41:55',
        x: 350, y: 100
      },
      {
        type: 'ip',
        title: '45.33.32.156',
        content: 'External IP - <span class="highlight">TOR Exit Node</span><br>Location: Unknown (Proxy)',
        time: 'Flagged: High Risk',
        x: 600, y: 150
      },
      {
        type: 'log',
        title: 'auth.log Entry',
        content: 'Failed password for root from 45.33.32.156<br>Attempts: <span class="highlight">347</span>',
        time: '2026-01-12 03:42:17 UTC',
        x: 150, y: 320
      },
      {
        type: 'suspect',
        title: 'INSIDER THREAT?',
        content: 'User jsmith accessed server room<br><span class="highlight">After hours</span> (02:30 AM)',
        time: 'Badge scan: 2026-01-12 02:31:04',
        x: 400, y: 350
      },
      {
        type: 'file',
        title: 'exfil_data.zip',
        content: 'Encrypted archive found on USB<br>Size: <span class="highlight">2.4 GB</span><br>Hash: 7f3a9c...',
        time: 'Created: 2026-01-12 02:58:33',
        x: 650, y: 380
      },
      {
        type: 'log',
        title: 'firewall.log',
        content: 'Outbound connection blocked<br>Dest: <span class="highlight">darkweb.onion</span><br>Proto: HTTPS',
        time: '2026-01-12 03:15:22 UTC',
        x: 100, y: 500
      },
      {
        type: 'alert',
        title: 'DATA EXFILTRATION',
        content: '<span class="highlight">15GB</span> transferred to external<br>Duration: 47 minutes',
        time: '2026-01-12 02:30 - 03:17 UTC',
        x: 380, y: 550
      }
    ];

    // Initialize board
    function init() {
      const saved = localStorage.getItem('evidenceBoard');
      if (saved) {
        const data = JSON.parse(saved);
        evidence = data.evidence || [];
        connections = data.connections || [];
        idCounter = data.idCounter || 0;
      } else {
        evidence = initialEvidence.map((e, i) => ({ ...e, id: i }));
        idCounter = evidence.length;
      }

      renderEvidence();
      renderConnections();
    }

    // Save state
    function saveState() {
      localStorage.setItem('evidenceBoard', JSON.stringify({
        evidence,
        connections,
        idCounter
      }));
    }

    // Render evidence cards
    function renderEvidence() {
      // Remove existing cards
      document.querySelectorAll('.evidence').forEach(el => el.remove());

      evidence.forEach(e => {
        const card = document.createElement('div');
        card.className = `evidence type-${e.type}`;
        card.dataset.id = e.id;
        card.style.left = e.x + 'px';
        card.style.top = e.y + 'px';

        const typeLabels = {
          log: 'üìã System Log',
          ip: 'üåê IP Address',
          suspect: 'üë§ Suspect',
          file: 'üìÅ File',
          alert: '‚ö†Ô∏è Alert'
        };

        card.innerHTML = `
          <div class="evidence-pin"></div>
          <button class="evidence-delete" onclick="deleteEvidence(${e.id})">√ó</button>
          <div class="evidence-type">
            <span class="icon">${typeLabels[e.type].split(' ')[0]}</span>
            ${typeLabels[e.type].split(' ').slice(1).join(' ')}
          </div>
          <div class="evidence-title">${e.title}</div>
          <div class="evidence-content">${e.content}</div>
          <div class="evidence-time">${e.time}</div>
        `;

        // Drag handlers
        card.addEventListener('mousedown', (ev) => startDrag(ev, card, e));
        card.addEventListener('touchstart', (ev) => startDrag(ev, card, e));

        // Connection handler
        card.addEventListener('click', (ev) => {
          if (connectMode) {
            handleConnect(e.id);
            ev.stopPropagation();
          }
        });

        document.getElementById('board').appendChild(card);
      });
    }

    // Render connection lines
    function renderConnections() {
      const svg = document.getElementById('connections');
      svg.innerHTML = '';

      connections.forEach(conn => {
        const source = evidence.find(e => e.id === conn.from);
        const target = evidence.find(e => e.id === conn.to);
        if (!source || !target) return;

        const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
        line.classList.add('connection-line');

        // Calculate center points
        const sourceCard = document.querySelector(`[data-id="${conn.from}"]`);
        const targetCard = document.querySelector(`[data-id="${conn.to}"]`);

        if (sourceCard && targetCard) {
          const sx = source.x + sourceCard.offsetWidth / 2;
          const sy = source.y + sourceCard.offsetHeight / 2;
          const tx = target.x + targetCard.offsetWidth / 2;
          const ty = target.y + targetCard.offsetHeight / 2;

          line.setAttribute('x1', sx);
          line.setAttribute('y1', sy);
          line.setAttribute('x2', tx);
          line.setAttribute('y2', ty);

          svg.appendChild(line);
        }
      });
    }

    // Drag functionality
    function startDrag(e, card, data) {
      if (connectMode) return;

      e.preventDefault();
      dragTarget = { card, data };

      const clientX = e.touches ? e.touches[0].clientX : e.clientX;
      const clientY = e.touches ? e.touches[0].clientY : e.clientY;

      dragOffset.x = clientX - data.x;
      dragOffset.y = clientY - data.y;

      card.style.zIndex = 50;
    }

    document.addEventListener('mousemove', handleDrag);
    document.addEventListener('touchmove', handleDrag);

    function handleDrag(e) {
      if (!dragTarget) return;

      const clientX = e.touches ? e.touches[0].clientX : e.clientX;
      const clientY = e.touches ? e.touches[0].clientY : e.clientY;

      dragTarget.data.x = clientX - dragOffset.x;
      dragTarget.data.y = clientY - dragOffset.y;

      dragTarget.card.style.left = dragTarget.data.x + 'px';
      dragTarget.card.style.top = dragTarget.data.y + 'px';

      renderConnections();
    }

    document.addEventListener('mouseup', endDrag);
    document.addEventListener('touchend', endDrag);

    function endDrag() {
      if (dragTarget) {
        dragTarget.card.style.zIndex = 10;
        dragTarget = null;
        saveState();
      }
    }

    // Connection mode
    function toggleConnectMode() {
      connectMode = !connectMode;
      connectSource = null;

      document.getElementById('connectBtn').classList.toggle('active', connectMode);
      document.getElementById('connectMode').classList.toggle('active', connectMode);

      document.querySelectorAll('.evidence').forEach(el => {
        el.classList.remove('connecting', 'selected');
      });
    }

    function handleConnect(id) {
      if (!connectSource) {
        connectSource = id;
        document.querySelector(`[data-id="${id}"]`).classList.add('connecting');
        document.getElementById('connectMode').textContent = 'SELECT TARGET EVIDENCE';
      } else {
        if (connectSource !== id) {
          // Check if connection exists
          const exists = connections.some(c =>
            (c.from === connectSource && c.to === id) ||
            (c.from === id && c.to === connectSource)
          );

          if (!exists) {
            connections.push({ from: connectSource, to: id });
            renderConnections();
            saveState();
          }
        }

        // Reset
        document.querySelectorAll('.evidence').forEach(el => el.classList.remove('connecting'));
        connectSource = null;
        document.getElementById('connectMode').textContent = 'SELECT SOURCE EVIDENCE';
      }
    }

    // Clear connections
    function clearConnections() {
      connections = [];
      renderConnections();
      saveState();
    }

    // Add evidence modal
    function openAddModal() {
      document.getElementById('addModal').classList.add('open');
      document.getElementById('evidenceTitle').value = '';
      document.getElementById('evidenceDetails').value = '';
    }

    function closeAddModal() {
      document.getElementById('addModal').classList.remove('open');
    }

    function addEvidence() {
      const type = document.getElementById('evidenceType').value;
      const title = document.getElementById('evidenceTitle').value.trim();
      const details = document.getElementById('evidenceDetails').value.trim();

      if (!title) {
        alert('Please enter a title');
        return;
      }

      const newEvidence = {
        id: idCounter++,
        type,
        title,
        content: details.replace(/\n/g, '<br>'),
        time: new Date().toISOString().replace('T', ' ').substring(0, 19) + ' UTC',
        x: 200 + Math.random() * 300,
        y: 150 + Math.random() * 200
      };

      evidence.push(newEvidence);
      renderEvidence();
      saveState();
      closeAddModal();
    }

    // Delete evidence
    function deleteEvidence(id) {
      evidence = evidence.filter(e => e.id !== id);
      connections = connections.filter(c => c.from !== id && c.to !== id);
      renderEvidence();
      renderConnections();
      saveState();
    }

    // Reset board
    function resetBoard() {
      if (confirm('Reset board to initial state?')) {
        localStorage.removeItem('evidenceBoard');
        evidence = initialEvidence.map((e, i) => ({ ...e, id: i }));
        connections = [];
        idCounter = evidence.length;
        renderEvidence();
        renderConnections();
        saveState();
      }
    }

    // Keyboard shortcuts
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        if (connectMode) toggleConnectMode();
        closeAddModal();
      }
    });

    // Click outside to deselect
    document.getElementById('board').addEventListener('click', (e) => {
      if (e.target.id === 'board' || e.target.id === 'connections') {
        if (connectMode) {
          toggleConnectMode();
        }
      }
    });

    // Initialize
    init();
  </script>
<script src="/sloppy-header/sloppy-bar.js"></script>
</body>
</html>
