<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nutribullet Simulator</title>
  <link rel="icon" href="https://emojicdn.elk.sh/ü•§">

  <meta property="og:title" content="Nutribullet Simulator">
  <meta property="og:description" content="Blend anything from kale to car keys. What could go wrong?">
  <meta property="og:url" content="https://app.sloppy.live/nutribullet">
  <meta property="og:image" content="https://app.sloppy.live/nutribullet/og-image.png">
  <meta property="og:type" content="website">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Archivo+Black&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Space Mono', monospace;
      min-height: 100vh;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
      color: #fff;
      overflow-x: hidden;
    }

    #app {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    h1 {
      font-family: 'Archivo Black', sans-serif;
      font-size: 2.5rem;
      text-align: center;
      margin-bottom: 10px;
      background: linear-gradient(90deg, #ff6b6b, #feca57, #48dbfb);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .subtitle {
      text-align: center;
      color: #888;
      margin-bottom: 25px;
      font-size: 14px;
    }

    .main-area {
      display: flex;
      gap: 20px;
      flex: 1;
      align-items: flex-start;
    }

    /* Blender */
    .blender-section {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .blender {
      position: relative;
      width: 220px;
      margin-bottom: 20px;
    }

    .blender-lid {
      width: 140px;
      height: 30px;
      background: linear-gradient(180deg, #2d2d2d 0%, #1a1a1a 100%);
      border-radius: 10px 10px 0 0;
      margin: 0 auto;
      position: relative;
      z-index: 10;
      border: 2px solid #444;
      border-bottom: none;
      cursor: pointer;
      transition: transform 0.2s;
    }

    .blender-lid:hover {
      transform: translateY(-3px);
    }

    .blender-lid.open {
      transform: translateY(-20px) rotateX(30deg);
    }

    .blender-container {
      width: 180px;
      height: 280px;
      background: linear-gradient(90deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.1) 100%);
      border: 3px solid rgba(255,255,255,0.3);
      border-radius: 20px 20px 40px 40px;
      margin: 0 auto;
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(5px);
    }

    .blender-container::before {
      content: '';
      position: absolute;
      left: 10px;
      top: 10px;
      bottom: 10px;
      width: 20px;
      background: linear-gradient(90deg, rgba(255,255,255,0.3), transparent);
      border-radius: 10px;
    }

    .blend-contents {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 0;
      transition: height 0.3s ease, background 0.5s ease;
      border-radius: 0 0 37px 37px;
    }

    .blend-contents.metallic {
      background: linear-gradient(180deg, #8e9eab 0%, #485563 50%, #2c3e50 100%) !important;
      box-shadow: inset 0 0 20px rgba(255,255,255,0.3);
    }

    .blend-contents.radioactive {
      background: linear-gradient(180deg, #a8e063 0%, #56ab2f 50%, #2ecc71 100%) !important;
      box-shadow: 0 0 20px rgba(46, 204, 113, 0.6), inset 0 0 30px rgba(168, 224, 99, 0.4);
      animation: glow 1s ease-in-out infinite alternate;
    }

    .blend-contents.cursed {
      background: linear-gradient(180deg, #2c3e50 0%, #1a1a2e 50%, #0d0d14 100%) !important;
      box-shadow: 0 0 30px rgba(142, 68, 173, 0.5), inset 0 0 20px rgba(0,0,0,0.8);
    }

    .blend-contents.bloody {
      background: linear-gradient(180deg, #c0392b 0%, #8b0000 50%, #4a0000 100%) !important;
    }

    .blend-contents.fire {
      background: linear-gradient(180deg, #f39c12 0%, #e74c3c 50%, #c0392b 100%) !important;
      box-shadow: 0 0 25px rgba(243, 156, 18, 0.5);
      animation: firePulse 0.5s ease-in-out infinite alternate;
    }

    @keyframes glow {
      from { box-shadow: 0 0 20px rgba(46, 204, 113, 0.4), inset 0 0 30px rgba(168, 224, 99, 0.3); }
      to { box-shadow: 0 0 40px rgba(46, 204, 113, 0.8), inset 0 0 40px rgba(168, 224, 99, 0.6); }
    }

    @keyframes firePulse {
      from { box-shadow: 0 0 20px rgba(243, 156, 18, 0.4); }
      to { box-shadow: 0 0 35px rgba(231, 76, 60, 0.7); }
    }

    /* Glass cracks overlay */
    .glass-cracks {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      pointer-events: none;
      z-index: 20;
      opacity: 0;
      transition: opacity 0.3s;
    }

    .glass-cracks.show {
      opacity: 1;
    }

    .crack {
      position: absolute;
      background: rgba(255,255,255,0.8);
      transform-origin: center;
    }

    .crack-1 {
      width: 2px;
      height: 80px;
      top: 20px;
      left: 40px;
      transform: rotate(25deg);
      box-shadow: 0 0 3px rgba(255,255,255,0.5);
    }

    .crack-2 {
      width: 2px;
      height: 60px;
      top: 60px;
      left: 35px;
      transform: rotate(-15deg);
    }

    .crack-3 {
      width: 2px;
      height: 100px;
      top: 30px;
      right: 50px;
      transform: rotate(-30deg);
      box-shadow: 0 0 3px rgba(255,255,255,0.5);
    }

    .crack-4 {
      width: 2px;
      height: 50px;
      top: 100px;
      right: 45px;
      transform: rotate(20deg);
    }

    .crack-5 {
      width: 60px;
      height: 2px;
      top: 80px;
      left: 30px;
      transform: rotate(10deg);
    }

    .crack-radial {
      width: 40px;
      height: 40px;
      top: 50px;
      left: 60px;
      background: transparent;
      border: 2px solid rgba(255,255,255,0.6);
      border-radius: 50%;
      box-shadow: 0 0 10px rgba(255,255,255,0.3);
    }

    /* Smoke effect */
    .smoke-container {
      position: absolute;
      top: -60px;
      left: 50%;
      transform: translateX(-50%);
      width: 100px;
      height: 80px;
      pointer-events: none;
      z-index: 25;
      overflow: visible;
    }

    .smoke-particle {
      position: absolute;
      width: 30px;
      height: 30px;
      background: radial-gradient(circle, rgba(100,100,100,0.6) 0%, transparent 70%);
      border-radius: 50%;
      animation: smokeRise 2s ease-out infinite;
    }

    .smoke-particle:nth-child(2) {
      left: 20px;
      animation-delay: 0.3s;
      width: 25px;
      height: 25px;
    }

    .smoke-particle:nth-child(3) {
      left: 40px;
      animation-delay: 0.6s;
      width: 35px;
      height: 35px;
    }

    .smoke-particle:nth-child(4) {
      left: 60px;
      animation-delay: 0.9s;
    }

    @keyframes smokeRise {
      0% {
        opacity: 0.8;
        transform: translateY(0) scale(0.5);
      }
      50% {
        opacity: 0.5;
      }
      100% {
        opacity: 0;
        transform: translateY(-80px) scale(1.5);
      }
    }

    /* Fire effect */
    .fire-container {
      position: absolute;
      bottom: 50%;
      left: 50%;
      transform: translateX(-50%);
      width: 80px;
      height: 100px;
      pointer-events: none;
      z-index: 15;
    }

    .flame {
      position: absolute;
      bottom: 0;
      border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
      animation: flicker 0.3s ease-in-out infinite alternate;
    }

    .flame-1 {
      left: 50%;
      transform: translateX(-50%);
      width: 40px;
      height: 60px;
      background: linear-gradient(0deg, #ff4500 0%, #ff6b35 50%, #ffd700 100%);
      box-shadow: 0 0 30px #ff4500, 0 0 60px #ff6b35;
    }

    .flame-2 {
      left: 30%;
      width: 25px;
      height: 40px;
      background: linear-gradient(0deg, #ff6b35 0%, #ffd700 100%);
      animation-delay: 0.1s;
    }

    .flame-3 {
      right: 30%;
      width: 25px;
      height: 45px;
      background: linear-gradient(0deg, #ff6b35 0%, #ffd700 100%);
      animation-delay: 0.2s;
    }

    @keyframes flicker {
      0% {
        transform: translateX(-50%) scaleY(1) scaleX(1);
        opacity: 1;
      }
      100% {
        transform: translateX(-50%) scaleY(1.1) scaleX(0.9);
        opacity: 0.8;
      }
    }

    /* Warning flash */
    .blender-container.danger {
      animation: dangerFlash 0.2s ease-in-out infinite alternate;
    }

    @keyframes dangerFlash {
      from { border-color: rgba(255,255,255,0.3); }
      to { border-color: rgba(255,0,0,0.8); }
    }

    /* Explosion effect */
    .explosion {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 200px;
      height: 200px;
      background: radial-gradient(circle, rgba(255,200,0,0.9) 0%, rgba(255,100,0,0.6) 40%, transparent 70%);
      border-radius: 50%;
      pointer-events: none;
      z-index: 30;
      animation: explode 0.5s ease-out forwards;
    }

    @keyframes explode {
      0% {
        transform: translate(-50%, -50%) scale(0);
        opacity: 1;
      }
      100% {
        transform: translate(-50%, -50%) scale(2);
        opacity: 0;
      }
    }

    .blender-base {
      width: 200px;
      height: 60px;
      background: linear-gradient(180deg, #3d3d3d 0%, #1a1a1a 100%);
      border-radius: 10px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 2px solid #555;
    }

    .blend-btn {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      border: none;
      background: linear-gradient(145deg, #ff4757 0%, #c0392b 100%);
      color: #fff;
      font-family: 'Archivo Black', sans-serif;
      font-size: 10px;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(255,71,87,0.4);
      transition: all 0.2s;
    }

    .blend-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 20px rgba(255,71,87,0.6);
    }

    .blend-btn:active, .blend-btn.blending {
      transform: scale(0.95);
      background: linear-gradient(145deg, #c0392b 0%, #922b21 100%);
    }

    /* Ingredient items inside blender */
    .ingredient-item {
      position: absolute;
      font-size: 28px;
      transition: none;
      z-index: 5;
      user-select: none;
      filter: drop-shadow(1px 1px 2px rgba(0,0,0,0.3));
    }

    .ingredient-item.blending {
      animation: spin 0.1s linear infinite;
    }

    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    /* Splatter effects */
    .splatter {
      position: absolute;
      border-radius: 50%;
      pointer-events: none;
      animation: splatFade 1s ease-out forwards;
    }

    @keyframes splatFade {
      0% { opacity: 1; transform: scale(1); }
      100% { opacity: 0; transform: scale(1.5); }
    }

    /* Ingredients panel */
    .ingredients-panel {
      width: 320px;
      background: rgba(10, 10, 20, 0.6);
      border-radius: 20px;
      padding: 0;
      border: 1px solid rgba(255,255,255,0.08);
      overflow: hidden;
      backdrop-filter: blur(10px);
    }

    .panel-header {
      padding: 15px 20px;
      background: rgba(255,255,255,0.03);
      border-bottom: 1px solid rgba(255,255,255,0.05);
    }

    .panel-header h3 {
      font-size: 13px;
      margin: 0;
      color: #fff;
      text-transform: uppercase;
      letter-spacing: 2px;
      font-weight: 400;
    }

    /* Category tabs */
    .category-tabs {
      display: flex;
      padding: 0;
      background: rgba(0,0,0,0.3);
      border-bottom: 1px solid rgba(255,255,255,0.05);
    }

    .category-tab {
      flex: 1;
      padding: 12px 8px;
      background: none;
      border: none;
      color: #666;
      font-size: 18px;
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
    }

    .category-tab:hover {
      background: rgba(255,255,255,0.05);
      color: #999;
    }

    .category-tab.active {
      color: #fff;
      background: rgba(255,255,255,0.08);
    }

    .category-tab.active::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 20%;
      right: 20%;
      height: 2px;
      border-radius: 2px;
    }

    .category-tab[data-category="normal"].active::after { background: #4a7c59; }
    .category-tab[data-category="questionable"].active::after { background: #f39c12; }
    .category-tab[data-category="weird"].active::after { background: #9b59b6; }
    .category-tab[data-category="cursed"].active::after { background: #e74c3c; }

    .category-tab .tab-tooltip {
      position: absolute;
      bottom: calc(100% + 8px);
      left: 50%;
      transform: translateX(-50%);
      background: #1a1a2e;
      color: #fff;
      padding: 6px 10px;
      border-radius: 6px;
      font-size: 10px;
      white-space: nowrap;
      opacity: 0;
      visibility: hidden;
      transition: all 0.2s;
      pointer-events: none;
      border: 1px solid rgba(255,255,255,0.1);
    }

    .category-tab:hover .tab-tooltip {
      opacity: 1;
      visibility: visible;
    }

    /* Ingredient grid container */
    .ingredients-container {
      padding: 15px;
      min-height: 180px;
    }

    .ingredient-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
      display: none;
    }

    .ingredient-grid.active {
      display: grid;
      animation: fadeIn 0.2s ease-out;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(5px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .ingredient-btn {
      aspect-ratio: 1;
      border: none;
      background: rgba(255,255,255,0.06);
      border-radius: 12px;
      font-size: 26px;
      cursor: pointer;
      transition: all 0.15s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
      border: 2px solid transparent;
    }

    .ingredient-btn:hover {
      background: rgba(255,255,255,0.12);
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.3);
    }

    .ingredient-btn:active {
      transform: translateY(0) scale(0.95);
    }

    .ingredient-btn .ing-tooltip {
      position: absolute;
      bottom: calc(100% + 8px);
      left: 50%;
      transform: translateX(-50%);
      background: #1a1a2e;
      color: #fff;
      padding: 5px 10px;
      border-radius: 6px;
      font-size: 10px;
      font-family: 'Space Mono', monospace;
      white-space: nowrap;
      opacity: 0;
      visibility: hidden;
      transition: all 0.15s;
      pointer-events: none;
      border: 1px solid rgba(255,255,255,0.15);
      z-index: 50;
    }

    .ingredient-btn:hover .ing-tooltip {
      opacity: 1;
      visibility: visible;
    }

    /* Category-specific button tints */
    .ingredient-btn.normal-item:hover { border-color: rgba(74, 124, 89, 0.5); }
    .ingredient-btn.questionable-item:hover { border-color: rgba(243, 156, 18, 0.5); }
    .ingredient-btn.weird-item:hover { border-color: rgba(155, 89, 182, 0.5); }
    .ingredient-btn.cursed-item:hover { border-color: rgba(231, 76, 60, 0.5); }

    /* Category label below grid */
    .category-label {
      text-align: center;
      padding: 10px;
      font-size: 10px;
      color: #555;
      text-transform: uppercase;
      letter-spacing: 1px;
      border-top: 1px solid rgba(255,255,255,0.05);
      margin-top: 10px;
    }

    /* Result panel */
    .result-panel {
      margin-top: 20px;
      background: rgba(255,255,255,0.05);
      border-radius: 15px;
      padding: 20px;
      text-align: center;
      display: none;
    }

    .result-panel.show {
      display: block;
      animation: slideUp 0.3s ease-out;
    }

    @keyframes slideUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .result-name {
      font-family: 'Archivo Black', sans-serif;
      font-size: 1.5rem;
      margin-bottom: 10px;
      color: #feca57;
    }

    .result-description {
      color: #888;
      font-size: 14px;
      line-height: 1.5;
    }

    .result-rating {
      margin-top: 15px;
      font-size: 12px;
      color: #48dbfb;
    }

    /* Clear button */
    .clear-btn {
      margin-top: 15px;
      padding: 10px 25px;
      background: rgba(255,255,255,0.1);
      border: 1px solid rgba(255,255,255,0.2);
      color: #fff;
      border-radius: 20px;
      cursor: pointer;
      font-family: 'Space Mono', monospace;
      font-size: 12px;
      transition: all 0.2s;
    }

    .clear-btn:hover {
      background: rgba(255,255,255,0.2);
    }

    /* Shake animation */
    .blender.shaking {
      animation: shake 0.1s linear infinite;
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px) rotate(-1deg); }
      75% { transform: translateX(5px) rotate(1deg); }
    }

    /* Backlink */
    #backlink {
      position: fixed;
      bottom: 15px;
      left: 15px;
      color: rgba(255,255,255,0.4);
      font-size: 12px;
      text-decoration: none;
      transition: color 0.2s;
    }

    #backlink:hover {
      color: rgba(255,255,255,0.8);
    }

    /* Responsive */
    @media (max-width: 700px) {
      .main-area {
        flex-direction: column;
        align-items: center;
      }

      .ingredients-panel {
        width: 100%;
        order: -1;
        margin-bottom: 20px;
      }

      .ingredients-container {
        min-height: 140px;
      }

      .ingredient-grid {
        grid-template-columns: repeat(6, 1fr);
        gap: 8px;
      }

      .ingredient-btn {
        font-size: 22px;
      }

      .category-tab {
        font-size: 16px;
        padding: 10px 6px;
      }

      h1 {
        font-size: 1.6rem;
      }

      .blender-container {
        width: 150px;
        height: 230px;
      }

      .blender-lid {
        width: 110px;
      }

      .blender-base {
        width: 170px;
      }

      .stats-bar {
        gap: 10px;
      }

      .stat-item {
        padding: 6px 12px;
        font-size: 10px;
      }
    }

    /* Scrollbar */
    .ingredients-panel::-webkit-scrollbar {
      width: 6px;
    }

    .ingredients-panel::-webkit-scrollbar-track {
      background: rgba(255,255,255,0.05);
      border-radius: 3px;
    }

    .ingredients-panel::-webkit-scrollbar-thumb {
      background: rgba(255,255,255,0.2);
      border-radius: 3px;
    }

    /* Achievement popup */
    .achievement-popup {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, #2c3e50 0%, #1a1a2e 100%);
      border: 2px solid #f39c12;
      border-radius: 15px;
      padding: 15px 20px;
      z-index: 1000;
      animation: achieveSlide 0.5s ease-out, achieveFade 0.5s ease-in 2.5s forwards;
      box-shadow: 0 0 30px rgba(243, 156, 18, 0.4);
      max-width: 300px;
    }

    @keyframes achieveSlide {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    @keyframes achieveFade {
      to { opacity: 0; transform: translateY(-20px); }
    }

    .achievement-popup .badge-icon {
      font-size: 32px;
      display: inline-block;
      margin-right: 10px;
      vertical-align: middle;
    }

    .achievement-popup .badge-text {
      display: inline-block;
      vertical-align: middle;
    }

    .achievement-popup .badge-title {
      color: #f39c12;
      font-family: 'Archivo Black', sans-serif;
      font-size: 14px;
    }

    .achievement-popup .badge-desc {
      color: #888;
      font-size: 11px;
      margin-top: 3px;
    }

    /* Badge gallery */
    .badge-gallery {
      margin-top: 20px;
      background: rgba(255,255,255,0.03);
      border-radius: 15px;
      padding: 15px;
      border: 1px solid rgba(255,255,255,0.08);
    }

    .badge-gallery h4 {
      font-size: 12px;
      color: #f39c12;
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .badge-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 8px;
    }

    .badge-slot {
      aspect-ratio: 1;
      background: rgba(0,0,0,0.3);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
      position: relative;
      border: 2px solid transparent;
      transition: all 0.2s;
      cursor: default;
    }

    .badge-slot.locked {
      filter: grayscale(100%) brightness(0.3);
    }

    .badge-slot.unlocked {
      border-color: rgba(243, 156, 18, 0.5);
      box-shadow: 0 0 10px rgba(243, 156, 18, 0.2);
    }

    .badge-slot:hover .badge-tooltip {
      opacity: 1;
      visibility: visible;
    }

    .badge-tooltip {
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      background: #1a1a2e;
      border: 1px solid #444;
      border-radius: 8px;
      padding: 8px 12px;
      font-size: 10px;
      white-space: nowrap;
      opacity: 0;
      visibility: hidden;
      transition: all 0.2s;
      z-index: 100;
      margin-bottom: 5px;
    }

    .badge-tooltip::after {
      content: '';
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      border: 5px solid transparent;
      border-top-color: #444;
    }

    /* Quest panel */
    .quest-panel {
      margin-top: 15px;
      background: linear-gradient(135deg, rgba(46, 204, 113, 0.1) 0%, rgba(39, 174, 96, 0.05) 100%);
      border: 1px solid rgba(46, 204, 113, 0.3);
      border-radius: 12px;
      padding: 12px;
    }

    .quest-panel h4 {
      font-size: 11px;
      color: #2ecc71;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .quest-item {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px;
      background: rgba(0,0,0,0.2);
      border-radius: 8px;
      margin-bottom: 6px;
    }

    .quest-item:last-child {
      margin-bottom: 0;
    }

    .quest-color {
      width: 24px;
      height: 24px;
      border-radius: 6px;
      border: 2px solid rgba(255,255,255,0.3);
    }

    .quest-info {
      flex: 1;
    }

    .quest-name {
      font-size: 11px;
      color: #fff;
    }

    .quest-hint {
      font-size: 9px;
      color: #666;
      margin-top: 2px;
    }

    .quest-check {
      font-size: 16px;
    }

    .quest-item.completed {
      border: 1px solid rgba(46, 204, 113, 0.5);
    }

    .quest-item.completed .quest-name {
      text-decoration: line-through;
      color: #888;
    }

    /* Stats display */
    .stats-bar {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-bottom: 15px;
      flex-wrap: wrap;
    }

    .stat-item {
      background: rgba(255,255,255,0.05);
      padding: 8px 15px;
      border-radius: 20px;
      font-size: 11px;
      color: #888;
    }

    .stat-item span {
      color: #48dbfb;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div id="app">
    <h1>ü•§ NUTRIBULLET SIMULATOR</h1>
    <p class="subtitle">Blend literally anything. We won't judge. (We will judge.)</p>

    <div class="stats-bar">
      <div class="stat-item">Blends: <span id="total-blends">0</span></div>
      <div class="stat-item">Cursed: <span id="cursed-blends">0</span></div>
    </div>

    <div class="main-area">
      <div class="blender-section">
        <div class="blender" id="blender">
          <div class="blender-lid" id="lid"></div>
          <div class="blender-container" id="container">
            <div class="blend-contents" id="blend-contents"></div>
            <div class="glass-cracks" id="glass-cracks">
              <div class="crack crack-1"></div>
              <div class="crack crack-2"></div>
              <div class="crack crack-3"></div>
              <div class="crack crack-4"></div>
              <div class="crack crack-5"></div>
              <div class="crack crack-radial"></div>
            </div>
            <div class="fire-container" id="fire-container" style="display:none;">
              <div class="flame flame-1"></div>
              <div class="flame flame-2"></div>
              <div class="flame flame-3"></div>
            </div>
          </div>
          <div class="smoke-container" id="smoke-container" style="display:none;">
            <div class="smoke-particle"></div>
            <div class="smoke-particle"></div>
            <div class="smoke-particle"></div>
            <div class="smoke-particle"></div>
          </div>
          <div class="blender-base">
            <button class="blend-btn" id="blend-btn">BLEND</button>
          </div>
        </div>

        <button class="clear-btn" id="clear-btn">üóëÔ∏è Empty Blender</button>

        <div class="result-panel" id="result-panel">
          <div class="result-name" id="result-name"></div>
          <div class="result-description" id="result-description"></div>
          <div class="result-rating" id="result-rating"></div>
        </div>

        <div class="quest-panel" id="quest-panel">
          <h4>üéØ Color Quests</h4>
          <div id="quest-list"></div>
        </div>

        <div class="badge-gallery">
          <h4>üèÜ Achievements <span id="badge-count">(0/10)</span></h4>
          <div class="badge-grid" id="badge-grid"></div>
        </div>
      </div>

      <div class="ingredients-panel">
        <div class="panel-header">
          <h3>Ingredients</h3>
        </div>

        <div class="category-tabs">
          <button class="category-tab active" data-category="normal">
            ü•ó
            <span class="tab-tooltip">Normal Stuff</span>
          </button>
          <button class="category-tab" data-category="questionable">
            ü§î
            <span class="tab-tooltip">Questionable</span>
          </button>
          <button class="category-tab" data-category="weird">
            ‚ö†Ô∏è
            <span class="tab-tooltip">Why Would You</span>
          </button>
          <button class="category-tab" data-category="cursed">
            ‚ò†Ô∏è
            <span class="tab-tooltip">Absolutely Not</span>
          </button>
        </div>

        <div class="ingredients-container">
          <div class="ingredient-grid active" id="normal-ingredients" data-category="normal"></div>
          <div class="ingredient-grid" id="questionable-ingredients" data-category="questionable"></div>
          <div class="ingredient-grid" id="weird-ingredients" data-category="weird"></div>
          <div class="ingredient-grid" id="cursed-ingredients" data-category="cursed"></div>
          <div class="category-label" id="category-label">Normal Stuff</div>
        </div>
      </div>
    </div>
  </div>

  <a href="https://sloppy.live" id="backlink">‚Üê sloppy.live</a>

  <script>
    // Ingredients data
    const ingredients = {
      normal: [
        { emoji: 'ü•¨', name: 'Kale', color: '#4a7c59' },
        { emoji: 'üçå', name: 'Banana', color: '#f4d03f' },
        { emoji: 'üçì', name: 'Strawberry', color: '#e74c3c' },
        { emoji: 'ü´ê', name: 'Blueberries', color: '#5b6abf' },
        { emoji: 'ü•õ', name: 'Milk', color: '#ecf0f1' },
        { emoji: 'üçØ', name: 'Honey', color: '#f39c12' },
        { emoji: 'ü•ú', name: 'Peanut Butter', color: '#a0522d' },
        { emoji: 'üßä', name: 'Ice', color: '#aed6f1' },
        { emoji: 'üçé', name: 'Apple', color: '#c0392b' },
        { emoji: 'ü•ï', name: 'Carrot', color: '#e67e22' },
        { emoji: 'üçä', name: 'Orange', color: '#f39c12' },
        { emoji: 'ü•ë', name: 'Avocado', color: '#7dcea0' },
      ],
      questionable: [
        { emoji: 'üßÄ', name: 'Cheese', color: '#f4d03f' },
        { emoji: 'ü•ì', name: 'Bacon', color: '#c0392b' },
        { emoji: 'üçï', name: 'Pizza', color: '#e74c3c' },
        { emoji: 'üåÆ', name: 'Taco', color: '#f39c12' },
        { emoji: 'üçü', name: 'Fries', color: '#f4d03f' },
        { emoji: 'üßÖ', name: 'Onion', color: '#d5a6bd' },
        { emoji: 'ü•ö', name: 'Raw Egg', color: '#fdebd0' },
        { emoji: 'ü´í', name: 'Olives', color: '#2c3e50' },
      ],
      weird: [
        { emoji: 'üîë', name: 'Car Keys', color: '#7f8c8d' },
        { emoji: 'üì±', name: 'Phone', color: '#2c3e50' },
        { emoji: 'üß¶', name: 'Sock', color: '#9b59b6' },
        { emoji: 'üíÑ', name: 'Lipstick', color: '#e74c3c' },
        { emoji: 'ü™•', name: 'Toothbrush', color: '#3498db' },
        { emoji: 'üé∏', name: 'Guitar Pick', color: '#e67e22' },
        { emoji: 'üíø', name: 'CD', color: '#bdc3c7' },
        { emoji: 'üîã', name: 'Battery', color: '#27ae60' },
        { emoji: 'ü™ô', name: 'Coins', color: '#f4d03f' },
        { emoji: 'üé≤', name: 'Dice', color: '#ecf0f1' },
      ],
      cursed: [
        { emoji: 'ü¶∑', name: 'Teeth', color: '#ecf0f1' },
        { emoji: 'üëÅÔ∏è', name: 'Glass Eye', color: '#3498db' },
        { emoji: 'ü™≥', name: 'Cockroach', color: '#6d4c41' },
        { emoji: 'üß†', name: 'Brain', color: '#f8bbd9' },
        { emoji: 'üíÄ', name: 'Skull', color: '#ecf0f1' },
        { emoji: 'üï∑Ô∏è', name: 'Spider', color: '#2c3e50' },
        { emoji: 'ü¶¥', name: 'Bone', color: '#fdebd0' },
        { emoji: 'üëª', name: 'Ghost', color: '#ecf0f1' },
        { emoji: 'üî•', name: 'Fire', color: '#e74c3c' },
        { emoji: '‚ö°', name: 'Lightning', color: '#f4d03f' },
        { emoji: '‚ò¢Ô∏è', name: 'Uranium', color: '#2ecc71' },
        { emoji: 'üóø', name: 'Moai', color: '#7f8c8d' },
      ]
    };

    // Result generators
    const resultTemplates = {
      healthy: [
        { name: 'Green Machine', desc: 'Actually nutritious! Your body is confused but grateful.' },
        { name: 'Vitamin Bomb', desc: 'So healthy it hurts. In a good way?' },
        { name: 'Gym Bro Juice', desc: 'Tastes like ambition and protein powder dreams.' },
      ],
      questionable: [
        { name: 'Regret Smoothie', desc: 'Your taste buds are filing a complaint.' },
        { name: 'The Experiment', desc: 'Science has gone too far. And yet... another sip?' },
        { name: 'Brunch Gone Wrong', desc: 'This is what happens when you sleep through breakfast.' },
      ],
      weird: [
        { name: 'Warranty Voider', desc: 'That grinding noise was load-bearing.' },
        { name: 'Evidence Destroyer', desc: 'The police will never find it now.' },
        { name: 'The Forbidden Smoothie', desc: 'Some things were not meant to be liquified.' },
        { name: 'Texture Nightmare', desc: 'Chunky in ways that defy physics.' },
      ],
      cursed: [
        { name: 'Eldritch Slurry', desc: 'It\'s staring back at you. It knows what you did.' },
        { name: 'Chaos Juice', desc: 'The blender is screaming. Or is that you?' },
        { name: 'The Unspeakable', desc: 'You have created something that should not exist.' },
        { name: 'Nightmare Fuel', desc: 'Sleep is cancelled. Forever.' },
        { name: 'Satan\'s Smoothie', desc: 'Even demons would refuse this.' },
      ]
    };

    // State
    let blenderItems = [];
    let isBlending = false;
    let physics = [];

    // DOM elements
    const container = document.getElementById('container');
    const blendContents = document.getElementById('blend-contents');
    const blender = document.getElementById('blender');
    const blendBtn = document.getElementById('blend-btn');
    const clearBtn = document.getElementById('clear-btn');
    const lid = document.getElementById('lid');
    const resultPanel = document.getElementById('result-panel');
    const resultName = document.getElementById('result-name');
    const resultDescription = document.getElementById('result-description');
    const resultRating = document.getElementById('result-rating');
    const glassCracks = document.getElementById('glass-cracks');
    const smokeContainer = document.getElementById('smoke-container');
    const fireContainer = document.getElementById('fire-container');

    // Hazardous items that cause effects
    const hazardousItems = ['‚ò¢Ô∏è', '‚ö°', 'üî•', 'üîã', 'üíÄ', 'üß†'];
    const fireItems = ['üî•', '‚ö°', '‚ò¢Ô∏è'];
    const hardItems = ['üîë', 'üì±', 'üíø', 'ü™ô', 'üóø', 'ü¶¥', 'üíÄ', 'ü¶∑'];

    // Category labels
    const categoryLabels = {
      normal: 'Normal Stuff',
      questionable: 'Questionable',
      weird: 'Why Would You',
      cursed: 'Absolutely Not'
    };

    // Initialize ingredient buttons
    function initIngredients() {
      const normalGrid = document.getElementById('normal-ingredients');
      const questionableGrid = document.getElementById('questionable-ingredients');
      const weirdGrid = document.getElementById('weird-ingredients');
      const cursedGrid = document.getElementById('cursed-ingredients');

      ingredients.normal.forEach(ing => addIngredientButton(normalGrid, ing, 'normal'));
      ingredients.questionable.forEach(ing => addIngredientButton(questionableGrid, ing, 'questionable'));
      ingredients.weird.forEach(ing => addIngredientButton(weirdGrid, ing, 'weird'));
      ingredients.cursed.forEach(ing => addIngredientButton(cursedGrid, ing, 'cursed'));

      // Setup tab switching
      initTabs();
    }

    function addIngredientButton(grid, ingredient, category) {
      const btn = document.createElement('button');
      btn.className = `ingredient-btn ${category}-item`;
      btn.innerHTML = `
        ${ingredient.emoji}
        <span class="ing-tooltip">${ingredient.name}</span>
      `;
      btn.addEventListener('click', () => addToBlender(ingredient));
      grid.appendChild(btn);
    }

    // Tab switching functionality
    function initTabs() {
      const tabs = document.querySelectorAll('.category-tab');
      const grids = document.querySelectorAll('.ingredient-grid');
      const label = document.getElementById('category-label');

      tabs.forEach(tab => {
        tab.addEventListener('click', () => {
          const category = tab.dataset.category;

          // Update active tab
          tabs.forEach(t => t.classList.remove('active'));
          tab.classList.add('active');

          // Update active grid
          grids.forEach(g => g.classList.remove('active'));
          document.getElementById(`${category}-ingredients`).classList.add('active');

          // Update label
          label.textContent = categoryLabels[category];
        });
      });
    }

    // Add item to blender with physics
    function addToBlender(ingredient) {
      if (isBlending || blenderItems.length >= 15) return;

      // Hide result when adding new items
      resultPanel.classList.remove('show');

      blenderItems.push(ingredient);

      // Create visual item
      const item = document.createElement('div');
      item.className = 'ingredient-item';
      item.textContent = ingredient.emoji;
      item.dataset.color = ingredient.color;

      // Random starting position at top
      const startX = 20 + Math.random() * 120;
      item.style.left = startX + 'px';
      item.style.top = '10px';

      container.appendChild(item);

      // Add to physics simulation
      physics.push({
        element: item,
        x: startX,
        y: 10,
        vx: (Math.random() - 0.5) * 3,
        vy: 0,
        color: ingredient.color
      });

      updateBlendContents();
    }

    // Simple physics simulation
    function updatePhysics() {
      const containerRect = container.getBoundingClientRect();
      const containerWidth = 174;
      const containerHeight = 274;
      const gravity = 0.5;
      const bounce = 0.6;
      const friction = 0.99;

      physics.forEach(obj => {
        if (isBlending) {
          // Chaos mode during blending
          obj.vx += (Math.random() - 0.5) * 8;
          obj.vy += (Math.random() - 0.5) * 8;
        } else {
          // Normal gravity
          obj.vy += gravity;
        }

        obj.vx *= friction;
        obj.vy *= friction;

        obj.x += obj.vx;
        obj.y += obj.vy;

        // Bounce off walls
        if (obj.x < 5) {
          obj.x = 5;
          obj.vx *= -bounce;
        }
        if (obj.x > containerWidth - 35) {
          obj.x = containerWidth - 35;
          obj.vx *= -bounce;
        }
        if (obj.y < 5) {
          obj.y = 5;
          obj.vy *= -bounce;
        }
        if (obj.y > containerHeight - 35) {
          obj.y = containerHeight - 35;
          obj.vy *= -bounce;
        }

        obj.element.style.left = obj.x + 'px';
        obj.element.style.top = obj.y + 'px';
      });

      requestAnimationFrame(updatePhysics);
    }

    // Update blend contents visual
    function updateBlendContents() {
      const height = Math.min(blenderItems.length * 15, 200);
      blendContents.style.height = height + 'px';

      // Remove all special classes
      blendContents.classList.remove('metallic', 'radioactive', 'cursed', 'bloody', 'fire');

      if (blenderItems.length === 0) return;

      // Check for special combinations
      const emojis = blenderItems.map(i => i.emoji);
      const hasElectronics = emojis.some(e => ['üì±', 'üîã', 'üíø', 'üîë', 'ü™ô'].includes(e));
      const hasRadioactive = emojis.some(e => ['‚ò¢Ô∏è', '‚ö°'].includes(e));
      const hasCursed = emojis.some(e => ['üíÄ', 'üëª', 'üß†', 'üëÅÔ∏è', 'üï∑Ô∏è', 'ü™≥'].includes(e));
      const hasBloody = emojis.some(e => ['ü¶∑', 'üß†', 'ü¶¥'].includes(e));
      const hasFire = emojis.some(e => ['üî•'].includes(e));

      // Apply special effects based on contents
      if (hasRadioactive) {
        blendContents.classList.add('radioactive');
      } else if (hasFire) {
        blendContents.classList.add('fire');
      } else if (hasElectronics && blenderItems.length >= 2) {
        blendContents.classList.add('metallic');
      } else if (hasCursed) {
        blendContents.classList.add('cursed');
      } else if (hasBloody) {
        blendContents.classList.add('bloody');
      } else {
        // Normal color mixing
        const colors = blenderItems.map(i => i.color);
        blendContents.style.background = `linear-gradient(180deg, ${mixColors(colors)}88, ${mixColors(colors)}cc)`;
      }
    }

    // Mix colors helper
    function mixColors(colors) {
      let r = 0, g = 0, b = 0;
      colors.forEach(color => {
        const hex = color.replace('#', '');
        r += parseInt(hex.substr(0, 2), 16);
        g += parseInt(hex.substr(2, 2), 16);
        b += parseInt(hex.substr(4, 2), 16);
      });
      r = Math.round(r / colors.length);
      g = Math.round(g / colors.length);
      b = Math.round(b / colors.length);
      return `rgb(${r},${g},${b})`;
    }

    // Blend function
    function blend() {
      if (isBlending || blenderItems.length === 0) return;

      isBlending = true;
      blendBtn.classList.add('blending');
      blender.classList.add('shaking');
      lid.classList.remove('open');

      // Check for hazardous items
      const emojis = blenderItems.map(i => i.emoji);
      const hasHazardous = emojis.some(e => hazardousItems.includes(e));
      const hasFire = emojis.some(e => fireItems.includes(e));
      const hasHard = emojis.some(e => hardItems.includes(e));

      // Show hazard effects
      if (hasHard) {
        // Cracks appear after a moment
        setTimeout(() => {
          glassCracks.classList.add('show');
        }, 500);
      }

      if (hasHazardous) {
        smokeContainer.style.display = 'block';
        container.classList.add('danger');
      }

      if (hasFire) {
        setTimeout(() => {
          fireContainer.style.display = 'block';
        }, 300);
      }

      // Create explosion for uranium
      if (emojis.includes('‚ò¢Ô∏è')) {
        setTimeout(() => {
          const explosion = document.createElement('div');
          explosion.className = 'explosion';
          container.appendChild(explosion);
          setTimeout(() => explosion.remove(), 500);
        }, 1500);
      }

      // Make items spin
      physics.forEach(obj => {
        obj.element.classList.add('blending');
      });

      // Create splatters
      const splatterInterval = setInterval(() => {
        createSplatter();
      }, 100);

      // Stop after 2.5 seconds (longer for drama)
      setTimeout(() => {
        clearInterval(splatterInterval);
        isBlending = false;
        blendBtn.classList.remove('blending');
        blender.classList.remove('shaking');
        container.classList.remove('danger');
        fireContainer.style.display = 'none';
        smokeContainer.style.display = 'none';

        // Remove individual items
        physics.forEach(obj => {
          obj.element.remove();
        });
        physics = [];

        // Show result
        showResult();
      }, 2500);
    }

    // Create splatter effect
    function createSplatter() {
      if (blenderItems.length === 0) return;

      const splatter = document.createElement('div');
      splatter.className = 'splatter';
      const color = blenderItems[Math.floor(Math.random() * blenderItems.length)].color;
      splatter.style.background = color;
      splatter.style.width = (5 + Math.random() * 15) + 'px';
      splatter.style.height = splatter.style.width;
      splatter.style.left = (Math.random() * 160 + 10) + 'px';
      splatter.style.top = (Math.random() * 200 + 20) + 'px';
      container.appendChild(splatter);

      setTimeout(() => splatter.remove(), 1000);
    }

    // Show blend result
    function showResult() {
      // Categorize the blend
      let category = 'healthy';
      let weirdness = 0;

      blenderItems.forEach(item => {
        if (ingredients.questionable.find(i => i.emoji === item.emoji)) weirdness += 1;
        if (ingredients.weird.find(i => i.emoji === item.emoji)) weirdness += 3;
        if (ingredients.cursed.find(i => i.emoji === item.emoji)) weirdness += 5;
      });

      if (weirdness >= 10) category = 'cursed';
      else if (weirdness >= 5) category = 'weird';
      else if (weirdness >= 2) category = 'questionable';

      // Update stats
      gameStats.totalBlends++;
      if (category === 'cursed') gameStats.cursedBlends++;
      saveStats();

      // Check achievements and quests
      checkAchievements();
      checkQuests();

      const templates = resultTemplates[category];
      const result = templates[Math.floor(Math.random() * templates.length)];

      resultName.textContent = result.name;
      resultDescription.textContent = result.desc;

      // Generate rating
      const ratings = {
        healthy: ['‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Nutritionist approved!', '‚≠ê‚≠ê‚≠ê‚≠ê Pretty good actually', '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Your colon thanks you'],
        questionable: ['‚≠ê‚≠ê‚≠ê Bold choice', '‚≠ê‚≠ê We need to talk', '‚≠ê‚≠ê‚≠ê Instagram wouldn\'t understand'],
        weird: ['‚≠ê Why', '‚≠ê The blender is crying', '‚ö†Ô∏è Warranty voided'],
        cursed: ['‚ò†Ô∏è Call a priest', 'üö® FBI has been notified', 'üëÅÔ∏è It sees all now', 'üíÄ You\'ve doomed us all']
      };

      const ratingList = ratings[category];
      resultRating.textContent = ratingList[Math.floor(Math.random() * ratingList.length)];

      resultPanel.classList.add('show');
    }

    // Clear blender
    function clearBlender() {
      physics.forEach(obj => obj.element.remove());
      physics = [];
      blenderItems = [];
      blendContents.style.height = '0';
      blendContents.style.background = 'transparent';
      blendContents.classList.remove('metallic', 'radioactive', 'cursed', 'bloody', 'fire');
      resultPanel.classList.remove('show');
      glassCracks.classList.remove('show');
      smokeContainer.style.display = 'none';
      fireContainer.style.display = 'none';
    }

    // ===== ACHIEVEMENT SYSTEM =====
    const achievements = [
      { id: 'first_blend', icon: 'ü•§', name: 'First Sip', desc: 'Make your first blend', check: (stats) => stats.totalBlends >= 1 },
      { id: 'cursed_chef', icon: '‚ò†Ô∏è', name: 'Cursed Chef', desc: 'Blend something from the cursed category', check: (stats, items) => items.some(i => ingredients.cursed.find(c => c.emoji === i.emoji)) },
      { id: 'mad_scientist', icon: 'üß™', name: 'Mad Scientist', desc: 'Create a radioactive smoothie', check: (stats, items) => items.some(i => ['‚ò¢Ô∏è', '‚ö°'].includes(i.emoji)) },
      { id: 'arsonist', icon: 'üî•', name: 'Arsonist', desc: 'Set the blender on fire', check: (stats, items) => items.some(i => ['üî•', '‚ö°', '‚ò¢Ô∏è'].includes(i.emoji)) },
      { id: 'warranty_void', icon: 'üîß', name: 'Warranty Voided', desc: 'Blend electronics (phone, keys, battery)', check: (stats, items) => items.some(i => ['üì±', 'üîë', 'üîã'].includes(i.emoji)) },
      { id: 'health_nut', icon: 'ü•ó', name: 'Health Nut', desc: 'Make a blend with only normal ingredients', check: (stats, items) => items.length >= 3 && items.every(i => ingredients.normal.find(n => n.emoji === i.emoji)) },
      { id: 'chaos_agent', icon: 'üåÄ', name: 'Chaos Agent', desc: 'Mix items from all 4 categories', check: (stats, items) => { const cats = [ingredients.normal, ingredients.questionable, ingredients.weird, ingredients.cursed]; return cats.every(cat => items.some(i => cat.find(c => c.emoji === i.emoji))); } },
      { id: 'full_blender', icon: 'üì¶', name: 'Maximum Capacity', desc: 'Fill the blender to max (15 items)', check: (stats, items) => items.length >= 15 },
      { id: 'serial_blender', icon: 'üîÑ', name: 'Serial Blender', desc: 'Make 10 blends', check: (stats) => stats.totalBlends >= 10 },
      { id: 'cursed_master', icon: 'üëë', name: 'Cursed Master', desc: 'Make 5 cursed blends', check: (stats) => stats.cursedBlends >= 5 },
    ];

    const colorQuests = [
      { id: 'green_machine', name: 'Green Machine', color: '#4a7c59', hint: 'Kale + Avocado', ingredients: ['ü•¨', 'ü•ë'] },
      { id: 'sunset_blend', name: 'Sunset Blend', color: '#f39c12', hint: 'Orange + Carrot + Honey', ingredients: ['üçä', 'ü•ï', 'üçØ'] },
      { id: 'berry_blast', name: 'Berry Blast', color: '#8e44ad', hint: 'Blueberries + Strawberry', ingredients: ['ü´ê', 'üçì'] },
      { id: 'metallic_madness', name: 'Metallic Madness', color: '#7f8c8d', hint: 'Keys + Phone + Coins', ingredients: ['üîë', 'üì±', 'ü™ô'] },
    ];

    // Load saved progress
    let gameStats = JSON.parse(localStorage.getItem('nutribullet_stats') || '{"totalBlends":0,"cursedBlends":0}');
    let unlockedAchievements = JSON.parse(localStorage.getItem('nutribullet_achievements') || '[]');
    let completedQuests = JSON.parse(localStorage.getItem('nutribullet_quests') || '[]');

    // DOM elements for gamification
    const badgeGrid = document.getElementById('badge-grid');
    const badgeCount = document.getElementById('badge-count');
    const questList = document.getElementById('quest-list');
    const totalBlendsEl = document.getElementById('total-blends');
    const cursedBlendsEl = document.getElementById('cursed-blends');

    // Initialize badge gallery
    function initBadgeGallery() {
      badgeGrid.innerHTML = '';
      achievements.forEach(ach => {
        const slot = document.createElement('div');
        const isUnlocked = unlockedAchievements.includes(ach.id);
        slot.className = `badge-slot ${isUnlocked ? 'unlocked' : 'locked'}`;
        slot.innerHTML = `
          ${ach.icon}
          <div class="badge-tooltip">
            <strong>${ach.name}</strong><br>
            ${isUnlocked ? '‚úì Unlocked!' : ach.desc}
          </div>
        `;
        badgeGrid.appendChild(slot);
      });
      badgeCount.textContent = `(${unlockedAchievements.length}/${achievements.length})`;
    }

    // Initialize quest list
    function initQuests() {
      questList.innerHTML = '';
      colorQuests.forEach(quest => {
        const isComplete = completedQuests.includes(quest.id);
        const item = document.createElement('div');
        item.className = `quest-item ${isComplete ? 'completed' : ''}`;
        item.innerHTML = `
          <div class="quest-color" style="background: ${quest.color}"></div>
          <div class="quest-info">
            <div class="quest-name">${quest.name}</div>
            <div class="quest-hint">${quest.hint}</div>
          </div>
          <div class="quest-check">${isComplete ? '‚úÖ' : '‚¨ú'}</div>
        `;
        questList.appendChild(item);
      });
    }

    // Update stats display
    function updateStatsDisplay() {
      totalBlendsEl.textContent = gameStats.totalBlends;
      cursedBlendsEl.textContent = gameStats.cursedBlends;
    }

    // Check and award achievements
    function checkAchievements() {
      achievements.forEach(ach => {
        if (!unlockedAchievements.includes(ach.id) && ach.check(gameStats, blenderItems)) {
          unlockAchievement(ach);
        }
      });
    }

    // Unlock achievement
    function unlockAchievement(achievement) {
      unlockedAchievements.push(achievement.id);
      localStorage.setItem('nutribullet_achievements', JSON.stringify(unlockedAchievements));

      // Show popup
      const popup = document.createElement('div');
      popup.className = 'achievement-popup';
      popup.innerHTML = `
        <span class="badge-icon">${achievement.icon}</span>
        <div class="badge-text">
          <div class="badge-title">${achievement.name}</div>
          <div class="badge-desc">${achievement.desc}</div>
        </div>
      `;
      document.body.appendChild(popup);
      setTimeout(() => popup.remove(), 3000);

      // Update gallery
      initBadgeGallery();
    }

    // Check quests
    function checkQuests() {
      const currentEmojis = blenderItems.map(i => i.emoji);
      colorQuests.forEach(quest => {
        if (!completedQuests.includes(quest.id)) {
          const hasAll = quest.ingredients.every(ing => currentEmojis.includes(ing));
          if (hasAll) {
            completeQuest(quest);
          }
        }
      });
    }

    // Complete quest
    function completeQuest(quest) {
      completedQuests.push(quest.id);
      localStorage.setItem('nutribullet_quests', JSON.stringify(completedQuests));
      initQuests();
    }

    // Save stats
    function saveStats() {
      localStorage.setItem('nutribullet_stats', JSON.stringify(gameStats));
      updateStatsDisplay();
    }

    // Event listeners
    blendBtn.addEventListener('click', blend);
    clearBtn.addEventListener('click', clearBlender);
    lid.addEventListener('click', () => lid.classList.toggle('open'));

    // Initialize
    initIngredients();
    updatePhysics();
    initBadgeGallery();
    initQuests();
    updateStatsDisplay();
  </script>
<script src="/apps/sloppy-header/sloppy-bar.js"></script>
<script src="/vibelib-extended.js"></script>
<script>
  // Compatibility Patch for Legacy Apps
  window.addEventListener("load", () => {
    if (window.SloppyKarma && window.VibeLib.Economy) {
      // Redirect old calls to new engine
      window.SloppyKarma.track = window.VibeLib.Economy.track;
    }
  });
</script>
</body>
</html>
