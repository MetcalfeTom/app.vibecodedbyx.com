<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BREAKOUT_MATRIX</title>
    <meta name="description" content="Terminal-style Breakout. Smash glowing code blocks and chase the high score.">
    <link rel="icon" href="https://emojicdn.elk.sh/üß±">
    <meta property="og:title" content="BREAKOUT_MATRIX - Terminal Brick Breaker">
    <meta property="og:description" content="Classic Breakout with a matrix terminal aesthetic. Break the code blocks!">
    <meta property="og:url" content="https://app.vibecodedbyx.com/breakout-terminal">
    <meta property="og:image" content="og-image.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta name="theme-color" content="#000000">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #000;
            color: #0099ff;
            font-family: 'Share Tech Mono', monospace;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            flex-direction: column;
            padding: 20px;
            overflow: hidden;
        }

        .terminal-container {
            background: #0a0a0a;
            border: 2px solid #0099ff;
            padding: 20px;
            box-shadow: 0 0 40px rgba(0, 153, 255, 0.3);
            max-width: 700px;
            width: 100%;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
            border-bottom: 1px solid #0099ff;
            padding-bottom: 10px;
        }

        h1 {
            font-size: 24px;
            text-shadow: 0 0 20px #0099ff;
            margin-bottom: 5px;
            letter-spacing: 2px;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            margin: 15px 0;
            padding: 10px;
            background: #000;
            border: 1px solid #0099ff;
        }

        .stat {
            text-align: center;
        }

        .stat-label {
            font-size: 12px;
            opacity: 0.7;
        }

        .stat-value {
            font-size: 20px;
            font-weight: bold;
            text-shadow: 0 0 10px #0099ff;
        }

        canvas {
            border: 2px solid #0099ff;
            background: #000;
            display: block;
            margin: 0 auto;
            box-shadow: 0 0 30px rgba(0, 153, 255, 0.2);
        }

        .controls {
            border: 1px solid #0099ff;
            padding: 15px;
            margin: 20px 0;
            background: #000;
            text-align: center;
        }

        .control-item {
            font-size: 12px;
            margin: 5px 0;
            opacity: 0.8;
        }

        .control-key {
            color: #0099ff;
            font-weight: bold;
            background: #0a0a0a;
            padding: 2px 8px;
            border: 1px solid #0099ff;
            display: inline-block;
        }

        .game-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #000;
            border: 3px solid #0099ff;
            padding: 30px;
            text-align: center;
            display: none;
            z-index: 1000;
            box-shadow: 0 0 50px rgba(0, 153, 255, 0.5);
        }

        .game-message.show {
            display: block;
        }

        .game-message h2 {
            font-size: 28px;
            margin-bottom: 15px;
            text-shadow: 0 0 20px #0099ff;
        }

        .game-message p {
            font-size: 16px;
            margin: 10px 0;
            opacity: 0.9;
        }

        .play-btn {
            background: #0099ff;
            color: #000;
            border: none;
            padding: 12px 30px;
            font-family: inherit;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 20px;
            text-transform: uppercase;
            transition: all 0.3s;
        }

        .play-btn:hover {
            background: #0077cc;
            box-shadow: 0 0 20px #0099ff;
        }

        .btn {
            background: transparent;
            color: #0099ff;
            border: 1px solid #0099ff;
            padding: 8px 16px;
            font-family: inherit;
            font-size: 14px;
            cursor: pointer;
            margin: 8px 6px 0;
            text-transform: uppercase;
            transition: all 0.2s;
        }

        .btn:hover {
            background: rgba(0, 153, 255, 0.1);
            box-shadow: 0 0 12px rgba(0, 153, 255, 0.4);
        }

        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #0a0a0a;
            border: 1px solid #0099ff;
            padding: 10px 16px;
            color: #0099ff;
            font-size: 13px;
            display: none;
            z-index: 2000;
            box-shadow: 0 0 20px rgba(0, 153, 255, 0.3);
        }
        .toast.show { display: block; }

        .power-up {
            font-size: 14px;
            color: #ffff00;
            text-shadow: 0 0 10px #ffff00;
            margin-top: 10px;
            min-height: 20px;
        }

        .backlink {
            text-align: center;
            font-size: 12px;
            margin-top: 15px;
        }

        .backlink a {
            color: #0099ff;
            opacity: 0.7;
            text-decoration: none;
        }

        .backlink a:hover {
            opacity: 1;
            text-shadow: 0 0 5px #0099ff;
        }

        .paused-ribbon {
            position: fixed;
            top: 16px;
            right: 16px;
            background: rgba(0,0,0,0.8);
            border: 1px solid #0099ff;
            color: #0099ff;
            padding: 6px 10px;
            font-size: 12px;
            letter-spacing: 1px;
            display: none;
            z-index: 1200;
        }

        @media (max-width: 600px) {
            h1 {
                font-size: 20px;
            }

            .stats {
                font-size: 12px;
            }

            canvas {
                max-width: 100%;
                height: auto;
            }
        }
    </style>
</head>
<body>
    <div class="terminal-container">
        <div class="header">
            <h1>&gt; BREAKOUT_MATRIX</h1>
            <div style="font-size: 12px; opacity: 0.7;">BREACH.PROTOCOL.ACTIVE</div>
        </div>

        <div class="stats">
            <div class="stat">
                <div class="stat-label">SCORE</div>
                <div class="stat-value" id="score">0</div>
            </div>
            <div class="stat">
                <div class="stat-label">LEVEL</div>
                <div class="stat-value" id="level">1</div>
            </div>
            <div class="stat">
                <div class="stat-label">LIVES</div>
                <div class="stat-value" id="lives">3</div>
            </div>
            <div class="stat">
                <div class="stat-label">HIGH</div>
                <div class="stat-value" id="highScore">0</div>
            </div>
        </div>


        <canvas id="gameCanvas" width="600" height="400"></canvas>

        <div class="power-up" id="powerUpDisplay"></div>

        <div class="controls">
            <div class="control-item"><span class="control-key">‚Üê ‚Üí</span> or <span class="control-key">A D</span> MOVE PADDLE</div>
            <div class="control-item"><span class="control-key">SPACE</span> START / LAUNCH BALL</div>
            <div class="control-item"><span class="control-key">P</span> PAUSE</div>
            <div class="control-item">TOUCH/DRAG on mobile</div>
            <button class="btn" id="shareBtn" aria-label="Share this game">Share</button>
        </div>

        <div class="controls" id="leaderboardPanel" aria-live="polite">
            <div class="control-item" style="margin-bottom:8px;">TOP SCORES</div>
            <ol id="leaderboardList" style="text-align:left; max-height:140px; overflow:auto; padding-left:20px;">
                <li>Loading‚Ä¶</li>
            </ol>
            <button class="btn" id="refreshBoardBtn">Refresh</button>
        </div>

        <div class="backlink">
            <a href="http://www.vibecodedbyx.com" target="_blank">&gt; vibecodedbyx.com</a> | <a href="https://app.vibecodedbyx.com/overview" style="color:#4ecdc4;text-decoration:none">üé® View All Apps</a>
        </div>
    </div>

    <div class="paused-ribbon" id="pausedRibbon">PAUSED</div>
    <div class="game-message" id="gameMessage">
        <h2 id="messageTitle">BREAKOUT_MATRIX</h2>
        <p id="messageText">BREACH THE FIREWALL</p>
        <p id="messageScore"></p>
        <button class="play-btn" onclick="startGame()">INITIALIZE</button>
        <div id="submitScoreArea" style="margin-top:12px; display:none;">
            <input id="displayNameInput" placeholder="enter name (optional)" maxlength="20" style="font-family:inherit; padding:6px 8px; border:1px solid #0099ff; background:#000; color:#0099ff; outline:none;" />
            <button class="btn" id="submitScoreBtn">Submit Score</button>
            <div id="submitStatus" style="font-size:12px; opacity:0.8; margin-top:6px;"></div>
        </div>
    </div>
    <div id="toast" class="toast" role="status" aria-live="polite">Link copied!</div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        if (!ctx) {
            alert('Graphics initialization failed. Please refresh or try a different browser.');
        }

        let gameRunning = false;
        let paused = false;
        let score = 0;
        let level = 1;
        let lives = 3;
                let highScore = localStorage.getItem('breakoutHighScore') || 0;
        
        
                const paddle = {
                    x: canvas.width / 2 - 60,
                    y: canvas.height - 30,
                    width: 120,
                    height: 10,
                    speed: 10
                };
        
                const ball = {
                    x: canvas.width / 2,
                    y: canvas.height - 50,
                    radius: 6,
                    speedX: 0,
                    speedY: 0,
                    attached: true
                };
        
                const brickRowCount = 8;
                const brickColumnCount = 10;
                const brickWidth = 50;
                const brickHeight = 20;
                const brickPadding = 5;
                const brickOffsetTop = 60;
                const brickOffsetLeft = 35;
        
                let bricks = [];
                let powerUp = null;
                let paddleExpanded = false;
                let paddleExpandTimer = 0;
        
                const keys = {};
        
                function initBricks() {
                    bricks = [];
                    for (let c = 0; c < brickColumnCount; c++) {
                        bricks[c] = [];
                        for (let r = 0; r < brickRowCount; r++) {
                            const hitPoints = r < 2 ? 3 : r < 4 ? 2 : 1;
                            bricks[c][r] = {
                                x: 0,
                                y: 0,
                                status: hitPoints,
                                maxHits: hitPoints
                            };
                        }
                    }
                }
        
        
                function resetBall() {
                    ball.x = paddle.x + paddle.width / 2;
                    ball.y = paddle.y - 10;
                    ball.speedX = 0;
                    ball.speedY = 0;
                    ball.attached = true;
                }
        
                function launchBall() {
                    if (ball.attached) {
                        ball.speedX = (Math.random() - 0.5) * 4;
                        ball.speedY = -4;
                        ball.attached = false;
                    }
                }
        
                function startGame() {
                    score = 0;
                    level = 1;
                    lives = 5;
                    gameRunning = true;
                    initBricks();
                    resetBall();
                    updateDisplay();
                    document.getElementById('gameMessage').classList.remove('show');
                    document.getElementById('highScore').textContent = highScore;
                }
        
                function nextLevel() {
                    level++;
                    initBricks();
                    resetBall();
                    ball.speedX *= 1.05;
                    ball.speedY *= 1.05;
                    updateDisplay();
                    showMessage('LEVEL ' + level, 'FIREWALL UPGRADED', 1500);
                }
        
                function updateHighScore() {
                    if (score > highScore) {
                        highScore = score;
                        localStorage.setItem('breakoutHighScore', highScore);
                        document.getElementById('highScore').textContent = highScore;
                    }
                }

                function gameOver() {
                    gameRunning = false;
                    updateHighScore();
                    document.getElementById('messageTitle').textContent = 'SYSTEM BREACH FAILED';
                    document.getElementById('messageText').textContent = 'ACCESS DENIED';
                    document.getElementById('messageScore').textContent = 'FINAL SCORE: ' + score;
                    document.getElementById('gameMessage').classList.add('show');
                    const submitArea = document.getElementById('submitScoreArea');
                    if (submitArea) submitArea.style.display = 'block';
                    try { window.dispatchEvent(new CustomEvent('breakout:gameOver', { detail: { score, level } })); } catch (_) {}
                }        
                function showMessage(title, text, duration) {
                    document.getElementById('messageTitle').textContent = title;
                    document.getElementById('messageText').textContent = text;
                    document.getElementById('messageScore').textContent = '';
                    document.getElementById('gameMessage').classList.add('show');
                    if (duration) {
                        setTimeout(() => {
                            document.getElementById('gameMessage').classList.remove('show');
                        }, duration);
                    }
                }
        
                function updateDisplay() {
                    document.getElementById('score').textContent = score;
                    document.getElementById('level').textContent = level;
                    document.getElementById('lives').textContent = lives;
                    // expose minimal state for module script
                    window.currentScore = score;
                    window.currentLevel = level;
                }
        
                function createPowerUp(x, y) {
                    if (Math.random() < 0.1) {
                        powerUp = {
                            x: x,
                            y: y,
                            width: 20,
                            height: 20,
                            speed: 2,
                            type: Math.random() < 0.5 ? 'expand' : 'multiball'
                        };
                    }
                }
        
                function activatePowerUp(type) {
                    if (type === 'expand') {
                        paddle.width = 180;
                        paddleExpanded = true;
                        paddleExpandTimer = 600;
                        document.getElementById('powerUpDisplay').textContent = 'PADDLE EXPANDED';
                    }
                }
        
                function drawBricks() {
                    for (let c = 0; c < brickColumnCount; c++) {
                        for (let r = 0; r < brickRowCount; r++) {
                            if (!bricks[c] || !bricks[c][r]) continue;
                            if (bricks[c][r].status > 0) {
                                const brickX = c * (brickWidth + brickPadding) + brickOffsetLeft;
                                const brickY = r * (brickHeight + brickPadding) + brickOffsetTop;
                                bricks[c][r].x = brickX;
                                bricks[c][r].y = brickY;
        
                                const opacity = bricks[c][r].status / bricks[c][r].maxHits;
                                ctx.fillStyle = `rgba(0, 153, 255, ${opacity})`;
                                ctx.fillRect(brickX, brickY, brickWidth, brickHeight);

                                ctx.strokeStyle = '#0099ff';
                                ctx.strokeRect(brickX, brickY, brickWidth, brickHeight);
        
                                ctx.font = '10px Share Tech Mono';
                                ctx.fillStyle = '#000';
                                ctx.fillText(bricks[c][r].status, brickX + brickWidth/2 - 3, brickY + brickHeight/2 + 3);
                            }
                        }
                    }
                }
        
                function drawPaddle() {
                    ctx.fillStyle = '#0099ff';
                    ctx.fillRect(paddle.x, paddle.y, paddle.width, paddle.height);
                    ctx.strokeStyle = '#0077cc';
                    ctx.strokeRect(paddle.x, paddle.y, paddle.width, paddle.height);
                }
        
                function drawBall() {
                    ctx.fillStyle = '#0099ff';
                    ctx.beginPath();
                    ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
                    ctx.fill();
                    ctx.strokeStyle = '#0099ff';
                    ctx.stroke();
                }
        
                function drawPowerUp() {
                    if (powerUp) {
                        ctx.fillStyle = '#ffff00';
                        ctx.fillRect(powerUp.x, powerUp.y, powerUp.width, powerUp.height);
                        ctx.strokeStyle = '#ffff00';
                        ctx.strokeRect(powerUp.x, powerUp.y, powerUp.width, powerUp.height);
        
                        ctx.font = '12px Share Tech Mono';
                        ctx.fillStyle = '#000';
                        ctx.fillText('P', powerUp.x + 6, powerUp.y + 14);
                    }
                }
        
                function collisionDetection() {
                    for (let c = 0; c < brickColumnCount; c++) {
                        for (let r = 0; r < brickRowCount; r++) {
                            const b = bricks[c][r];
                            if (b.status > 0) {
                                if (ball.x + ball.radius > b.x &&
                                    ball.x - ball.radius < b.x + brickWidth &&
                                    ball.y + ball.radius > b.y &&
                                    ball.y - ball.radius < b.y + brickHeight) {
        
                                    ball.speedY = -ball.speedY;
                                    b.status--;
        
                                    if (b.status === 0) {
                                        score += (b.maxHits * 10);
                                        createPowerUp(b.x + brickWidth/2, b.y + brickHeight/2);
                                    } else {
                                        score += 5;
                                    }
        
                                    updateDisplay();
        
                                    const remainingBricks = bricks.flat().filter(brick => brick.status > 0).length;
                                    if (remainingBricks === 0) {
                                        nextLevel();
                                    }
                                }
                            }
                        }
                    }
                }
        
                function update() {
                    if (!gameRunning || paused) return;
        
                    if (keys['ArrowLeft'] || keys['a'] || keys['A']) {
                        paddle.x = Math.max(0, paddle.x - paddle.speed);
                    }
                    if (keys['ArrowRight'] || keys['d'] || keys['D']) {
                        paddle.x = Math.min(canvas.width - paddle.width, paddle.x + paddle.speed);
                    }
        
                    if (ball.attached) {
                        ball.x = paddle.x + paddle.width / 2;
                        ball.y = paddle.y - 10;
                    } else {
                        ball.x += ball.speedX;
                        ball.y += ball.speedY;
        
                        if (ball.x + ball.radius > canvas.width || ball.x - ball.radius < 0) {
                            ball.speedX = -ball.speedX;
                        }
                        if (ball.y - ball.radius < 0) {
                            ball.speedY = -ball.speedY;
                        }
        
                        if (ball.x > paddle.x &&
                            ball.x < paddle.x + paddle.width &&
                            ball.y + ball.radius > paddle.y &&
                            ball.y - ball.radius < paddle.y + paddle.height) {
        
                            ball.speedY = -Math.abs(ball.speedY);
                            const hitPos = (ball.x - paddle.x) / paddle.width;
                            ball.speedX = 8 * (hitPos - 0.5);
                        }
        
                        if (ball.y > canvas.height) {
                            lives--;
                            updateDisplay();
                            if (lives === 0) {
                                gameOver();
                            } else {
                                resetBall();
                            }
                        }
        
                        collisionDetection();
                    }
        
                    if (powerUp) {
                        powerUp.y += powerUp.speed;
        
                        if (powerUp.x < paddle.x + paddle.width &&
                            powerUp.x + powerUp.width > paddle.x &&
                            powerUp.y < paddle.y + paddle.height &&
                            powerUp.y + powerUp.height > paddle.y) {
        
                            activatePowerUp(powerUp.type);
                            powerUp = null;
                        }
        
                        if (powerUp && powerUp.y > canvas.height) {
                            powerUp = null;
                        }
                    }
        
                    if (paddleExpanded) {
                        paddleExpandTimer--;
                        if (paddleExpandTimer <= 0) {
                            paddle.width = 120;
                            paddleExpanded = false;
                            document.getElementById('powerUpDisplay').textContent = '';
                        }
                    }
                }
        
                function draw() {
                    ctx.fillStyle = '#000';
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
        
                    drawBricks();
                    drawPaddle();
                    drawBall();
                    drawPowerUp();
        
                    ctx.strokeStyle = '#0099ff';
                    ctx.lineWidth = 2;
                    ctx.strokeRect(0, 0, canvas.width, canvas.height);
                }
        
                function gameLoop() {
                    update();
                    draw();
                    requestAnimationFrame(gameLoop);
                }
        
                      async function init() {
                        document.addEventListener('keydown', (e) => {
                            keys[e.key] = true;
                
                            if (e.key === ' ') {
                                if (!gameRunning) {
                                    startGame();
                                } else {
                                    launchBall();
                                }
                            }
                
                            if (e.key === 'p' || e.key === 'P') {
                                if (gameRunning) {
                                    paused = !paused;
                                    const pr = document.getElementById('pausedRibbon');
                                    if (pr) pr.style.display = paused ? 'block' : 'none';
                                }
                            }
                        });
                
                        document.addEventListener('keyup', (e) => {
                            keys[e.key] = false;
                        });
                
                        let touchX = null;
                
                        canvas.addEventListener('touchstart', (e) => {
                            touchX = e.touches[0].clientX;
                            if (ball.attached) {
                                launchBall();
                            }
                        });
                
                        canvas.addEventListener('touchmove', (e) => {
                            if (touchX !== null) {
                                const deltaX = e.touches[0].clientX - touchX;
                                paddle.x = Math.max(0, Math.min(canvas.width - paddle.width, paddle.x + deltaX));
                                touchX = e.touches[0].clientX;
                            }
                        });
                
                        canvas.addEventListener('touchend', () => {
                            touchX = null;
                        });
                
                        canvas.addEventListener('mousemove', (e) => {
                            if (gameRunning && !paused) {
                                const rect = canvas.getBoundingClientRect();
                                const mouseX = e.clientX - rect.left;
                                paddle.x = Math.max(0, Math.min(canvas.width - paddle.width, mouseX - paddle.width / 2));
                            }
                        });
                
                        canvas.addEventListener('click', () => {
                            if (gameRunning && ball.attached) {
                                launchBall();
                            }
                        });
                
                        document.getElementById('gameMessage').classList.add('show');
                        // Ensure bricks exist before the first draw to avoid undefined access
                        initBricks();
                        resetBall();
                        updateDisplay();
                        gameLoop();

                        // Use localStorage for high score
                        const localBest = localStorage.getItem('breakoutHighScore');
                        if (localBest) {
                            document.getElementById('highScore').textContent = localBest;
                        }

                        // Share button
                        const shareBtn = document.getElementById('shareBtn');
                        if (shareBtn) {
                          shareBtn.addEventListener('click', async () => {
                            const shareData = {
                              title: 'BREAKOUT_MATRIX',
                              text: 'Terminal-style Breakout. Smash glowing code blocks!',
                              url: 'https://app.vibecodedbyx.com/breakout-terminal/'
                            };
                            const toast = document.getElementById('toast');
                            try {
                              if (navigator.share) {
                                await navigator.share(shareData);
                              } else {
                                await navigator.clipboard.writeText(shareData.url);
                                toast.textContent = 'Link copied!';
                                toast.classList.add('show');
                                setTimeout(()=>toast.classList.remove('show'), 1500);
                              }
                            } catch (err) {
                              try {
                                await navigator.clipboard.writeText(shareData.url);
                                toast.textContent = 'Link copied!';
                                toast.classList.add('show');
                                setTimeout(()=>toast.classList.remove('show'), 1500);
                              } catch (_) {
                                console.warn('Share failed:', err);
                              }
                            }
                          });
                        }
                      }

                      init();
                    </script>

    <script type="module">
      import supabase, { supabaseSession } from './supabase-config.js';

      const list = document.getElementById('leaderboardList');
      const refreshBtn = document.getElementById('refreshBoardBtn');
      const submitBtn = document.getElementById('submitScoreBtn');
      const nameInput = document.getElementById('displayNameInput');
      const statusEl = document.getElementById('submitStatus');

      const render = (rows=[]) => {
        if (!list) return;
        list.innerHTML = '';
        if (!rows.length) {
          const li = document.createElement('li');
          li.textContent = 'No scores yet ‚Äî be the first!';
          list.appendChild(li);
          return;
        }
        rows.forEach((r, i) => {
          const li = document.createElement('li');
          const name = (r.display_name || '').trim() || 'anonymous';
          li.textContent = `#${i+1} ${name} ‚Äî ${r.score} (L${r.level||1})`;
          list.appendChild(li);
        });
      };

      async function loadBoard() {
        try {
          const { data, error } = await supabase
            .from('breakout_terminal_scores')
            .select('display_name, score, level')
            .order('score', { ascending: false })
            .limit(10);
          if (error) throw error;
          render(data || []);
        } catch (e) {
          console.warn('Leaderboard load failed:', e?.message || e);
          render([]);
        }
      }

      refreshBtn?.addEventListener('click', loadBoard);

      submitBtn?.addEventListener('click', async () => {
        try {
          statusEl.textContent = 'Submitting‚Ä¶';
          const { user } = await supabaseSession();
          const payload = {
            user_id: user.id,
            score: Number(window.currentScore || 0) || 0,
            level: Number(window.currentLevel || 1) || 1,
            display_name: (nameInput?.value || '').slice(0, 20)
          };
          const { error } = await supabase.from('breakout_terminal_scores').insert(payload);
          if (error) throw error;
          statusEl.textContent = 'Saved!';
          await loadBoard();
        } catch (e) {
          statusEl.textContent = 'Save failed. Try again later.';
          console.error('Score submit error:', e?.message || e);
        }
      });

      window.addEventListener('breakout:gameOver', () => {
        try {
          const cached = localStorage.getItem('displayName');
          if (cached && nameInput && !nameInput.value) nameInput.value = cached;
        } catch {}
      });

      nameInput?.addEventListener('change', () => {
        try { localStorage.setItem('displayName', (nameInput.value||'').slice(0,20)); } catch {}
      });

      loadBoard();
    </script>
          </body>
        </html>
