<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Treasure Calculator - Solve Sums, Find Gold</title>
  <link rel="icon" href="https://emojicdn.elk.sh/ðŸ´â€â˜ ï¸">
  <meta property="og:title" content="Treasure Calculator">
  <meta property="og:description" content="Solve pirate math to uncover buried treasure and nautical lore!">
  <meta property="og:url" content="https://sloppy.live/treasure-calculator">
  <meta property="og:image" content="https://emojicdn.elk.sh/ðŸ’°?style=apple&size=512">
  <link href="https://fonts.googleapis.com/css2?family=Pirata+One&family=IM+Fell+English+SC&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --gold: #d4a84b;
      --dark-gold: #8b6914;
      --ocean: #0d1a2a;
      --ocean-light: #1a3a5c;
      --wood: #5c3a1e;
      --wood-light: #8b5a2b;
      --parchment: #f4e4bc;
      --blood: #8b0000;
    }

    body {
      font-family: 'IM Fell English SC', serif;
      background: var(--ocean);
      min-height: 100vh;
      color: var(--parchment);
      overflow-x: hidden;
    }

    .ocean-bg {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background:
        radial-gradient(ellipse at 50% 100%, #1a4a6e 0%, transparent 60%),
        linear-gradient(180deg, #0d1a2a 0%, #0a2540 50%, #0d3050 100%);
      z-index: -1;
    }

    .waves {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 200%;
      height: 150px;
      background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1200 120'%3E%3Cpath fill='%231a3a5c' d='M0,60 C300,100 400,20 600,60 C800,100 900,20 1200,60 L1200,120 L0,120 Z'/%3E%3C/svg%3E") repeat-x;
      animation: waves 8s linear infinite;
      opacity: 0.5;
      z-index: -1;
    }

    @keyframes waves {
      0% { transform: translateX(0); }
      100% { transform: translateX(-50%); }
    }

    .container {
      max-width: 600px;
      margin: 0 auto;
      padding: 20px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      text-align: center;
      padding: 20px 0;
    }

    h1 {
      font-family: 'Pirata One', cursive;
      font-size: 2.8rem;
      color: var(--gold);
      text-shadow: 3px 3px 0 var(--wood), 0 0 20px rgba(212, 168, 75, 0.5);
      margin-bottom: 10px;
    }

    .subtitle {
      font-size: 1rem;
      color: var(--parchment);
      opacity: 0.8;
    }

    .level-select {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 20px 0;
      flex-wrap: wrap;
    }

    .level-btn {
      font-family: 'Pirata One', cursive;
      font-size: 1.2rem;
      padding: 12px 24px;
      border: 3px solid var(--gold);
      background: linear-gradient(180deg, var(--wood-light) 0%, var(--wood) 100%);
      color: var(--gold);
      cursor: pointer;
      transition: all 0.3s;
      position: relative;
      overflow: hidden;
    }

    .level-btn:hover, .level-btn.active {
      background: linear-gradient(180deg, var(--gold) 0%, var(--dark-gold) 100%);
      color: var(--ocean);
      transform: scale(1.05);
      box-shadow: 0 0 20px rgba(212, 168, 75, 0.5);
    }

    .level-btn .stars {
      display: block;
      font-size: 0.8rem;
      margin-top: 5px;
    }

    .game-area {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 20px;
    }

    .treasure-chest {
      width: 120px;
      height: 100px;
      position: relative;
      margin: 20px auto;
      transition: transform 0.5s;
    }

    .chest-body {
      width: 100%;
      height: 70%;
      background: linear-gradient(180deg, var(--wood-light) 0%, var(--wood) 100%);
      border: 4px solid var(--dark-gold);
      border-radius: 0 0 10px 10px;
      position: absolute;
      bottom: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .chest-lock {
      width: 20px;
      height: 25px;
      background: var(--gold);
      border-radius: 50% 50% 5px 5px;
      position: relative;
    }

    .chest-lock::after {
      content: '';
      position: absolute;
      width: 8px;
      height: 8px;
      background: var(--ocean);
      border-radius: 50%;
      top: 8px;
      left: 6px;
    }

    .chest-lid {
      width: 100%;
      height: 40%;
      background: linear-gradient(180deg, var(--wood) 0%, var(--wood-light) 100%);
      border: 4px solid var(--dark-gold);
      border-radius: 10px 10px 0 0;
      position: absolute;
      top: 0;
      transform-origin: bottom;
      transition: transform 0.5s;
    }

    .chest-open .chest-lid {
      transform: rotateX(-110deg);
    }

    .chest-glow {
      position: absolute;
      width: 80%;
      height: 30px;
      background: radial-gradient(ellipse, rgba(255, 215, 0, 0.8) 0%, transparent 70%);
      top: 30%;
      left: 10%;
      opacity: 0;
      transition: opacity 0.5s;
    }

    .chest-open .chest-glow {
      opacity: 1;
      animation: glow-pulse 1s ease-in-out infinite;
    }

    @keyframes glow-pulse {
      0%, 100% { opacity: 0.6; }
      50% { opacity: 1; }
    }

    .problem-card {
      background: linear-gradient(135deg, var(--parchment) 0%, #e8d4a8 100%);
      border: 4px solid var(--wood);
      border-radius: 5px;
      padding: 30px 50px;
      text-align: center;
      box-shadow: 5px 5px 15px rgba(0,0,0,0.5);
      position: relative;
    }

    .problem-card::before {
      content: 'â˜ ';
      position: absolute;
      top: 5px;
      left: 10px;
      font-size: 1.2rem;
      opacity: 0.3;
    }

    .problem-card::after {
      content: 'â˜ ';
      position: absolute;
      top: 5px;
      right: 10px;
      font-size: 1.2rem;
      opacity: 0.3;
    }

    .problem {
      font-family: 'Pirata One', cursive;
      font-size: 3rem;
      color: var(--ocean);
      margin-bottom: 20px;
    }

    .answer-input {
      font-family: 'Pirata One', cursive;
      font-size: 2rem;
      width: 150px;
      padding: 10px;
      text-align: center;
      border: 3px solid var(--wood);
      background: #fff;
      color: var(--ocean);
      border-radius: 5px;
    }

    .answer-input:focus {
      outline: none;
      border-color: var(--gold);
      box-shadow: 0 0 10px rgba(212, 168, 75, 0.5);
    }

    .submit-btn {
      font-family: 'Pirata One', cursive;
      font-size: 1.5rem;
      padding: 15px 40px;
      background: linear-gradient(180deg, var(--gold) 0%, var(--dark-gold) 100%);
      border: 3px solid var(--wood);
      color: var(--ocean);
      cursor: pointer;
      margin-top: 15px;
      transition: all 0.3s;
    }

    .submit-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 0 20px rgba(212, 168, 75, 0.7);
    }

    .stats {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin: 20px 0;
      font-size: 1.2rem;
    }

    .stat {
      text-align: center;
    }

    .stat-value {
      font-family: 'Pirata One', cursive;
      font-size: 2rem;
      color: var(--gold);
    }

    .lore-reveal {
      background: linear-gradient(135deg, rgba(13, 26, 42, 0.95) 0%, rgba(26, 58, 92, 0.95) 100%);
      border: 3px solid var(--gold);
      border-radius: 10px;
      padding: 20px;
      margin: 20px 0;
      text-align: center;
      animation: fadeIn 0.5s;
      max-width: 100%;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .lore-title {
      font-family: 'Pirata One', cursive;
      font-size: 1.5rem;
      color: var(--gold);
      margin-bottom: 10px;
    }

    .lore-text {
      font-size: 1rem;
      line-height: 1.6;
      color: var(--parchment);
    }

    .treasure-found {
      font-size: 3rem;
      animation: bounce 0.5s;
    }

    @keyframes bounce {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.3); }
    }

    .progress-bar {
      width: 100%;
      height: 20px;
      background: var(--wood);
      border: 2px solid var(--gold);
      border-radius: 10px;
      overflow: hidden;
      margin: 10px 0;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--gold) 0%, #ffd700 100%);
      transition: width 0.5s;
    }

    .level-complete {
      text-align: center;
      animation: fadeIn 0.5s;
    }

    .level-complete h2 {
      font-family: 'Pirata One', cursive;
      font-size: 2.5rem;
      color: var(--gold);
      margin-bottom: 20px;
    }

    .coins {
      position: fixed;
      pointer-events: none;
      z-index: 100;
    }

    .coin {
      position: absolute;
      font-size: 2rem;
      animation: coinFall 1s forwards;
    }

    @keyframes coinFall {
      0% { transform: translateY(0) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100px) rotate(360deg); opacity: 0; }
    }

    .backlink {
      text-align: center;
      padding: 20px;
      opacity: 0.7;
    }

    .backlink a {
      color: var(--gold);
      text-decoration: none;
    }

    .shake {
      animation: shake 0.5s;
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px); }
      75% { transform: translateX(10px); }
    }

    .hidden { display: none !important; }

    @media (max-width: 500px) {
      h1 { font-size: 2rem; }
      .problem { font-size: 2.2rem; }
      .problem-card { padding: 20px 30px; }
      .level-btn { padding: 10px 16px; font-size: 1rem; }
    }
  </style>
</head>
<body>
  <div class="ocean-bg"></div>
  <div class="waves"></div>

  <div class="container">
    <header>
      <h1>Treasure Calculator</h1>
      <p class="subtitle">Solve ye sums to unlock buried treasure!</p>
    </header>

    <div class="level-select">
      <button class="level-btn active" data-level="1">
        Level 1
        <span class="stars">âš“ Cabin Boy</span>
      </button>
      <button class="level-btn" data-level="2">
        Level 2
        <span class="stars">âš“âš“ First Mate</span>
      </button>
      <button class="level-btn" data-level="3">
        Level 3
        <span class="stars">âš“âš“âš“ Captain</span>
      </button>
    </div>

    <div class="stats">
      <div class="stat">
        <div class="stat-value" id="gold-count">0</div>
        <div>Gold Doubloons</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="streak">0</div>
        <div>Streak</div>
      </div>
    </div>

    <div class="progress-bar">
      <div class="progress-fill" id="progress" style="width: 0%"></div>
    </div>

    <div class="game-area">
      <div class="treasure-chest" id="chest">
        <div class="chest-glow"></div>
        <div class="chest-lid"></div>
        <div class="chest-body">
          <div class="chest-lock"></div>
        </div>
      </div>

      <div class="problem-card" id="problem-card">
        <div class="problem" id="problem">12 + 7 = ?</div>
        <input type="number" class="answer-input" id="answer" placeholder="?" autofocus>
        <br>
        <button class="submit-btn" id="submit">Plunder!</button>
      </div>

      <div class="lore-reveal hidden" id="lore">
        <div class="treasure-found" id="treasure-icon">ðŸ’°</div>
        <div class="lore-title" id="lore-title">Treasure Found!</div>
        <div class="lore-text" id="lore-text"></div>
      </div>

      <div class="level-complete hidden" id="level-complete">
        <h2>Level Complete!</h2>
        <p>Ye've proven yerself worthy, sailor!</p>
        <button class="submit-btn" id="next-level">Next Adventure</button>
      </div>
    </div>

    <div class="backlink">
      <a href="https://sloppy.live">âš“ Back to sloppy.live</a>
    </div>
  </div>

  <div class="coins" id="coins"></div>

  <script>
    const levels = {
      1: { name: 'Cabin Boy', ops: ['+', '-'], range: [1, 20], problems: 5 },
      2: { name: 'First Mate', ops: ['+', '-', 'Ã—'], range: [1, 12], problems: 7 },
      3: { name: 'Captain', ops: ['+', '-', 'Ã—', 'Ã·'], range: [2, 15], problems: 10 }
    };

    const treasures = [
      { icon: 'ðŸ’°', name: 'Gold Doubloons' },
      { icon: 'ðŸ’Ž', name: 'Sapphire Gem' },
      { icon: 'ðŸ‘‘', name: 'Royal Crown' },
      { icon: 'ðŸ—¡ï¸', name: 'Cutlass' },
      { icon: 'ðŸ”±', name: 'Trident' },
      { icon: 'ðŸ“œ', name: 'Ancient Map' },
      { icon: 'ðŸº', name: 'Treasure Urn' },
      { icon: 'âš“', name: 'Golden Anchor' },
      { icon: 'ðŸ¦œ', name: 'Parrot Companion' },
      { icon: 'ðŸ§­', name: 'Enchanted Compass' }
    ];

    const lore = [
      "The Kraken sleeps beneath these waters, awaiting the call of the ancient horn.",
      "Davy Jones' Locker holds the souls of a thousand sailors who dared challenge the sea.",
      "The Flying Dutchman can never make port, doomed to sail the seas forever.",
      "X marks the spot, but only those pure of heart can see the true treasure.",
      "A pirate's life be free, but the sea demands her toll in salt and blood.",
      "The compass points not north, but to what ye desire most in this world.",
      "Blackbeard lit fuses in his beard to appear as a demon from hell itself.",
      "The Jolly Roger strikes fear into merchant hearts across the seven seas.",
      "Dead men tell no tales, unless ye know the words to wake them.",
      "The sea be a cruel mistress, but she rewards the bold and punishes the meek.",
      "Neptune's trident commands the waves - respect it or be swallowed whole.",
      "Pieces of eight were Spanish dollars cut into eight bits for trade.",
      "Walking the plank was rare - most pirates simply threw enemies overboard.",
      "The golden age of piracy lasted only from 1650 to 1730.",
      "Port Royal was called the 'wickedest city on Earth' before the sea claimed it.",
      "A ship's cat was considered good luck and protected stores from rats.",
      "Grog was rum mixed with water to prevent sailors from hoarding alcohol.",
      "The Barbary pirates of North Africa terrorized seas for over 300 years.",
      "Marooning was the cruelest punishment - left alone on a deserted island.",
      "The black spot was a death threat delivered on a piece of paper."
    ];

    let currentLevel = 1;
    let gold = 0;
    let streak = 0;
    let solved = 0;
    let currentAnswer = 0;
    let usedLore = [];

    const problemEl = document.getElementById('problem');
    const answerEl = document.getElementById('answer');
    const submitBtn = document.getElementById('submit');
    const chestEl = document.getElementById('chest');
    const loreEl = document.getElementById('lore');
    const loreTitleEl = document.getElementById('lore-title');
    const loreTextEl = document.getElementById('lore-text');
    const treasureIconEl = document.getElementById('treasure-icon');
    const progressEl = document.getElementById('progress');
    const goldCountEl = document.getElementById('gold-count');
    const streakEl = document.getElementById('streak');
    const levelCompleteEl = document.getElementById('level-complete');
    const problemCardEl = document.getElementById('problem-card');
    const coinsEl = document.getElementById('coins');
    const levelBtns = document.querySelectorAll('.level-btn');

    function generateProblem() {
      const level = levels[currentLevel];
      const op = level.ops[Math.floor(Math.random() * level.ops.length)];
      let a, b, answer;

      if (op === '+') {
        a = Math.floor(Math.random() * level.range[1]) + level.range[0];
        b = Math.floor(Math.random() * level.range[1]) + level.range[0];
        answer = a + b;
      } else if (op === '-') {
        a = Math.floor(Math.random() * level.range[1]) + level.range[0];
        b = Math.floor(Math.random() * a) + 1;
        answer = a - b;
      } else if (op === 'Ã—') {
        a = Math.floor(Math.random() * level.range[1]) + level.range[0];
        b = Math.floor(Math.random() * 10) + 2;
        answer = a * b;
      } else if (op === 'Ã·') {
        b = Math.floor(Math.random() * 10) + 2;
        answer = Math.floor(Math.random() * 10) + 2;
        a = b * answer;
      }

      currentAnswer = answer;
      problemEl.textContent = `${a} ${op} ${b} = ?`;
    }

    function showLore(correct) {
      const treasure = treasures[Math.floor(Math.random() * treasures.length)];
      let loreText;

      if (usedLore.length >= lore.length) usedLore = [];
      do {
        loreText = lore[Math.floor(Math.random() * lore.length)];
      } while (usedLore.includes(loreText));
      usedLore.push(loreText);

      treasureIconEl.textContent = treasure.icon;
      loreTitleEl.textContent = `${treasure.name} Found!`;
      loreTextEl.textContent = loreText;
      loreEl.classList.remove('hidden');

      // Spawn coins
      for (let i = 0; i < 5; i++) {
        setTimeout(() => spawnCoin(), i * 100);
      }
    }

    function spawnCoin() {
      const coin = document.createElement('div');
      coin.className = 'coin';
      coin.textContent = 'ðŸª™';
      coin.style.left = (Math.random() * window.innerWidth) + 'px';
      coin.style.top = (Math.random() * 200 + 100) + 'px';
      coinsEl.appendChild(coin);
      setTimeout(() => coin.remove(), 1000);
    }

    function checkAnswer() {
      const userAnswer = parseInt(answerEl.value);

      if (isNaN(userAnswer)) return;

      if (userAnswer === currentAnswer) {
        // Correct!
        chestEl.classList.add('chest-open');
        streak++;
        solved++;
        gold += 10 * currentLevel * (1 + Math.floor(streak / 3));

        goldCountEl.textContent = gold;
        streakEl.textContent = streak;
        progressEl.style.width = (solved / levels[currentLevel].problems * 100) + '%';

        showLore(true);

        setTimeout(() => {
          chestEl.classList.remove('chest-open');
          loreEl.classList.add('hidden');

          if (solved >= levels[currentLevel].problems) {
            // Level complete
            problemCardEl.classList.add('hidden');
            levelCompleteEl.classList.remove('hidden');
          } else {
            generateProblem();
            answerEl.value = '';
            answerEl.focus();
          }
        }, 3000);
      } else {
        // Wrong
        streak = 0;
        streakEl.textContent = streak;
        problemCardEl.classList.add('shake');
        setTimeout(() => problemCardEl.classList.remove('shake'), 500);
        answerEl.value = '';
        answerEl.focus();
      }
    }

    function setLevel(level) {
      currentLevel = level;
      solved = 0;
      progressEl.style.width = '0%';

      levelBtns.forEach(btn => {
        btn.classList.toggle('active', parseInt(btn.dataset.level) === level);
      });

      problemCardEl.classList.remove('hidden');
      levelCompleteEl.classList.add('hidden');
      loreEl.classList.add('hidden');

      generateProblem();
      answerEl.value = '';
      answerEl.focus();
    }

    // Event listeners
    submitBtn.addEventListener('click', checkAnswer);
    answerEl.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') checkAnswer();
    });

    levelBtns.forEach(btn => {
      btn.addEventListener('click', () => setLevel(parseInt(btn.dataset.level)));
    });

    document.getElementById('next-level').addEventListener('click', () => {
      if (currentLevel < 3) {
        setLevel(currentLevel + 1);
      } else {
        setLevel(1);
      }
    });

    // Init
    generateProblem();
  </script>
</body>
</html>
