<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Snowball Fight</title>
  <link rel="icon" href="https://emojicdn.elk.sh/‚ùÑÔ∏è">

  <meta property="og:title" content="Snowball Fight">
  <meta property="og:description" content="Type messages to throw snowballs at the target!">
  <meta property="og:url" content="https://sloppy.live/snowball-fight">
  <meta property="og:image" content="https://sloppy.live/snowball-fight/og-image.png">
  <meta property="og:type" content="website">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:wght@400;700&family=Fira+Code:wght@400;600&display=swap" rel="stylesheet">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Crimson Pro', serif;
      overflow: hidden;
      background: linear-gradient(180deg, #1a2a4a 0%, #2d4a6d 40%, #4a6d8a 100%);
      min-height: 100vh;
      position: relative;
    }

    #game-container {
      width: 100vw;
      height: 100vh;
      position: relative;
      overflow: hidden;
    }

    /* Snow ground */
    .ground {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 25%;
      background: linear-gradient(180deg, #e8f4f8 0%, #d0e8f0 100%);
      border-top: 4px solid #fff;
      box-shadow: 0 -10px 30px rgba(255,255,255,0.5);
    }

    .ground::before {
      content: '';
      position: absolute;
      top: -20px;
      left: 0;
      width: 100%;
      height: 40px;
      background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 20'%3E%3Cellipse cx='10' cy='15' rx='12' ry='8' fill='%23fff'/%3E%3Cellipse cx='35' cy='12' rx='15' ry='10' fill='%23fff'/%3E%3Cellipse cx='60' cy='14' rx='10' ry='7' fill='%23fff'/%3E%3Cellipse cx='85' cy='13' rx='14' ry='9' fill='%23fff'/%3E%3C/svg%3E") repeat-x;
      background-size: 200px 40px;
    }

    /* Trees in background */
    .trees {
      position: absolute;
      bottom: 20%;
      width: 100%;
      height: 200px;
      pointer-events: none;
    }

    .tree {
      position: absolute;
      bottom: 0;
      width: 0;
      height: 0;
      border-left: 30px solid transparent;
      border-right: 30px solid transparent;
      border-bottom: 80px solid #1a4a2a;
      filter: brightness(0.7);
    }

    .tree::before {
      content: '';
      position: absolute;
      top: 30px;
      left: -25px;
      width: 0;
      height: 0;
      border-left: 25px solid transparent;
      border-right: 25px solid transparent;
      border-bottom: 70px solid #1a4a2a;
    }

    .tree::after {
      content: '';
      position: absolute;
      top: 55px;
      left: -20px;
      width: 0;
      height: 0;
      border-left: 20px solid transparent;
      border-right: 20px solid transparent;
      border-bottom: 60px solid #1a4a2a;
    }

    /* Snowman target */
    #target {
      position: absolute;
      bottom: 25%;
      cursor: default;
      transition: transform 0.1s ease-out;
      z-index: 10;
    }

    .snowman {
      position: relative;
      animation: wobble 3s ease-in-out infinite;
    }

    @keyframes wobble {
      0%, 100% { transform: rotate(-2deg); }
      50% { transform: rotate(2deg); }
    }

    .snowman-body {
      width: 80px;
      height: 80px;
      background: radial-gradient(circle at 30% 30%, #fff 0%, #e0e8ec 100%);
      border-radius: 50%;
      position: relative;
      box-shadow: inset -10px -10px 20px rgba(0,0,0,0.1), 0 5px 15px rgba(0,0,0,0.2);
    }

    .snowman-middle {
      width: 60px;
      height: 60px;
      background: radial-gradient(circle at 30% 30%, #fff 0%, #e0e8ec 100%);
      border-radius: 50%;
      position: absolute;
      bottom: 65px;
      left: 10px;
      box-shadow: inset -8px -8px 15px rgba(0,0,0,0.1), 0 5px 15px rgba(0,0,0,0.2);
    }

    .snowman-head {
      width: 45px;
      height: 45px;
      background: radial-gradient(circle at 30% 30%, #fff 0%, #e0e8ec 100%);
      border-radius: 50%;
      position: absolute;
      bottom: 115px;
      left: 17px;
      box-shadow: inset -6px -6px 12px rgba(0,0,0,0.1), 0 5px 15px rgba(0,0,0,0.2);
    }

    /* Snowman face */
    .snowman-head::before {
      content: 'üëÄ';
      position: absolute;
      top: 8px;
      left: 8px;
      font-size: 14px;
    }

    .carrot {
      position: absolute;
      top: 18px;
      left: 38px;
      width: 0;
      height: 0;
      border-top: 4px solid transparent;
      border-bottom: 4px solid transparent;
      border-left: 20px solid #ff6b35;
    }

    .hat {
      position: absolute;
      bottom: 155px;
      left: 15px;
      width: 50px;
      height: 8px;
      background: #1a1a2e;
      border-radius: 2px;
    }

    .hat::before {
      content: '';
      position: absolute;
      bottom: 8px;
      left: 10px;
      width: 30px;
      height: 30px;
      background: #1a1a2e;
      border-radius: 3px 3px 0 0;
    }

    .hat::after {
      content: '';
      position: absolute;
      bottom: 8px;
      left: 10px;
      width: 30px;
      height: 8px;
      background: #c41e3a;
    }

    /* Scarf */
    .scarf {
      position: absolute;
      bottom: 110px;
      left: 12px;
      width: 55px;
      height: 10px;
      background: #c41e3a;
      border-radius: 3px;
    }

    .scarf::after {
      content: '';
      position: absolute;
      top: 8px;
      right: 5px;
      width: 12px;
      height: 25px;
      background: #c41e3a;
      border-radius: 0 0 3px 3px;
    }

    /* Buttons */
    .buttons {
      position: absolute;
      bottom: 75px;
      left: 35px;
    }

    .btn {
      width: 8px;
      height: 8px;
      background: #1a1a2e;
      border-radius: 50%;
      margin-bottom: 8px;
    }

    /* Hit effect */
    .snowman.hit {
      animation: shake 0.3s ease-in-out;
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-10px) rotate(-5deg); }
      75% { transform: translateX(10px) rotate(5deg); }
    }

    /* Snowballs */
    .snowball {
      position: absolute;
      width: 20px;
      height: 20px;
      background: radial-gradient(circle at 30% 30%, #fff 0%, #d0e0e8 100%);
      border-radius: 50%;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
      z-index: 100;
      pointer-events: none;
    }

    .snowball.splat {
      animation: splat 0.4s ease-out forwards;
    }

    @keyframes splat {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(2, 0.5); opacity: 0.8; }
      100% { transform: scale(3, 0.2); opacity: 0; }
    }

    /* Snow particles */
    .snowflake {
      position: absolute;
      color: #fff;
      font-size: 10px;
      opacity: 0.8;
      pointer-events: none;
      animation: fall linear infinite;
      text-shadow: 0 0 5px rgba(255,255,255,0.5);
    }

    @keyframes fall {
      0% {
        transform: translateY(-10px) rotate(0deg);
        opacity: 0;
      }
      10% { opacity: 0.8; }
      90% { opacity: 0.8; }
      100% {
        transform: translateY(100vh) rotate(360deg);
        opacity: 0;
      }
    }

    /* UI Elements */
    #score-display {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(255,255,255,0.15);
      backdrop-filter: blur(10px);
      padding: 15px 25px;
      border-radius: 15px;
      border: 1px solid rgba(255,255,255,0.3);
      color: #fff;
      font-family: 'Fira Code', monospace;
      font-size: 18px;
      z-index: 1000;
    }

    #score-display span {
      font-weight: 600;
      font-size: 24px;
      color: #ffd700;
    }

    /* Chat input */
    #chat-area {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 10px;
      z-index: 1000;
      width: 90%;
      max-width: 500px;
    }

    #chat-input {
      flex: 1;
      padding: 15px 20px;
      font-size: 18px;
      font-family: 'Crimson Pro', serif;
      border: none;
      border-radius: 30px;
      background: rgba(255,255,255,0.95);
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
      outline: none;
      color: #1a2a4a;
    }

    #chat-input::placeholder {
      color: #6a8a9a;
    }

    #chat-input:focus {
      box-shadow: 0 4px 25px rgba(255,215,0,0.4);
    }

    #throw-btn {
      padding: 15px 25px;
      font-size: 20px;
      font-family: 'Fira Code', monospace;
      font-weight: 600;
      background: linear-gradient(135deg, #c41e3a 0%, #8b1538 100%);
      color: #fff;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      transition: all 0.2s ease;
      box-shadow: 0 4px 15px rgba(196, 30, 58, 0.4);
    }

    #throw-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 6px 20px rgba(196, 30, 58, 0.6);
    }

    #throw-btn:active {
      transform: scale(0.95);
    }

    /* Messages floating up */
    .floating-message {
      position: absolute;
      color: #fff;
      font-family: 'Crimson Pro', serif;
      font-size: 16px;
      padding: 8px 15px;
      background: rgba(255,255,255,0.2);
      backdrop-filter: blur(5px);
      border-radius: 20px;
      white-space: nowrap;
      animation: floatUp 3s ease-out forwards;
      pointer-events: none;
      z-index: 50;
    }

    @keyframes floatUp {
      0% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
      100% {
        opacity: 0;
        transform: translateY(-100px) scale(0.8);
      }
    }

    /* Hit counter popup */
    .hit-popup {
      position: absolute;
      color: #ffd700;
      font-family: 'Fira Code', monospace;
      font-size: 28px;
      font-weight: 700;
      text-shadow: 0 2px 10px rgba(0,0,0,0.5);
      animation: popUp 0.8s ease-out forwards;
      pointer-events: none;
      z-index: 200;
    }

    @keyframes popUp {
      0% {
        opacity: 1;
        transform: translateY(0) scale(0.5);
      }
      50% {
        transform: translateY(-30px) scale(1.2);
      }
      100% {
        opacity: 0;
        transform: translateY(-60px) scale(1);
      }
    }

    /* Title */
    #title {
      position: fixed;
      top: 20px;
      left: 20px;
      color: #fff;
      font-size: 28px;
      font-weight: 700;
      text-shadow: 0 2px 10px rgba(0,0,0,0.3);
      z-index: 1000;
    }

    #title span {
      font-size: 32px;
    }

    /* Instructions - fade out after first throw */
    #instructions {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: #fff;
      font-size: 22px;
      text-align: center;
      background: rgba(0,0,0,0.4);
      backdrop-filter: blur(10px);
      padding: 30px 40px;
      border-radius: 20px;
      z-index: 500;
      transition: opacity 0.5s ease;
      max-width: 400px;
    }

    #instructions.hidden {
      opacity: 0;
      pointer-events: none;
    }

    #instructions h2 {
      margin-bottom: 15px;
      font-size: 28px;
    }

    #instructions p {
      opacity: 0.9;
      line-height: 1.5;
    }

    /* Backlink */
    #backlink {
      position: fixed;
      bottom: 100px;
      left: 20px;
      color: rgba(255,255,255,0.6);
      font-size: 14px;
      text-decoration: none;
      font-family: 'Fira Code', monospace;
      z-index: 1000;
      transition: color 0.2s;
    }

    #backlink:hover {
      color: rgba(255,255,255,0.9);
    }

    /* Cozy cabin light */
    .cabin-glow {
      position: absolute;
      bottom: 25%;
      right: 10%;
      width: 150px;
      height: 100px;
      background: radial-gradient(ellipse at center, rgba(255,180,100,0.3) 0%, transparent 70%);
      pointer-events: none;
    }

    /* Moon */
    .moon {
      position: absolute;
      top: 60px;
      right: 15%;
      width: 60px;
      height: 60px;
      background: radial-gradient(circle at 30% 30%, #fffde7 0%, #ffd54f 100%);
      border-radius: 50%;
      box-shadow: 0 0 40px rgba(255,213,79,0.5), 0 0 80px rgba(255,213,79,0.3);
    }

    /* Responsive */
    @media (max-width: 600px) {
      #title {
        font-size: 20px;
        top: 15px;
        left: 15px;
      }

      #title span {
        font-size: 24px;
      }

      #score-display {
        top: 15px;
        right: 15px;
        padding: 10px 15px;
        font-size: 14px;
      }

      #score-display span {
        font-size: 18px;
      }

      #chat-input {
        padding: 12px 15px;
        font-size: 16px;
      }

      #throw-btn {
        padding: 12px 18px;
        font-size: 16px;
      }

      #instructions {
        font-size: 18px;
        padding: 20px 25px;
      }

      .snowman-body {
        width: 60px;
        height: 60px;
      }

      .snowman-middle {
        width: 45px;
        height: 45px;
        bottom: 50px;
        left: 7px;
      }

      .snowman-head {
        width: 35px;
        height: 35px;
        bottom: 88px;
        left: 12px;
      }
    }
  </style>
</head>
<body>
  <div id="game-container">
    <div class="moon"></div>
    <div class="cabin-glow"></div>

    <div class="trees">
      <div class="tree" style="left: 5%;"></div>
      <div class="tree" style="left: 15%; transform: scale(0.8);"></div>
      <div class="tree" style="left: 75%; transform: scale(1.1);"></div>
      <div class="tree" style="left: 88%; transform: scale(0.7);"></div>
    </div>

    <div class="ground"></div>

    <div id="target">
      <div class="snowman">
        <div class="hat"></div>
        <div class="snowman-head">
          <div class="carrot"></div>
        </div>
        <div class="scarf"></div>
        <div class="snowman-middle"></div>
        <div class="snowman-body"></div>
        <div class="buttons">
          <div class="btn"></div>
          <div class="btn"></div>
          <div class="btn"></div>
        </div>
      </div>
    </div>
  </div>

  <div id="title"><span>‚ùÑÔ∏è</span> Snowball Fight</div>

  <div id="score-display">
    Hits: <span id="score">0</span>
  </div>

  <div id="instructions">
    <h2>üéØ How to Play</h2>
    <p>Type a message and press THROW to launch a snowball at the snowman!</p>
  </div>

  <div id="chat-area">
    <input type="text" id="chat-input" placeholder="Type something festive..." maxlength="50" autocomplete="off">
    <button id="throw-btn">THROW!</button>
  </div>

  <a href="https://sloppy.live" id="backlink">‚Üê sloppy.live</a>

  <script>
    // Game state
    let score = 0;
    let targetX = window.innerWidth / 2;
    let targetDirection = 1;
    let firstThrow = false;

    const container = document.getElementById('game-container');
    const target = document.getElementById('target');
    const snowman = target.querySelector('.snowman');
    const scoreDisplay = document.getElementById('score');
    const chatInput = document.getElementById('chat-input');
    const throwBtn = document.getElementById('throw-btn');
    const instructions = document.getElementById('instructions');

    // Create falling snow
    function createSnowflake() {
      const snowflake = document.createElement('div');
      snowflake.className = 'snowflake';
      snowflake.textContent = ['‚ùÑ', '‚ùÖ', '‚ùÜ', '‚Ä¢'][Math.floor(Math.random() * 4)];
      snowflake.style.left = Math.random() * 100 + 'vw';
      snowflake.style.fontSize = (8 + Math.random() * 12) + 'px';
      snowflake.style.animationDuration = (5 + Math.random() * 10) + 's';
      snowflake.style.opacity = 0.4 + Math.random() * 0.6;
      container.appendChild(snowflake);

      setTimeout(() => snowflake.remove(), 15000);
    }

    // Create snow continuously
    setInterval(createSnowflake, 200);
    for (let i = 0; i < 30; i++) {
      setTimeout(createSnowflake, i * 100);
    }

    // Move target
    function moveTarget() {
      const speed = 2;
      const margin = 100;
      const maxX = window.innerWidth - margin;
      const minX = margin;

      targetX += speed * targetDirection;

      if (targetX > maxX || targetX < minX) {
        targetDirection *= -1;
      }

      target.style.left = targetX + 'px';
      target.style.transform = `translateX(-50%) scaleX(${targetDirection})`;

      requestAnimationFrame(moveTarget);
    }

    // Initialize target position
    target.style.left = targetX + 'px';
    target.style.transform = 'translateX(-50%)';
    moveTarget();

    // Throw snowball
    function throwSnowball(message) {
      if (!firstThrow) {
        firstThrow = true;
        instructions.classList.add('hidden');
      }

      // Create floating message
      const floatingMsg = document.createElement('div');
      floatingMsg.className = 'floating-message';
      floatingMsg.textContent = message || '‚ùÑÔ∏è';
      floatingMsg.style.left = (window.innerWidth / 2 - 50) + 'px';
      floatingMsg.style.bottom = '150px';
      container.appendChild(floatingMsg);
      setTimeout(() => floatingMsg.remove(), 3000);

      // Create snowball
      const snowball = document.createElement('div');
      snowball.className = 'snowball';

      // Start from bottom center
      const startX = window.innerWidth / 2;
      const startY = window.innerHeight - 100;

      snowball.style.left = startX + 'px';
      snowball.style.top = startY + 'px';
      container.appendChild(snowball);

      // Calculate trajectory to target
      const targetRect = target.getBoundingClientRect();
      const endX = targetRect.left + targetRect.width / 2;
      const endY = targetRect.top + targetRect.height / 2;

      // Add some randomness based on message length
      const accuracy = Math.min(message.length * 2, 30);
      const randomOffsetX = (Math.random() - 0.5) * (100 - accuracy);
      const randomOffsetY = (Math.random() - 0.5) * (50 - accuracy / 2);

      const finalX = endX + randomOffsetX;
      const finalY = endY + randomOffsetY;

      // Animate snowball
      const duration = 600;
      const startTime = performance.now();

      function animateSnowball(currentTime) {
        const elapsed = currentTime - startTime;
        const progress = Math.min(elapsed / duration, 1);

        // Arc trajectory
        const easeProgress = 1 - Math.pow(1 - progress, 2);
        const arcHeight = -200 * Math.sin(progress * Math.PI);

        const currentX = startX + (finalX - startX) * easeProgress;
        const currentY = startY + (finalY - startY) * easeProgress + arcHeight;

        snowball.style.left = currentX + 'px';
        snowball.style.top = currentY + 'px';

        // Spin effect
        snowball.style.transform = `rotate(${progress * 720}deg)`;

        if (progress < 1) {
          requestAnimationFrame(animateSnowball);
        } else {
          // Check if hit
          const hitTargetRect = target.getBoundingClientRect();
          const hitPadding = 30;

          if (currentX > hitTargetRect.left - hitPadding &&
              currentX < hitTargetRect.right + hitPadding &&
              currentY > hitTargetRect.top - hitPadding &&
              currentY < hitTargetRect.bottom + hitPadding) {
            // HIT!
            score++;
            scoreDisplay.textContent = score;

            // Hit animation
            snowman.classList.add('hit');
            setTimeout(() => snowman.classList.remove('hit'), 300);

            // Hit popup
            const popup = document.createElement('div');
            popup.className = 'hit-popup';
            popup.textContent = '+1 HIT!';
            popup.style.left = currentX + 'px';
            popup.style.top = currentY + 'px';
            container.appendChild(popup);
            setTimeout(() => popup.remove(), 800);
          }

          // Splat effect
          snowball.classList.add('splat');
          setTimeout(() => snowball.remove(), 400);
        }
      }

      requestAnimationFrame(animateSnowball);
    }

    // Event listeners
    throwBtn.addEventListener('click', () => {
      const message = chatInput.value.trim();
      if (message) {
        throwSnowball(message);
        chatInput.value = '';
      } else {
        throwSnowball('‚ùÑÔ∏è');
      }
      chatInput.focus();
    });

    chatInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        throwBtn.click();
      }
    });

    // Focus input on load
    setTimeout(() => chatInput.focus(), 500);

    // Handle resize
    window.addEventListener('resize', () => {
      targetX = Math.min(targetX, window.innerWidth - 100);
    });
  </script>
</body>
</html>
