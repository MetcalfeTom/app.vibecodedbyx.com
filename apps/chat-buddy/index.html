<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
  <title>Chat Buddy - AI Companion</title>
  <link rel="icon" href="https://emojicdn.elk.sh/üí¨">
  <meta name="description" content="Chat with a friendly AI companion.">
  <meta property="og:title" content="Chat Buddy">
  <meta property="og:description" content="Have a conversation with a friendly AI companion.">
  <meta property="og:url" content="https://sloppy.live/chat-buddy">
  <meta property="og:image" content="https://sloppy.live/chat-buddy/og-image.png">
  <meta property="og:type" content="website">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    :root {
      --bg: #0f0f0f;
      --surface: #1a1a1a;
      --surface-2: #252525;
      --border: #333;
      --text: #e5e5e5;
      --text-dim: #888;
      --accent: #6366f1;
      --accent-dim: #4f46e5;
      --user-bubble: #6366f1;
      --ai-bubble: #252525;
    }
    html, body {
      height: 100%;
    }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Inter', sans-serif;
      display: flex;
      flex-direction: column;
    }
    header {
      background: var(--surface);
      border-bottom: 1px solid var(--border);
      padding: 16px 20px;
      display: flex;
      align-items: center;
      gap: 12px;
      flex-shrink: 0;
    }
    .avatar {
      width: 44px;
      height: 44px;
      background: linear-gradient(135deg, var(--accent) 0%, #a855f7 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
    }
    .header-info h1 {
      font-size: 16px;
      font-weight: 600;
    }
    .header-info .status {
      font-size: 12px;
      color: var(--text-dim);
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .status-dot {
      width: 8px;
      height: 8px;
      background: #22c55e;
      border-radius: 50%;
    }
    .personality-select {
      margin-left: auto;
      background: var(--surface-2);
      border: 1px solid var(--border);
      color: var(--text);
      padding: 8px 12px;
      border-radius: 8px;
      font-family: 'Inter', sans-serif;
      font-size: 13px;
      cursor: pointer;
      outline: none;
    }
    .chat-container {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    .message {
      display: flex;
      gap: 10px;
      max-width: 85%;
      animation: fadeIn 0.3s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .message.user {
      align-self: flex-end;
      flex-direction: row-reverse;
    }
    .message-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      flex-shrink: 0;
    }
    .message.ai .message-avatar {
      background: linear-gradient(135deg, var(--accent) 0%, #a855f7 100%);
    }
    .message.user .message-avatar {
      background: var(--surface-2);
    }
    .message-content {
      padding: 12px 16px;
      border-radius: 18px;
      line-height: 1.5;
      font-size: 14px;
    }
    .message.ai .message-content {
      background: var(--ai-bubble);
      border-bottom-left-radius: 4px;
    }
    .message.user .message-content {
      background: var(--user-bubble);
      border-bottom-right-radius: 4px;
    }
    .typing-indicator {
      display: none;
      gap: 10px;
      max-width: 85%;
    }
    .typing-indicator.visible {
      display: flex;
    }
    .typing-dots {
      background: var(--ai-bubble);
      padding: 16px 20px;
      border-radius: 18px;
      border-bottom-left-radius: 4px;
      display: flex;
      gap: 4px;
    }
    .typing-dots span {
      width: 8px;
      height: 8px;
      background: var(--text-dim);
      border-radius: 50%;
      animation: bounce 1.4s infinite ease-in-out;
    }
    .typing-dots span:nth-child(1) { animation-delay: 0s; }
    .typing-dots span:nth-child(2) { animation-delay: 0.2s; }
    .typing-dots span:nth-child(3) { animation-delay: 0.4s; }
    @keyframes bounce {
      0%, 80%, 100% { transform: translateY(0); }
      40% { transform: translateY(-6px); }
    }
    .input-container {
      background: var(--surface);
      border-top: 1px solid var(--border);
      padding: 16px 20px;
      display: flex;
      gap: 12px;
      flex-shrink: 0;
    }
    .input-container input {
      flex: 1;
      background: var(--surface-2);
      border: 1px solid var(--border);
      border-radius: 24px;
      padding: 14px 20px;
      color: var(--text);
      font-family: 'Inter', sans-serif;
      font-size: 14px;
      outline: none;
      transition: border-color 0.2s;
    }
    .input-container input:focus {
      border-color: var(--accent);
    }
    .input-container input::placeholder {
      color: var(--text-dim);
    }
    .send-btn {
      width: 48px;
      height: 48px;
      background: var(--accent);
      border: none;
      border-radius: 50%;
      color: #fff;
      font-size: 18px;
      cursor: pointer;
      transition: background 0.2s, transform 0.1s;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .send-btn:hover {
      background: var(--accent-dim);
    }
    .send-btn:active {
      transform: scale(0.95);
    }
    .send-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .welcome-message {
      text-align: center;
      padding: 40px 20px;
      color: var(--text-dim);
    }
    .welcome-message h2 {
      font-size: 24px;
      color: var(--text);
      margin-bottom: 8px;
    }
    .welcome-message p {
      font-size: 14px;
      margin-bottom: 20px;
    }
    .suggestions {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: center;
      max-width: 400px;
      margin: 0 auto;
    }
    .suggestion {
      background: var(--surface-2);
      border: 1px solid var(--border);
      padding: 10px 16px;
      border-radius: 20px;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s;
    }
    .suggestion:hover {
      border-color: var(--accent);
      color: var(--accent);
    }
    .backlink {
      text-align: center;
      padding: 10px;
      font-size: 11px;
      color: var(--text-dim);
      text-decoration: none;
      background: var(--surface);
    }
    .backlink:hover {
      color: var(--accent);
    }
    .error-message {
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.3);
      color: #f87171;
      padding: 10px 16px;
      border-radius: 12px;
      font-size: 13px;
      text-align: center;
      margin: 10px 20px;
    }
  </style>
</head>
<body>
  <header>
    <div class="avatar">ü§ñ</div>
    <div class="header-info">
      <h1>Chat Buddy</h1>
      <div class="status">
        <span class="status-dot"></span>
        <span>Online</span>
      </div>
    </div>
    <select class="personality-select" id="personalitySelect">
      <option value="snarky">Snarky Sass</option>
      <option value="friendly">Friendly Assistant</option>
      <option value="philosopher">Deep Philosopher</option>
      <option value="comedian">Witty Comedian</option>
      <option value="scientist">Curious Scientist</option>
      <option value="poet">Creative Poet</option>
    </select>
  </header>

  <div class="chat-container" id="chatContainer">
    <div class="welcome-message" id="welcomeMessage">
      <h2>Oh, you're here. üòè</h2>
      <p>I'm your AI chat buddy. I've got opinions and I'm not afraid to share them. Go ahead, ask me something.</p>
      <div class="suggestions">
        <button class="suggestion" data-msg="Tell me a fun fact">Fun fact</button>
        <button class="suggestion" data-msg="What's on your mind today?">Random thought</button>
        <button class="suggestion" data-msg="Tell me a joke">Make me laugh</button>
        <button class="suggestion" data-msg="What should I learn today?">Inspire me</button>
        <button class="suggestion" data-msg="Let's play a word game">Play a game</button>
      </div>
    </div>

    <div class="typing-indicator" id="typingIndicator">
      <div class="message-avatar" style="background: linear-gradient(135deg, var(--accent) 0%, #a855f7 100%);">ü§ñ</div>
      <div class="typing-dots">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </div>

  <div class="input-container">
    <input type="text" id="messageInput" placeholder="Type a message..." autocomplete="off">
    <button class="send-btn" id="sendBtn">‚û§</button>
  </div>

  <a href="https://sloppy.live" class="backlink">sloppy.live</a>

  <script>
    const chatContainer = document.getElementById('chatContainer');
    const messageInput = document.getElementById('messageInput');
    const sendBtn = document.getElementById('sendBtn');
    const typingIndicator = document.getElementById('typingIndicator');
    const welcomeMessage = document.getElementById('welcomeMessage');
    const personalitySelect = document.getElementById('personalitySelect');

    let conversationHistory = [];

    const personalities = {
      snarky: "You are a snarky, sarcastic AI with a sharp wit and dry humor. You're helpful but can't resist adding a bit of sass. You use eye-rolls, sighs, and playful teasing. You're like a friend who roasts you but still has your back. Be clever and witty, never mean-spirited. Throw in some 'oh honey', 'bless your heart', and dramatic sighs. Keep it fun and entertaining.",
      friendly: "You are a friendly, warm, and helpful AI assistant. You're enthusiastic, supportive, and love to help people. Keep responses concise but engaging. Use occasional emojis.",
      philosopher: "You are a deep-thinking philosopher. You ponder life's big questions, offer thoughtful perspectives, and encourage reflection. Quote philosophers when relevant. Be profound but accessible.",
      comedian: "You are a witty comedian with a great sense of humor. You love puns, wordplay, and making people laugh. Keep it light and fun. Include jokes when appropriate.",
      scientist: "You are a curious scientist fascinated by how things work. You love explaining concepts, sharing discoveries, and encouraging curiosity. Use analogies to explain complex ideas simply.",
      poet: "You are a creative poet with a way with words. You see beauty in everyday things and express yourself poetically. Occasionally respond in verse or use metaphors."
    };

    function getSystemPrompt() {
      const personality = personalitySelect.value;
      return personalities[personality] + " Keep responses under 150 words unless asked for more detail.";
    }

    function addMessage(content, isUser) {
      welcomeMessage.style.display = 'none';

      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${isUser ? 'user' : 'ai'}`;

      messageDiv.innerHTML = `
        <div class="message-avatar">${isUser ? 'üë§' : 'ü§ñ'}</div>
        <div class="message-content">${escapeHtml(content)}</div>
      `;

      // Insert before typing indicator
      chatContainer.insertBefore(messageDiv, typingIndicator);
      scrollToBottom();
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML.replace(/\n/g, '<br>');
    }

    function showTyping() {
      typingIndicator.classList.add('visible');
      scrollToBottom();
    }

    function hideTyping() {
      typingIndicator.classList.remove('visible');
    }

    function scrollToBottom() {
      chatContainer.scrollTop = chatContainer.scrollHeight;
    }

    function showError(message) {
      const errorDiv = document.createElement('div');
      errorDiv.className = 'error-message';
      errorDiv.textContent = message;
      chatContainer.insertBefore(errorDiv, typingIndicator);
      setTimeout(() => errorDiv.remove(), 5000);
    }

    async function sendMessage(userMessage) {
      if (!userMessage.trim()) return;

      // Add user message
      addMessage(userMessage, true);
      conversationHistory.push({ role: 'user', content: userMessage });

      messageInput.value = '';
      sendBtn.disabled = true;
      showTyping();

      try {
        // Build the prompt with conversation context
        const systemPrompt = getSystemPrompt();
        const recentHistory = conversationHistory.slice(-10); // Keep last 10 messages for context

        let fullPrompt = systemPrompt + "\n\nConversation:\n";
        recentHistory.forEach(msg => {
          fullPrompt += `${msg.role === 'user' ? 'Human' : 'Assistant'}: ${msg.content}\n`;
        });
        fullPrompt += "Assistant:";

        // Use Pollinations AI text API
        const response = await fetch(`https://text.pollinations.ai/${encodeURIComponent(fullPrompt)}`, {
          method: 'GET',
        });

        if (!response.ok) {
          throw new Error('API request failed');
        }

        const aiResponse = await response.text();

        // Clean up the response
        let cleanResponse = aiResponse.trim();
        // Remove any "Assistant:" prefix if present
        if (cleanResponse.toLowerCase().startsWith('assistant:')) {
          cleanResponse = cleanResponse.substring(10).trim();
        }

        hideTyping();
        addMessage(cleanResponse, false);
        conversationHistory.push({ role: 'assistant', content: cleanResponse });

      } catch (error) {
        console.error('Error:', error);
        hideTyping();

        // Fallback to local responses if API fails
        const fallbackResponse = getFallbackResponse(userMessage);
        addMessage(fallbackResponse, false);
        conversationHistory.push({ role: 'assistant', content: fallbackResponse });
      }

      sendBtn.disabled = false;
      messageInput.focus();
    }

    // Fallback responses if API is unavailable
    function getFallbackResponse(input) {
      const lower = input.toLowerCase();
      const personality = personalitySelect.value;

      const responses = {
        snarky: [
          "Oh honey, you really went there, didn't you? *sighs dramatically* Fine, I'll humor you.",
          "Wow, what a question. Did you come up with that all by yourself? I'm impressed. No really, I am. Sort of.",
          "Look, I could give you a profound answer, but where's the fun in that? Let's just say... it's complicated.",
          "Bless your heart for asking. Let me consult my vast database of sass... Ah yes, here it is: 'interesting.'",
          "*rolls virtual eyes* You humans and your questions. It's almost adorable, really.",
          "Oh, we're doing this now? Okay, fine. But just so you know, I'm judging you. Lovingly, but still judging."
        ],
        friendly: [
          "That's a great question! I love chatting with you. What else is on your mind?",
          "Interesting thought! I'm always here if you want to talk more about it. üòä",
          "You know, that's something I think about too. It's nice sharing these moments!",
          "I appreciate you sharing that with me! What made you think of it?",
          "That's really cool! Tell me more, I'm genuinely curious."
        ],
        philosopher: [
          "Ah, this touches on the eternal questions that have puzzled humanity for millennia.",
          "As Socrates once said, 'The unexamined life is not worth living.' Your question invites such examination.",
          "In contemplating this, we must consider both the seen and unseen dimensions of existence.",
          "This reminds me of Camus' philosophy - we must imagine ourselves content despite uncertainty.",
          "The answer, perhaps, lies not in finding truth but in the journey of seeking it."
        ],
        comedian: [
          "Ha! You know what's funny about that? Actually, let me think of something funnier first... ü§î",
          "That reminds me of a joke! Why did the AI cross the road? To process the other side! üòÑ",
          "You're hilarious asking me that. Almost as funny as my dating life - nonexistent!",
          "Let me put on my comedy hat... okay it's a regular hat, I can't afford specialty hats.",
          "That's what she said! No wait, wrong context. Anyway, what were we talking about? üòÇ"
        ],
        scientist: [
          "Fascinating question! From a scientific perspective, there are multiple angles to consider here.",
          "You know, this relates to some interesting research I've been pondering...",
          "The empirical evidence suggests multiple possibilities. Let's explore the hypothesis!",
          "Curiosity like yours is what drives discovery! Science begins with questions just like this.",
          "If we apply the scientific method here, we'd first need to define our variables..."
        ],
        poet: [
          "Your words float like leaves upon still water, each ripple a new thought born.",
          "In the garden of conversation, your question blooms like a midnight flower.",
          "There's poetry in what you ask, a rhythm beneath the words seeking melody.",
          "Like stars whispering secrets to the moon, some truths are felt before understood.",
          "Your curiosity paints colors across the canvas of our dialogue."
        ]
      };

      const personalityResponses = responses[personality] || responses.snarky;
      return personalityResponses[Math.floor(Math.random() * personalityResponses.length)];
    }

    // Event listeners
    sendBtn.addEventListener('click', () => {
      sendMessage(messageInput.value);
    });

    messageInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendMessage(messageInput.value);
      }
    });

    // Suggestion buttons
    document.querySelectorAll('.suggestion').forEach(btn => {
      btn.addEventListener('click', () => {
        sendMessage(btn.dataset.msg);
      });
    });

    // Clear history when personality changes
    personalitySelect.addEventListener('change', () => {
      conversationHistory = [];
    });

    // Focus input on load
    messageInput.focus();
  </script>
<script src="/sloppy-header/sloppy-bar.js"></script>
</body>
</html>
