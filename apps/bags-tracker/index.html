<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BAGS Terminal - Price Monitor</title>
  <link rel="icon" href="https://emojicdn.elk.sh/ğŸ’°">
  <meta property="og:title" content="BAGS Terminal - Price Monitor">
  <meta property="og:description" content="Track BAGS token price in terminal style!">
  <meta property="og:url" content="https://sloppy.live/bags-tracker">
  <meta property="og:image" content="https://sloppy.live/bags-tracker/og-image.png">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&family=VT323&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Fira Code', monospace;
      background: #0a0a0a;
      min-height: 100vh;
      color: #0f0;
      padding: 0;
      overflow-x: hidden;
    }

    /* CRT effects */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: repeating-linear-gradient(
        0deg,
        rgba(0, 0, 0, 0.15) 0px,
        rgba(0, 0, 0, 0.15) 1px,
        transparent 1px,
        transparent 2px
      );
      pointer-events: none;
      z-index: 1000;
    }

    body::after {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(ellipse at center, transparent 0%, rgba(0,0,0,0.3) 100%);
      pointer-events: none;
      z-index: 999;
    }

    .terminal {
      max-width: 900px;
      margin: 0 auto;
      min-height: 100vh;
      padding: 20px;
      position: relative;
    }

    .terminal-header {
      border-bottom: 1px solid #0f0;
      padding-bottom: 15px;
      margin-bottom: 20px;
    }

    .title-ascii {
      font-family: 'VT323', monospace;
      font-size: 0.7rem;
      line-height: 1.1;
      color: #0f0;
      text-shadow: 0 0 10px #0f0;
      white-space: pre;
      animation: flicker 5s infinite;
    }

    @keyframes flicker {
      0%, 100% { opacity: 1; }
      92% { opacity: 1; }
      93% { opacity: 0.8; }
      94% { opacity: 1; }
      95% { opacity: 0.9; }
    }

    .system-info {
      color: #0a0;
      font-size: 0.75rem;
      margin-top: 10px;
    }

    .output-line {
      margin: 8px 0;
      line-height: 1.6;
    }

    .prompt {
      color: #0ff;
    }

    .command {
      color: #0f0;
    }

    .label {
      color: #0a0;
    }

    .value {
      color: #0f0;
      text-shadow: 0 0 5px #0f0;
    }

    .value-large {
      font-size: 1.8rem;
      font-weight: bold;
      color: #0f0;
      text-shadow: 0 0 10px #0f0, 0 0 20px #0f0;
      font-family: 'VT323', monospace;
      letter-spacing: 2px;
    }

    .positive {
      color: #0f0;
    }

    .negative {
      color: #f00;
      text-shadow: 0 0 5px #f00;
    }

    .warning {
      color: #ff0;
    }

    .cyan {
      color: #0ff;
    }

    .divider {
      color: #060;
      margin: 15px 0;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 5px 20px;
      margin: 15px 0;
      padding: 15px;
      border: 1px solid #060;
      background: rgba(0, 255, 0, 0.02);
    }

    .stat-row {
      display: flex;
      justify-content: space-between;
    }

    .blink {
      animation: blink 1s step-end infinite;
    }

    @keyframes blink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0; }
    }

    .cursor {
      display: inline-block;
      width: 10px;
      height: 18px;
      background: #0f0;
      margin-left: 5px;
      animation: blink 1s step-end infinite;
    }

    .loading-bar {
      display: inline-block;
      width: 200px;
      height: 15px;
      border: 1px solid #0f0;
      position: relative;
      overflow: hidden;
    }

    .loading-bar-fill {
      height: 100%;
      background: #0f0;
      animation: loading 2s ease-in-out infinite;
    }

    @keyframes loading {
      0% { width: 0%; }
      50% { width: 100%; }
      100% { width: 0%; }
    }

    .error-box {
      border: 1px solid #f00;
      padding: 15px;
      margin: 20px 0;
      background: rgba(255, 0, 0, 0.1);
    }

    .refresh-info {
      position: fixed;
      bottom: 20px;
      right: 20px;
      color: #060;
      font-size: 0.7rem;
    }

    .action-row {
      margin-top: 20px;
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .terminal-btn {
      background: transparent;
      border: 1px solid #0f0;
      color: #0f0;
      padding: 8px 20px;
      font-family: 'Fira Code', monospace;
      font-size: 0.85rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .terminal-btn:hover {
      background: #0f0;
      color: #000;
      box-shadow: 0 0 15px #0f0;
    }

    .terminal-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .link-row {
      margin-top: 15px;
    }

    .terminal-link {
      color: #0ff;
      text-decoration: none;
    }

    .terminal-link:hover {
      text-decoration: underline;
    }

    .price-box {
      border: 2px solid #0f0;
      padding: 20px;
      margin: 20px 0;
      text-align: center;
      background: rgba(0, 255, 0, 0.03);
      box-shadow: 0 0 20px rgba(0, 255, 0, 0.1), inset 0 0 30px rgba(0, 255, 0, 0.02);
    }

    .token-line {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .token-emoji {
      font-size: 1.5rem;
    }

    .back-link {
      display: block;
      text-align: center;
      margin-top: 30px;
      padding-bottom: 20px;
      color: #060;
      font-size: 0.75rem;
      text-decoration: none;
    }

    .back-link:hover {
      color: #0f0;
    }

    .chart-ascii {
      font-size: 0.7rem;
      color: #0a0;
      margin: 15px 0;
      line-height: 1.2;
    }

    @media (max-width: 600px) {
      .title-ascii { font-size: 0.45rem; }
      .value-large { font-size: 1.4rem; }
      .stats-grid { grid-template-columns: 1fr; }
      .terminal { padding: 15px; }
    }
  </style>
</head>
<body>
  <div class="terminal">
    <div class="terminal-header">
      <pre class="title-ascii">
 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
 â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•”â•â•â•â•â•
 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
 â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘
 â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
 â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•
 â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€â–€
 PRICE TERMINAL v2.0 // DEXSCREENER
      </pre>
      <div class="system-info">
        [SYS] Connected to DexScreener API
        <br>[SYS] Auto-refresh: 30s interval
        <br>[SYS] Time: <span id="system-time">--:--:--</span>
      </div>
    </div>

    <div id="content">
      <div class="output-line">
        <span class="prompt">$</span> <span class="command">fetch --token BAGS --source dexscreener</span>
      </div>
      <div class="output-line">
        <span class="label">[INFO]</span> Scanning blockchain networks...
      </div>
      <div class="output-line">
        <div class="loading-bar"><div class="loading-bar-fill"></div></div>
      </div>
    </div>

    <a class="back-link" href="https://sloppy.live">[ sloppy.live ]</a>
  </div>

  <div class="refresh-info">
    Auto-refresh in: <span id="countdown">30</span>s
  </div>

  <script>
    let tokenData = null;
    let countdown = 30;
    let countdownInterval;

    // Update system time
    function updateTime() {
      const now = new Date();
      document.getElementById('system-time').textContent = now.toLocaleTimeString();
    }
    setInterval(updateTime, 1000);
    updateTime();

    // Format number
    function formatNumber(num, decimals = 2) {
      if (num === null || num === undefined) return 'N/A';
      if (num >= 1e9) return (num / 1e9).toFixed(2) + 'B';
      if (num >= 1e6) return (num / 1e6).toFixed(2) + 'M';
      if (num >= 1e3) return (num / 1e3).toFixed(2) + 'K';
      return num.toFixed(decimals);
    }

    // Format price
    function formatPrice(price) {
      if (price === null || price === undefined) return 'N/A';
      if (price < 0.00000001) return price.toExponential(4);
      if (price < 0.0001) return price.toFixed(10);
      if (price < 0.01) return price.toFixed(8);
      if (price < 1) return price.toFixed(6);
      return price.toFixed(4);
    }

    // Generate mini ASCII chart
    function generateMiniChart(change) {
      const val = Math.min(Math.max(change, -50), 50);
      const mid = 10;
      const pos = Math.round((val + 50) / 100 * 20);
      let chart = '';
      for (let i = 0; i < 21; i++) {
        if (i === mid) chart += 'â”‚';
        else if (i === pos) chart += (change >= 0 ? 'â–ˆ' : 'â–ˆ');
        else if (i < pos && i > mid && change > 0) chart += 'â–“';
        else if (i > pos && i < mid && change < 0) chart += 'â–“';
        else chart += 'â”€';
      }
      return chart;
    }

    // Fetch token data
    async function fetchTokenData() {
      const content = document.getElementById('content');

      content.innerHTML = `
        <div class="output-line">
          <span class="prompt">$</span> <span class="command">fetch --token BAGS --source dexscreener</span>
        </div>
        <div class="output-line">
          <span class="label">[INFO]</span> Scanning blockchain networks...
        </div>
        <div class="output-line">
          <div class="loading-bar"><div class="loading-bar-fill"></div></div>
        </div>
      `;

      try {
        const response = await fetch('https://api.dexscreener.com/latest/dex/search?q=bags');
        const data = await response.json();

        if (data.pairs && data.pairs.length > 0) {
          // Find BAGS token with highest liquidity
          const bagsPairs = data.pairs.filter(p =>
            p.baseToken.symbol.toUpperCase() === 'BAGS' ||
            p.baseToken.name.toUpperCase().includes('BAGS')
          );

          if (bagsPairs.length > 0) {
            bagsPairs.sort((a, b) => (b.liquidity?.usd || 0) - (a.liquidity?.usd || 0));
            tokenData = bagsPairs[0];
          } else {
            tokenData = data.pairs[0];
          }

          renderData();
        } else {
          throw new Error('Token not found');
        }
      } catch (error) {
        content.innerHTML = `
          <div class="output-line">
            <span class="prompt">$</span> <span class="command">fetch --token BAGS</span>
          </div>
          <div class="error-box">
            <span class="negative">[ERROR]</span> Connection failed
            <br><span class="label">Status:</span> Unable to reach DexScreener API
            <br><span class="label">Action:</span> Retry connection
          </div>
          <div class="action-row">
            <button class="terminal-btn" onclick="fetchTokenData()">[ RETRY ]</button>
          </div>
        `;
      }

      // Reset countdown
      countdown = 30;
    }

    // Render data
    function renderData() {
      if (!tokenData) return;

      const price = parseFloat(tokenData.priceUsd) || 0;
      const change24h = parseFloat(tokenData.priceChange?.h24) || 0;
      const change6h = parseFloat(tokenData.priceChange?.h6) || 0;
      const change1h = parseFloat(tokenData.priceChange?.h1) || 0;
      const changeClass = change24h >= 0 ? 'positive' : 'negative';
      const changeSymbol = change24h >= 0 ? '+' : '';
      const now = new Date().toLocaleTimeString();

      const content = document.getElementById('content');
      content.innerHTML = `
        <div class="output-line">
          <span class="prompt">$</span> <span class="command">fetch --token BAGS --source dexscreener</span>
        </div>
        <div class="output-line">
          <span class="positive">[OK]</span> Token found on ${tokenData.chainId?.toUpperCase() || 'UNKNOWN'} network
        </div>

        <div class="divider">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</div>

        <div class="price-box">
          <div class="token-line">
            <span class="token-emoji">ğŸ’°</span>
            <span class="cyan">${tokenData.baseToken.name}</span>
            <span class="label">(${tokenData.baseToken.symbol}/${tokenData.quoteToken.symbol})</span>
          </div>
          <div class="value-large">$${formatPrice(price)}</div>
          <div class="output-line" style="margin-top: 10px;">
            <span class="${changeClass}">${changeSymbol}${change24h.toFixed(2)}% (24h)</span>
          </div>
        </div>

        <div class="output-line">
          <span class="label">24H MOVEMENT:</span>
          <span class="${changeClass}">[${generateMiniChart(change24h)}]</span>
        </div>

        <div class="stats-grid">
          <div class="stat-row">
            <span class="label">Market Cap:</span>
            <span class="value">$${formatNumber(tokenData.fdv)}</span>
          </div>
          <div class="stat-row">
            <span class="label">Liquidity:</span>
            <span class="value">$${formatNumber(tokenData.liquidity?.usd)}</span>
          </div>
          <div class="stat-row">
            <span class="label">24h Volume:</span>
            <span class="value">$${formatNumber(tokenData.volume?.h24)}</span>
          </div>
          <div class="stat-row">
            <span class="label">Chain:</span>
            <span class="cyan">${tokenData.chainId?.toUpperCase() || 'N/A'}</span>
          </div>
          <div class="stat-row">
            <span class="label">1h Change:</span>
            <span class="${change1h >= 0 ? 'positive' : 'negative'}">${change1h >= 0 ? '+' : ''}${change1h.toFixed(2)}%</span>
          </div>
          <div class="stat-row">
            <span class="label">6h Change:</span>
            <span class="${change6h >= 0 ? 'positive' : 'negative'}">${change6h >= 0 ? '+' : ''}${change6h.toFixed(2)}%</span>
          </div>
          <div class="stat-row">
            <span class="label">Pair Address:</span>
            <span class="value" style="font-size: 0.7rem;">${tokenData.pairAddress?.slice(0, 8)}...${tokenData.pairAddress?.slice(-6) || 'N/A'}</span>
          </div>
          <div class="stat-row">
            <span class="label">DEX:</span>
            <span class="value">${tokenData.dexId || 'N/A'}</span>
          </div>
        </div>

        <div class="divider">â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</div>

        <div class="output-line">
          <span class="label">[LOG]</span> Last updated: ${now}
        </div>

        <div class="action-row">
          <button class="terminal-btn" onclick="fetchTokenData()">[ REFRESH ]</button>
          ${tokenData.url ? `<a href="${tokenData.url}" target="_blank" class="terminal-btn">[ VIEW CHART ]</a>` : ''}
        </div>

        <div class="link-row">
          <span class="label">DexScreener:</span>
          <a href="${tokenData.url || '#'}" target="_blank" class="terminal-link">${tokenData.url || 'N/A'}</a>
        </div>

        <div class="output-line" style="margin-top: 20px;">
          <span class="prompt">$</span> <span class="blink">_</span>
        </div>
      `;
    }

    // Countdown timer
    function startCountdown() {
      if (countdownInterval) clearInterval(countdownInterval);
      countdownInterval = setInterval(() => {
        countdown--;
        document.getElementById('countdown').textContent = countdown;
        if (countdown <= 0) {
          fetchTokenData();
        }
      }, 1000);
    }

    // Initialize
    fetchTokenData();
    startCountdown();
  </script>
</body>
</html>
