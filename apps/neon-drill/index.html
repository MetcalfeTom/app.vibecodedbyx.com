<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Neon Drill</title>
  <link rel="icon" href="https://emojicdn.elk.sh/⚡">
  <meta name="description" content="Control a laser drill through layers of glowing minerals">
  <meta property="og:title" content="Neon Drill">
  <meta property="og:description" content="Mine purple quartz and emeralds with your laser drill">
  <meta property="og:url" content="https://sloppy.live/neon-drill">
  <meta property="og:image" content="https://sloppy.live/neon-drill/og-image.png">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      min-height: 100vh;
      overflow: hidden;
      background: #0a0a12;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-family: 'Orbitron', monospace;
    }

    .game-container {
      position: relative;
    }

    canvas {
      display: block;
      border: 2px solid #8000ff;
      box-shadow: 0 0 30px rgba(128, 0, 255, 0.4);
    }

    .ui {
      position: absolute;
      top: 10px;
      left: 10px;
      z-index: 10;
      color: #00ff80;
      text-shadow: 0 0 10px #00ff80;
    }

    .stat {
      margin-bottom: 8px;
      font-size: 12px;
    }

    .stat-value {
      font-size: 18px;
      font-weight: 700;
    }

    .heat-container {
      position: absolute;
      top: 10px;
      right: 10px;
      width: 30px;
      height: 200px;
      background: rgba(0, 0, 0, 0.5);
      border: 2px solid #ff0080;
      border-radius: 15px;
      overflow: hidden;
      z-index: 10;
    }

    .heat-fill {
      position: absolute;
      bottom: 0;
      width: 100%;
      background: linear-gradient(to top, #ff0000, #ff8000, #ffff00);
      transition: height 0.1s;
      border-radius: 0 0 12px 12px;
    }

    .heat-label {
      position: absolute;
      top: -25px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 10px;
      color: #ff0080;
      white-space: nowrap;
    }

    .overheat-warning {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 32px;
      color: #ff0000;
      text-shadow: 0 0 20px #ff0000;
      animation: pulse 0.3s ease-in-out infinite;
      z-index: 15;
      display: none;
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    .start-screen, .game-over-screen {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: rgba(10, 10, 18, 0.95);
      z-index: 20;
    }

    h1 {
      font-size: 48px;
      color: #8000ff;
      text-shadow: 0 0 30px #8000ff;
      margin-bottom: 10px;
    }

    h2 {
      font-size: 36px;
      color: #ff0080;
      text-shadow: 0 0 20px #ff0080;
      margin-bottom: 20px;
    }

    .subtitle {
      font-size: 14px;
      color: #00ff80;
      margin-bottom: 30px;
      letter-spacing: 3px;
    }

    .controls-info {
      font-size: 11px;
      color: rgba(128, 0, 255, 0.7);
      margin-bottom: 25px;
      text-align: center;
      line-height: 2;
    }

    .legend {
      display: flex;
      gap: 20px;
      margin-bottom: 30px;
      font-size: 12px;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .legend-color {
      width: 16px;
      height: 16px;
      border-radius: 4px;
    }

    .start-btn {
      padding: 15px 40px;
      font-family: 'Orbitron', monospace;
      font-size: 16px;
      background: transparent;
      border: 2px solid #00ff80;
      color: #00ff80;
      cursor: pointer;
      transition: all 0.3s;
      letter-spacing: 2px;
    }

    .start-btn:hover {
      background: rgba(0, 255, 128, 0.1);
      box-shadow: 0 0 20px rgba(0, 255, 128, 0.3);
    }

    .final-stats {
      margin-bottom: 30px;
      text-align: center;
    }

    .final-stat {
      font-size: 16px;
      color: #00ff80;
      margin: 8px 0;
    }

    .mobile-controls {
      position: fixed;
      bottom: 20px;
      left: 0;
      right: 0;
      display: none;
      justify-content: space-between;
      padding: 0 20px;
      z-index: 30;
    }

    .mobile-btn {
      width: 65px;
      height: 65px;
      border-radius: 50%;
      background: rgba(128, 0, 255, 0.2);
      border: 2px solid #8000ff;
      color: #8000ff;
      font-size: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      user-select: none;
    }

    .mobile-btn:active {
      background: rgba(128, 0, 255, 0.4);
    }

    .drill-btn {
      width: 90px;
      height: 90px;
      background: rgba(0, 255, 128, 0.2);
      border-color: #00ff80;
      color: #00ff80;
      font-size: 14px;
    }

    .backlink {
      position: fixed;
      bottom: 10px;
      right: 10px;
      color: rgba(128, 0, 255, 0.4);
      text-decoration: none;
      font-size: 11px;
      z-index: 40;
    }

    @media (max-width: 850px) {
      canvas {
        max-width: 95vw;
        max-height: 55vh;
      }

      .mobile-controls {
        display: flex;
      }

      h1 {
        font-size: 32px;
      }
    }

    .hidden {
      display: none !important;
    }
  </style>
</head>
<body>
  <div class="game-container">
    <canvas id="game" width="800" height="600"></canvas>

    <div class="ui">
      <div class="stat">
        MINERALS
        <div class="stat-value" id="score">0</div>
      </div>
      <div class="stat">
        DEPTH
        <div class="stat-value"><span id="depth">0</span>m</div>
      </div>
      <div class="stat">
        FUEL
        <div class="stat-value" id="fuel">100</div>
      </div>
    </div>

    <div class="heat-container">
      <div class="heat-label">HEAT</div>
      <div class="heat-fill" id="heatFill" style="height: 0%"></div>
    </div>

    <div class="overheat-warning" id="overheatWarning">⚠️ OVERHEAT ⚠️</div>

    <div class="start-screen" id="startScreen">
      <h1>NEON DRILL</h1>
      <p class="subtitle">LASER MINING SIMULATOR</p>
      <div class="controls-info">
        ← → to move horizontally<br>
        ↓ or SPACE to drill down<br>
        Watch your heat - let it cool!
      </div>
      <div class="legend">
        <div class="legend-item">
          <div class="legend-color" style="background: #8000ff;"></div>
          <span style="color: #8000ff;">Quartz +10</span>
        </div>
        <div class="legend-item">
          <div class="legend-color" style="background: #00ff80;"></div>
          <span style="color: #00ff80;">Emerald +50</span>
        </div>
        <div class="legend-item">
          <div class="legend-color" style="background: #ff00ff;"></div>
          <span style="color: #ff00ff;">Diamond +100</span>
        </div>
        <div class="legend-item">
          <div class="legend-color" style="background: #00ffff;"></div>
          <span style="color: #00ffff;">Coolant -30 heat</span>
        </div>
      </div>
      <button class="start-btn" onclick="startGame()">START DRILLING</button>
    </div>

    <div class="game-over-screen hidden" id="gameOverScreen">
      <h2>DRILL OFFLINE</h2>
      <div class="final-stats">
        <div class="final-stat">MINERALS: <span id="finalScore">0</span></div>
        <div class="final-stat">MAX DEPTH: <span id="finalDepth">0</span>m</div>
      </div>
      <button class="start-btn" onclick="startGame()">DRILL AGAIN</button>
    </div>
  </div>

  <div class="mobile-controls">
    <div style="display: flex; gap: 10px;">
      <button class="mobile-btn" id="leftBtn">◀</button>
      <button class="mobile-btn" id="rightBtn">▶</button>
    </div>
    <button class="mobile-btn drill-btn" id="drillBtn">DRILL</button>
  </div>

  <a href="https://sloppy.live" class="backlink">sloppy.live</a>

  <script>
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');

    const TILE_SIZE = 20;
    const GRID_WIDTH = canvas.width / TILE_SIZE;
    const GRID_HEIGHT = 100; // Total depth
    const VISIBLE_HEIGHT = canvas.height / TILE_SIZE;

    const DRILL_WIDTH = 3;
    const DRILL_HEIGHT = 2;

    let grid = [];
    let drill = {};
    let camera = { y: 0 };
    let score = 0;
    let maxDepth = 0;
    let heat = 0;
    let fuel = 100;
    let gameRunning = false;
    let isDrilling = false;
    let keys = {};
    let particles = [];
    let lastTime = 0;

    const TILE_TYPES = {
      EMPTY: 0,
      DIRT: 1,
      QUARTZ: 2,    // Purple
      EMERALD: 3,   // Green
      DIAMOND: 4,   // Pink
      COOLANT: 5,   // Cyan
      BEDROCK: 6
    };

    const COLORS = {
      [TILE_TYPES.EMPTY]: '#0a0a12',
      [TILE_TYPES.DIRT]: '#1a1520',
      [TILE_TYPES.QUARTZ]: '#8000ff',
      [TILE_TYPES.EMERALD]: '#00ff80',
      [TILE_TYPES.DIAMOND]: '#ff00ff',
      [TILE_TYPES.COOLANT]: '#00ffff',
      [TILE_TYPES.BEDROCK]: '#333'
    };

    const VALUES = {
      [TILE_TYPES.QUARTZ]: 10,
      [TILE_TYPES.EMERALD]: 50,
      [TILE_TYPES.DIAMOND]: 100
    };

    function generateGrid() {
      grid = [];
      for (let y = 0; y < GRID_HEIGHT; y++) {
        const row = [];
        for (let x = 0; x < GRID_WIDTH; x++) {
          if (y < 2) {
            row.push(TILE_TYPES.EMPTY);
          } else if (y >= GRID_HEIGHT - 2) {
            row.push(TILE_TYPES.BEDROCK);
          } else {
            // Generate terrain
            const rand = Math.random();
            const depthBonus = y / GRID_HEIGHT;

            if (rand < 0.02 + depthBonus * 0.03) {
              row.push(TILE_TYPES.DIAMOND);
            } else if (rand < 0.08 + depthBonus * 0.05) {
              row.push(TILE_TYPES.EMERALD);
            } else if (rand < 0.25) {
              row.push(TILE_TYPES.QUARTZ);
            } else if (rand < 0.28) {
              row.push(TILE_TYPES.COOLANT);
            } else {
              row.push(TILE_TYPES.DIRT);
            }
          }
        }
        grid.push(row);
      }
    }

    function initDrill() {
      drill = {
        x: Math.floor(GRID_WIDTH / 2) - 1,
        y: 0,
        targetX: Math.floor(GRID_WIDTH / 2) - 1,
        targetY: 0,
        laserOn: false,
        drillProgress: 0
      };
    }

    function update(deltaTime) {
      if (!gameRunning) return;

      // Movement
      if (keys['ArrowLeft'] || keys['KeyA']) {
        drill.targetX = Math.max(0, drill.x - 1);
      }
      if (keys['ArrowRight'] || keys['KeyD']) {
        drill.targetX = Math.min(GRID_WIDTH - DRILL_WIDTH, drill.x + 1);
      }

      // Horizontal movement (smooth)
      if (drill.x !== drill.targetX) {
        const dir = drill.targetX > drill.x ? 1 : -1;
        drill.x += dir * 0.2;
        if (Math.abs(drill.x - drill.targetX) < 0.2) {
          drill.x = drill.targetX;
        }
      }

      // Drilling
      isDrilling = keys['ArrowDown'] || keys['Space'] || keys['KeyS'];
      drill.laserOn = isDrilling && heat < 100;

      if (drill.laserOn && fuel > 0) {
        heat += 0.8;
        fuel -= 0.05;
        drill.drillProgress += 0.03;

        // Spawn laser particles
        if (Math.random() > 0.5) {
          const px = (drill.x + DRILL_WIDTH / 2) * TILE_SIZE + (Math.random() - 0.5) * 20;
          const py = (drill.y + DRILL_HEIGHT) * TILE_SIZE - camera.y;
          particles.push({
            x: px,
            y: py,
            vx: (Math.random() - 0.5) * 3,
            vy: Math.random() * 2 + 1,
            life: 1,
            color: heat > 70 ? '#ff0000' : '#00ff80'
          });
        }

        if (drill.drillProgress >= 1) {
          drill.drillProgress = 0;
          const digY = Math.floor(drill.y) + DRILL_HEIGHT;

          if (digY < GRID_HEIGHT) {
            let canDig = true;
            for (let dx = 0; dx < DRILL_WIDTH; dx++) {
              const tx = Math.floor(drill.x) + dx;
              if (tx >= 0 && tx < GRID_WIDTH) {
                const tile = grid[digY][tx];
                if (tile === TILE_TYPES.BEDROCK) {
                  canDig = false;
                  break;
                }
              }
            }

            if (canDig) {
              for (let dx = 0; dx < DRILL_WIDTH; dx++) {
                const tx = Math.floor(drill.x) + dx;
                if (tx >= 0 && tx < GRID_WIDTH) {
                  const tile = grid[digY][tx];

                  // Collect minerals
                  if (VALUES[tile]) {
                    score += VALUES[tile];
                    document.getElementById('score').textContent = score;
                    playCollectSound(tile);
                  }

                  // Coolant
                  if (tile === TILE_TYPES.COOLANT) {
                    heat = Math.max(0, heat - 30);
                    playCoolSound();
                  }

                  grid[digY][tx] = TILE_TYPES.EMPTY;
                }
              }

              drill.y += 1;
              drill.targetY = drill.y;

              const depth = Math.floor(drill.y);
              if (depth > maxDepth) {
                maxDepth = depth;
                document.getElementById('depth').textContent = maxDepth;
              }
            }
          }
        }
      } else {
        // Cooling when not drilling
        heat = Math.max(0, heat - 0.3);
      }

      // Clamp heat
      heat = Math.min(100, heat);

      // Update heat display
      document.getElementById('heatFill').style.height = heat + '%';
      document.getElementById('overheatWarning').style.display = heat >= 100 ? 'block' : 'none';
      document.getElementById('fuel').textContent = Math.floor(fuel);

      // Camera follow
      const targetCameraY = Math.max(0, drill.y * TILE_SIZE - canvas.height / 3);
      camera.y += (targetCameraY - camera.y) * 0.1;

      // Update particles
      particles = particles.filter(p => {
        p.x += p.vx;
        p.y += p.vy;
        p.life -= 0.03;
        return p.life > 0;
      });

      // Game over check
      if (fuel <= 0) {
        gameOver();
      }
    }

    function draw() {
      // Clear
      ctx.fillStyle = '#0a0a12';
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // Draw grid
      const startY = Math.floor(camera.y / TILE_SIZE);
      const endY = Math.min(GRID_HEIGHT, startY + VISIBLE_HEIGHT + 2);

      for (let y = startY; y < endY; y++) {
        for (let x = 0; x < GRID_WIDTH; x++) {
          const tile = grid[y][x];
          if (tile !== TILE_TYPES.EMPTY) {
            const screenY = y * TILE_SIZE - camera.y;

            ctx.fillStyle = COLORS[tile];

            if (tile === TILE_TYPES.DIRT) {
              ctx.fillRect(x * TILE_SIZE, screenY, TILE_SIZE, TILE_SIZE);
            } else if (tile === TILE_TYPES.BEDROCK) {
              ctx.fillRect(x * TILE_SIZE, screenY, TILE_SIZE, TILE_SIZE);
              ctx.strokeStyle = '#444';
              ctx.strokeRect(x * TILE_SIZE, screenY, TILE_SIZE, TILE_SIZE);
            } else {
              // Glowing minerals
              ctx.shadowColor = COLORS[tile];
              ctx.shadowBlur = 10;
              ctx.beginPath();
              ctx.roundRect(x * TILE_SIZE + 2, screenY + 2, TILE_SIZE - 4, TILE_SIZE - 4, 4);
              ctx.fill();
              ctx.shadowBlur = 0;
            }
          }
        }
      }

      // Draw drill
      const drillScreenX = drill.x * TILE_SIZE;
      const drillScreenY = drill.y * TILE_SIZE - camera.y;

      // Drill body
      ctx.fillStyle = '#1a1a2e';
      ctx.strokeStyle = '#8000ff';
      ctx.lineWidth = 2;
      ctx.shadowColor = '#8000ff';
      ctx.shadowBlur = 15;
      ctx.beginPath();
      ctx.roundRect(drillScreenX, drillScreenY, DRILL_WIDTH * TILE_SIZE, DRILL_HEIGHT * TILE_SIZE, 8);
      ctx.fill();
      ctx.stroke();
      ctx.shadowBlur = 0;

      // Drill details
      ctx.fillStyle = heat > 70 ? '#ff0000' : '#00ff80';
      ctx.shadowColor = ctx.fillStyle;
      ctx.shadowBlur = 10;
      ctx.beginPath();
      ctx.arc(drillScreenX + DRILL_WIDTH * TILE_SIZE / 2, drillScreenY + 15, 8, 0, Math.PI * 2);
      ctx.fill();
      ctx.shadowBlur = 0;

      // Laser beam when drilling
      if (drill.laserOn) {
        const laserX = drillScreenX + DRILL_WIDTH * TILE_SIZE / 2;
        const laserStartY = drillScreenY + DRILL_HEIGHT * TILE_SIZE;
        const laserEndY = laserStartY + 60;

        const gradient = ctx.createLinearGradient(laserX, laserStartY, laserX, laserEndY);
        gradient.addColorStop(0, heat > 70 ? 'rgba(255,0,0,0.9)' : 'rgba(0,255,128,0.9)');
        gradient.addColorStop(1, 'transparent');

        ctx.strokeStyle = gradient;
        ctx.lineWidth = 6;
        ctx.shadowColor = heat > 70 ? '#ff0000' : '#00ff80';
        ctx.shadowBlur = 20;
        ctx.beginPath();
        ctx.moveTo(laserX, laserStartY);
        ctx.lineTo(laserX, laserEndY);
        ctx.stroke();

        // Side beams
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.moveTo(laserX - 15, laserStartY);
        ctx.lineTo(laserX - 15, laserStartY + 40);
        ctx.moveTo(laserX + 15, laserStartY);
        ctx.lineTo(laserX + 15, laserStartY + 40);
        ctx.stroke();
        ctx.shadowBlur = 0;
      }

      // Draw particles
      for (const p of particles) {
        ctx.beginPath();
        ctx.arc(p.x, p.y, 3, 0, Math.PI * 2);
        ctx.fillStyle = p.color;
        ctx.globalAlpha = p.life;
        ctx.shadowColor = p.color;
        ctx.shadowBlur = 8;
        ctx.fill();
      }
      ctx.globalAlpha = 1;
      ctx.shadowBlur = 0;

      // Depth indicator on right
      ctx.fillStyle = 'rgba(128, 0, 255, 0.3)';
      ctx.fillRect(canvas.width - 5, 0, 5, canvas.height);

      const depthRatio = drill.y / GRID_HEIGHT;
      ctx.fillStyle = '#8000ff';
      ctx.fillRect(canvas.width - 5, depthRatio * canvas.height - 5, 5, 10);
    }

    function gameLoop(time) {
      const deltaTime = time - lastTime;
      lastTime = time;

      update(deltaTime);
      draw();
      requestAnimationFrame(gameLoop);
    }

    function startGame() {
      document.getElementById('startScreen').classList.add('hidden');
      document.getElementById('gameOverScreen').classList.add('hidden');

      score = 0;
      maxDepth = 0;
      heat = 0;
      fuel = 100;
      particles = [];
      camera.y = 0;

      document.getElementById('score').textContent = '0';
      document.getElementById('depth').textContent = '0';
      document.getElementById('fuel').textContent = '100';
      document.getElementById('heatFill').style.height = '0%';

      generateGrid();
      initDrill();
      gameRunning = true;
    }

    function gameOver() {
      gameRunning = false;
      document.getElementById('finalScore').textContent = score;
      document.getElementById('finalDepth').textContent = maxDepth;
      document.getElementById('gameOverScreen').classList.remove('hidden');
    }

    // Audio
    let audioCtx;
    function getAudioCtx() {
      if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      return audioCtx;
    }

    function playCollectSound(tile) {
      const ctx = getAudioCtx();
      const osc = ctx.createOscillator();
      const gain = ctx.createGain();
      osc.connect(gain);
      gain.connect(ctx.destination);

      const freq = tile === TILE_TYPES.DIAMOND ? 1000 :
                   tile === TILE_TYPES.EMERALD ? 800 : 600;

      osc.type = 'sine';
      osc.frequency.setValueAtTime(freq, ctx.currentTime);
      osc.frequency.exponentialRampToValueAtTime(freq * 1.5, ctx.currentTime + 0.1);
      gain.gain.setValueAtTime(0.1, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.15);
      osc.start(ctx.currentTime);
      osc.stop(ctx.currentTime + 0.15);
    }

    function playCoolSound() {
      const ctx = getAudioCtx();
      const osc = ctx.createOscillator();
      const gain = ctx.createGain();
      osc.connect(gain);
      gain.connect(ctx.destination);
      osc.type = 'sine';
      osc.frequency.setValueAtTime(1200, ctx.currentTime);
      osc.frequency.exponentialRampToValueAtTime(400, ctx.currentTime + 0.2);
      gain.gain.setValueAtTime(0.08, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.25);
      osc.start(ctx.currentTime);
      osc.stop(ctx.currentTime + 0.25);
    }

    // Input
    document.addEventListener('keydown', (e) => {
      keys[e.code] = true;
      if (['Space', 'ArrowDown', 'ArrowUp'].includes(e.code)) {
        e.preventDefault();
      }
    });

    document.addEventListener('keyup', (e) => {
      keys[e.code] = false;
    });

    // Mobile controls
    const leftBtn = document.getElementById('leftBtn');
    const rightBtn = document.getElementById('rightBtn');
    const drillBtn = document.getElementById('drillBtn');

    leftBtn.addEventListener('touchstart', (e) => { e.preventDefault(); keys['ArrowLeft'] = true; });
    leftBtn.addEventListener('touchend', () => keys['ArrowLeft'] = false);
    rightBtn.addEventListener('touchstart', (e) => { e.preventDefault(); keys['ArrowRight'] = true; });
    rightBtn.addEventListener('touchend', () => keys['ArrowRight'] = false);
    drillBtn.addEventListener('touchstart', (e) => { e.preventDefault(); keys['Space'] = true; });
    drillBtn.addEventListener('touchend', () => keys['Space'] = false);

    // Init
    generateGrid();
    initDrill();
    requestAnimationFrame(gameLoop);
  </script>
<script src="/sloppy-header/sloppy-bar.js"></script>
</body>
</html>
