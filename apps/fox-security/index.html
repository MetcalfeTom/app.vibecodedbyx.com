<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fox Security Grid</title>
  <link rel="icon" href="https://emojicdn.elk.sh/ü¶ä">
  <meta property="og:title" content="Fox Security Grid">
  <meta property="og:description" content="High-security laser grid with fox-detecting motion sensors">
  <meta property="og:url" content="https://app.sloppy.live/fox-security">
  <meta property="og:image" content="https://emojicdn.elk.sh/ü¶ä?style=apple&size=512">
  <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Share Tech Mono', monospace;
      background: #0a0a0a;
      min-height: 100vh;
      color: #00ff00;
      overflow-x: hidden;
    }

    /* Scanline effect */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: repeating-linear-gradient(
        0deg,
        rgba(0, 0, 0, 0.1) 0px,
        rgba(0, 0, 0, 0.1) 1px,
        transparent 1px,
        transparent 2px
      );
      pointer-events: none;
      z-index: 1000;
    }

    .dashboard {
      padding: 20px;
      max-width: 1400px;
      margin: 0 auto;
    }

    /* Header */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border: 1px solid #00ff00;
      padding: 15px 25px;
      margin-bottom: 20px;
      background: rgba(0, 255, 0, 0.03);
    }

    .header-title {
      font-family: 'Orbitron', sans-serif;
      font-size: 1.5rem;
      font-weight: 900;
      letter-spacing: 4px;
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .fox-icon {
      font-size: 2rem;
      animation: foxPulse 2s infinite;
    }

    @keyframes foxPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }

    .status-badge {
      padding: 8px 20px;
      border: 2px solid;
      font-weight: bold;
      letter-spacing: 2px;
      text-transform: uppercase;
      animation: statusPulse 1s infinite;
    }

    .status-badge.secure {
      border-color: #00ff00;
      color: #00ff00;
      background: rgba(0, 255, 0, 0.1);
    }

    .status-badge.alert {
      border-color: #ff0000;
      color: #ff0000;
      background: rgba(255, 0, 0, 0.2);
      animation: alertFlash 0.3s infinite;
    }

    @keyframes alertFlash {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    @keyframes statusPulse {
      0%, 100% { box-shadow: 0 0 5px currentColor; }
      50% { box-shadow: 0 0 20px currentColor; }
    }

    /* Main Grid */
    .main-grid {
      display: grid;
      grid-template-columns: 1fr 300px;
      gap: 20px;
    }

    @media (max-width: 900px) {
      .main-grid { grid-template-columns: 1fr; }
    }

    /* Laser Grid Section */
    .laser-section {
      border: 1px solid #00ff00;
      background: rgba(0, 255, 0, 0.02);
    }

    .section-header {
      padding: 10px 20px;
      border-bottom: 1px solid #00ff00;
      background: rgba(0, 255, 0, 0.05);
      font-family: 'Orbitron', sans-serif;
      letter-spacing: 2px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .laser-grid-container {
      position: relative;
      height: 400px;
      background: #050505;
      overflow: hidden;
    }

    .laser-grid {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }

    .laser-h, .laser-v {
      position: absolute;
      background: linear-gradient(90deg, transparent, #ff0000, transparent);
      box-shadow: 0 0 10px #ff0000, 0 0 20px #ff0000, 0 0 30px #ff3333;
      opacity: 0.8;
    }

    .laser-h {
      height: 2px;
      width: 100%;
      animation: laserSweepH 3s infinite;
    }

    .laser-v {
      width: 2px;
      height: 100%;
      background: linear-gradient(180deg, transparent, #ff0000, transparent);
      animation: laserSweepV 4s infinite;
    }

    @keyframes laserSweepH {
      0%, 100% { opacity: 0.4; }
      50% { opacity: 1; }
    }

    @keyframes laserSweepV {
      0%, 100% { opacity: 0.4; }
      50% { opacity: 1; }
    }

    .grid-lines {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image:
        linear-gradient(rgba(0, 255, 0, 0.1) 1px, transparent 1px),
        linear-gradient(90deg, rgba(0, 255, 0, 0.1) 1px, transparent 1px);
      background-size: 40px 40px;
    }

    /* Fox Detection */
    .fox-target {
      position: absolute;
      width: 60px;
      height: 60px;
      display: none;
      align-items: center;
      justify-content: center;
      font-size: 2.5rem;
      animation: foxSneak 0.5s ease-out;
      cursor: pointer;
      z-index: 10;
    }

    .fox-target.detected {
      display: flex;
    }

    @keyframes foxSneak {
      0% { transform: scale(0) rotate(-20deg); opacity: 0; }
      100% { transform: scale(1) rotate(0deg); opacity: 1; }
    }

    .detection-ring {
      position: absolute;
      border: 2px solid #ff0000;
      border-radius: 50%;
      animation: detectRing 1s infinite;
    }

    @keyframes detectRing {
      0% { width: 60px; height: 60px; opacity: 1; }
      100% { width: 120px; height: 120px; opacity: 0; margin: -30px; }
    }

    /* Sensors Panel */
    .sensors-panel {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .sensor-card {
      border: 1px solid #00ff00;
      background: rgba(0, 255, 0, 0.02);
    }

    .sensor-header {
      padding: 10px 15px;
      border-bottom: 1px solid rgba(0, 255, 0, 0.3);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .sensor-name {
      font-size: 0.8rem;
      letter-spacing: 1px;
    }

    .sensor-status {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #00ff00;
      box-shadow: 0 0 10px #00ff00;
      animation: sensorBlink 2s infinite;
    }

    .sensor-status.triggered {
      background: #ff0000;
      box-shadow: 0 0 10px #ff0000;
      animation: sensorAlert 0.2s infinite;
    }

    @keyframes sensorBlink {
      0%, 90%, 100% { opacity: 1; }
      95% { opacity: 0.3; }
    }

    @keyframes sensorAlert {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.3; }
    }

    .sensor-body {
      padding: 15px;
    }

    .sensor-reading {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      font-size: 0.75rem;
      color: #888;
    }

    .sensor-value {
      color: #00ff00;
      font-weight: bold;
    }

    .sensor-value.warning { color: #ffcc00; }
    .sensor-value.danger { color: #ff0000; }

    .sensor-bar {
      height: 4px;
      background: #222;
      border-radius: 2px;
      overflow: hidden;
    }

    .sensor-bar-fill {
      height: 100%;
      background: #00ff00;
      transition: width 0.3s, background 0.3s;
    }

    .sensor-bar-fill.warning { background: #ffcc00; }
    .sensor-bar-fill.danger { background: #ff0000; }

    /* Alert Log */
    .alert-log {
      border: 1px solid #00ff00;
      background: rgba(0, 255, 0, 0.02);
      max-height: 200px;
    }

    .log-entries {
      height: 150px;
      overflow-y: auto;
      padding: 10px;
      font-size: 0.7rem;
    }

    .log-entry {
      padding: 5px 0;
      border-bottom: 1px solid rgba(0, 255, 0, 0.1);
      display: flex;
      gap: 10px;
    }

    .log-time { color: #666; }
    .log-message { color: #00ff00; }
    .log-message.alert { color: #ff0000; }

    /* Controls */
    .controls-section {
      margin-top: 20px;
      border: 1px solid #00ff00;
      padding: 15px 20px;
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      background: rgba(0, 255, 0, 0.02);
    }

    .control-btn {
      padding: 10px 25px;
      background: transparent;
      border: 1px solid #00ff00;
      color: #00ff00;
      font-family: inherit;
      font-size: 0.8rem;
      letter-spacing: 2px;
      cursor: pointer;
      transition: all 0.2s;
      text-transform: uppercase;
    }

    .control-btn:hover {
      background: rgba(0, 255, 0, 0.1);
      box-shadow: 0 0 15px rgba(0, 255, 0, 0.3);
    }

    .control-btn.danger {
      border-color: #ff0000;
      color: #ff0000;
    }

    .control-btn.danger:hover {
      background: rgba(255, 0, 0, 0.1);
      box-shadow: 0 0 15px rgba(255, 0, 0, 0.3);
    }

    .control-btn.active {
      background: #00ff00;
      color: #000;
    }

    /* Siren Overlay */
    .siren-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255, 0, 0, 0.1);
      pointer-events: none;
      opacity: 0;
      z-index: 500;
      animation: none;
    }

    .siren-overlay.active {
      animation: sirenFlash 0.5s infinite;
    }

    @keyframes sirenFlash {
      0%, 100% { opacity: 0; background: rgba(255, 0, 0, 0.1); }
      25% { opacity: 1; background: rgba(255, 0, 0, 0.3); }
      50% { opacity: 0; background: rgba(0, 0, 255, 0.1); }
      75% { opacity: 1; background: rgba(0, 0, 255, 0.2); }
    }

    .back-link {
      position: fixed;
      bottom: 15px;
      right: 15px;
      color: #333;
      text-decoration: none;
      font-size: 0.7rem;
      z-index: 100;
    }

    .back-link:hover { color: #00ff00; }

    /* Detection counter */
    .detection-counter {
      font-family: 'Orbitron', sans-serif;
      font-size: 2rem;
      text-align: center;
      padding: 20px;
      border: 1px solid #ff6600;
      background: rgba(255, 102, 0, 0.05);
      color: #ff6600;
    }

    .counter-label {
      font-size: 0.7rem;
      letter-spacing: 2px;
      margin-bottom: 5px;
      color: #888;
    }
  </style>
</head>
<body>
  <div class="siren-overlay" id="sirenOverlay"></div>

  <div class="dashboard">
    <header class="header">
      <div class="header-title">
        <span class="fox-icon">ü¶ä</span>
        FOX SECURITY GRID v2.0
      </div>
      <div class="status-badge secure" id="statusBadge">SECURE</div>
    </header>

    <div class="main-grid">
      <div class="laser-section">
        <div class="section-header">
          <span>LASER GRID ARRAY</span>
          <span id="gridStatus">ACTIVE</span>
        </div>
        <div class="laser-grid-container" id="laserContainer">
          <div class="grid-lines"></div>
          <div class="laser-grid" id="laserGrid"></div>
          <div class="fox-target" id="foxTarget">
            ü¶ä
            <div class="detection-ring"></div>
          </div>
        </div>
      </div>

      <div class="sensors-panel">
        <div class="sensor-card">
          <div class="sensor-header">
            <span class="sensor-name">MOTION SENSOR A1</span>
            <div class="sensor-status" id="sensorA1"></div>
          </div>
          <div class="sensor-body">
            <div class="sensor-reading">
              <span>Activity Level</span>
              <span class="sensor-value" id="sensorA1Value">0%</span>
            </div>
            <div class="sensor-bar">
              <div class="sensor-bar-fill" id="sensorA1Bar" style="width: 0%"></div>
            </div>
          </div>
        </div>

        <div class="sensor-card">
          <div class="sensor-header">
            <span class="sensor-name">THERMAL SCANNER B2</span>
            <div class="sensor-status" id="sensorB2"></div>
          </div>
          <div class="sensor-body">
            <div class="sensor-reading">
              <span>Heat Signature</span>
              <span class="sensor-value" id="sensorB2Value">22¬∞C</span>
            </div>
            <div class="sensor-bar">
              <div class="sensor-bar-fill" id="sensorB2Bar" style="width: 30%"></div>
            </div>
          </div>
        </div>

        <div class="sensor-card">
          <div class="sensor-header">
            <span class="sensor-name">FOX DETECTOR C3</span>
            <div class="sensor-status" id="sensorC3"></div>
          </div>
          <div class="sensor-body">
            <div class="sensor-reading">
              <span>Fox Probability</span>
              <span class="sensor-value" id="sensorC3Value">0%</span>
            </div>
            <div class="sensor-bar">
              <div class="sensor-bar-fill" id="sensorC3Bar" style="width: 0%"></div>
            </div>
          </div>
        </div>

        <div class="detection-counter">
          <div class="counter-label">FOXES DETECTED</div>
          <div id="foxCount">0</div>
        </div>

        <div class="alert-log">
          <div class="section-header">
            <span>SECURITY LOG</span>
          </div>
          <div class="log-entries" id="logEntries">
            <div class="log-entry">
              <span class="log-time">00:00:00</span>
              <span class="log-message">System initialized</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="controls-section">
      <button class="control-btn active" id="gridToggle">GRID: ON</button>
      <button class="control-btn" id="spawnFox">SIMULATE FOX</button>
      <button class="control-btn danger" id="sirenBtn">TEST SIREN</button>
      <button class="control-btn" id="clearLog">CLEAR LOG</button>
      <button class="control-btn danger" id="resetSystem">RESET SYSTEM</button>
    </div>
  </div>

  <a href="https://sloppy.live" class="back-link">‚Üê sloppy.live</a>

  <script>
    // Audio Context for siren
    let audioCtx = null;
    let sirenOsc = null;
    let sirenGain = null;

    function initAudio() {
      if (!audioCtx) {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      }
    }

    function startSiren() {
      initAudio();
      if (sirenOsc) return;

      sirenOsc = audioCtx.createOscillator();
      sirenGain = audioCtx.createGain();

      sirenOsc.connect(sirenGain);
      sirenGain.connect(audioCtx.destination);

      sirenOsc.type = 'sawtooth';
      sirenGain.gain.value = 0.1;

      sirenOsc.start();

      // Siren sweep
      let freq = 400;
      let direction = 1;
      const sirenInterval = setInterval(() => {
        if (!sirenOsc) {
          clearInterval(sirenInterval);
          return;
        }
        freq += direction * 20;
        if (freq > 800) direction = -1;
        if (freq < 400) direction = 1;
        sirenOsc.frequency.setValueAtTime(freq, audioCtx.currentTime);
      }, 50);
    }

    function stopSiren() {
      if (sirenOsc) {
        sirenOsc.stop();
        sirenOsc.disconnect();
        sirenOsc = null;
      }
    }

    // Generate laser grid
    const laserGrid = document.getElementById('laserGrid');
    const laserContainer = document.getElementById('laserContainer');
    let gridActive = true;

    function generateLasers() {
      laserGrid.innerHTML = '';
      if (!gridActive) return;

      // Horizontal lasers
      for (let i = 1; i <= 8; i++) {
        const laser = document.createElement('div');
        laser.className = 'laser-h';
        laser.style.top = (i * 12.5) + '%';
        laser.style.animationDelay = (i * 0.2) + 's';
        laserGrid.appendChild(laser);
      }

      // Vertical lasers
      for (let i = 1; i <= 10; i++) {
        const laser = document.createElement('div');
        laser.className = 'laser-v';
        laser.style.left = (i * 10) + '%';
        laser.style.animationDelay = (i * 0.15) + 's';
        laserGrid.appendChild(laser);
      }
    }

    generateLasers();

    // Fox detection
    const foxTarget = document.getElementById('foxTarget');
    const statusBadge = document.getElementById('statusBadge');
    const sirenOverlay = document.getElementById('sirenOverlay');
    let foxCount = 0;
    let alertActive = false;

    function spawnFox() {
      if (foxTarget.classList.contains('detected')) return;

      const containerRect = laserContainer.getBoundingClientRect();
      const x = Math.random() * (containerRect.width - 60);
      const y = Math.random() * (containerRect.height - 60);

      foxTarget.style.left = x + 'px';
      foxTarget.style.top = y + 'px';
      foxTarget.classList.add('detected');

      // Trigger alert
      triggerAlert();

      // Update sensors
      updateSensor('sensorC3', 95, 'danger');
      updateSensor('sensorA1', 80, 'danger');
      updateSensor('sensorB2', 38, 'warning', '38¬∞C');

      addLogEntry('ü¶ä FOX DETECTED at grid position ' + Math.floor(x/40) + ',' + Math.floor(y/40), true);
    }

    function triggerAlert() {
      alertActive = true;
      statusBadge.textContent = 'FOX ALERT';
      statusBadge.classList.remove('secure');
      statusBadge.classList.add('alert');
      sirenOverlay.classList.add('active');

      document.querySelectorAll('.sensor-status').forEach(s => s.classList.add('triggered'));

      startSiren();
    }

    function clearAlert() {
      alertActive = false;
      statusBadge.textContent = 'SECURE';
      statusBadge.classList.remove('alert');
      statusBadge.classList.add('secure');
      sirenOverlay.classList.remove('active');

      document.querySelectorAll('.sensor-status').forEach(s => s.classList.remove('triggered'));

      stopSiren();

      updateSensor('sensorC3', 0);
      updateSensor('sensorA1', 0);
      updateSensor('sensorB2', 30, '', '22¬∞C');
    }

    // Click fox to catch it
    foxTarget.addEventListener('click', () => {
      foxCount++;
      document.getElementById('foxCount').textContent = foxCount;
      foxTarget.classList.remove('detected');
      addLogEntry('üéØ Fox captured! Total: ' + foxCount);
      clearAlert();
    });

    // Sensor updates
    function updateSensor(id, value, status = '', customValue = null) {
      const bar = document.getElementById(id + 'Bar');
      const val = document.getElementById(id + 'Value');

      bar.style.width = value + '%';
      bar.className = 'sensor-bar-fill ' + status;
      val.className = 'sensor-value ' + status;
      val.textContent = customValue || value + '%';
    }

    // Log entries
    function addLogEntry(message, isAlert = false) {
      const log = document.getElementById('logEntries');
      const now = new Date();
      const time = now.toTimeString().split(' ')[0];

      const entry = document.createElement('div');
      entry.className = 'log-entry';
      entry.innerHTML = `
        <span class="log-time">${time}</span>
        <span class="log-message ${isAlert ? 'alert' : ''}">${message}</span>
      `;

      log.insertBefore(entry, log.firstChild);
    }

    // Controls
    document.getElementById('gridToggle').addEventListener('click', function() {
      gridActive = !gridActive;
      this.textContent = 'GRID: ' + (gridActive ? 'ON' : 'OFF');
      this.classList.toggle('active', gridActive);
      document.getElementById('gridStatus').textContent = gridActive ? 'ACTIVE' : 'DISABLED';
      generateLasers();
      addLogEntry('Laser grid ' + (gridActive ? 'activated' : 'deactivated'));
    });

    document.getElementById('spawnFox').addEventListener('click', () => {
      spawnFox();
    });

    document.getElementById('sirenBtn').addEventListener('click', function() {
      if (sirenOverlay.classList.contains('active')) {
        sirenOverlay.classList.remove('active');
        stopSiren();
        this.textContent = 'TEST SIREN';
      } else {
        sirenOverlay.classList.add('active');
        startSiren();
        this.textContent = 'STOP SIREN';
        addLogEntry('Siren test activated', true);
      }
    });

    document.getElementById('clearLog').addEventListener('click', () => {
      document.getElementById('logEntries').innerHTML = '';
      addLogEntry('Log cleared');
    });

    document.getElementById('resetSystem').addEventListener('click', () => {
      foxCount = 0;
      document.getElementById('foxCount').textContent = '0';
      foxTarget.classList.remove('detected');
      clearAlert();
      gridActive = true;
      document.getElementById('gridToggle').textContent = 'GRID: ON';
      document.getElementById('gridToggle').classList.add('active');
      document.getElementById('gridStatus').textContent = 'ACTIVE';
      generateLasers();
      document.getElementById('logEntries').innerHTML = '';
      addLogEntry('System reset complete');
    });

    // Random sensor fluctuations
    setInterval(() => {
      if (!alertActive) {
        const noise = Math.random() * 5;
        updateSensor('sensorA1', noise);

        const temp = 20 + Math.random() * 5;
        updateSensor('sensorB2', temp * 2, '', temp.toFixed(1) + '¬∞C');
      }
    }, 1000);

    // Random fox spawns
    setInterval(() => {
      if (!alertActive && gridActive && Math.random() < 0.1) {
        spawnFox();
      }
    }, 5000);

    addLogEntry('Fox Security Grid v2.0 online');
    addLogEntry('All sensors calibrated');
    addLogEntry('Laser grid activated');
  </script>
<script src="/apps/sloppy-header/sloppy-bar.js"></script>
<script src="/vibelib-extended.js"></script>
<script>
  // Compatibility Patch for Legacy Apps
  window.addEventListener("load", () => {
    if (window.SloppyKarma && window.VibeLib.Economy) {
      // Redirect old calls to new engine
      window.SloppyKarma.track = window.VibeLib.Economy.track;
    }
  });
</script>
</body>
</html>
