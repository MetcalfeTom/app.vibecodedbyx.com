<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Code Unlock - Puzzle Your Way to Source</title>
  <link rel="icon" href="https://emojicdn.elk.sh/ðŸ”“">
  <meta name="description" content="Solve puzzles to decrypt and unlock hidden source code segments.">
  <meta property="og:title" content="Code Unlock">
  <meta property="og:description" content="Solve puzzles to decrypt and unlock hidden source code.">
  <meta property="og:url" content="https://app.sloppy.live/code-unlock">
  <meta property="og:image" content="https://app.sloppy.live/code-unlock/og-image.png">
  <meta property="og:type" content="website">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;600&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    :root {
      --bg: #0a0a0f;
      --surface: #12121a;
      --card: #1a1a25;
      --border: #2a2a3a;
      --text: #e0e0e0;
      --text-dim: #666;
      --green: #00ff88;
      --cyan: #00d4ff;
      --purple: #a855f7;
      --orange: #ff8800;
      --red: #ff4455;
    }
    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Space Grotesk', sans-serif;
      min-height: 100vh;
      background-image:
        radial-gradient(ellipse at 20% 20%, rgba(0, 255, 136, 0.03) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 80%, rgba(0, 212, 255, 0.03) 0%, transparent 50%);
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
    }
    header {
      text-align: center;
      padding: 40px 20px;
      margin-bottom: 30px;
    }
    h1 {
      font-size: clamp(28px, 6vw, 42px);
      font-weight: 700;
      margin-bottom: 10px;
      background: linear-gradient(135deg, var(--green) 0%, var(--cyan) 50%, var(--purple) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .subtitle {
      color: var(--text-dim);
      font-size: 14px;
      font-family: 'Fira Code', monospace;
    }
    .progress-bar {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 15px 20px;
      margin-bottom: 30px;
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .progress-label {
      font-size: 13px;
      color: var(--text-dim);
      white-space: nowrap;
    }
    .progress-track {
      flex: 1;
      height: 8px;
      background: var(--card);
      border-radius: 4px;
      overflow: hidden;
    }
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--green), var(--cyan));
      border-radius: 4px;
      transition: width 0.5s ease;
    }
    .progress-text {
      font-family: 'Fira Code', monospace;
      font-size: 14px;
      color: var(--green);
    }
    .puzzle-card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 30px;
      margin-bottom: 20px;
    }
    .puzzle-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .puzzle-type {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      padding: 4px 10px;
      border-radius: 4px;
      background: rgba(0, 255, 136, 0.1);
      color: var(--green);
    }
    .puzzle-number {
      font-family: 'Fira Code', monospace;
      font-size: 13px;
      color: var(--text-dim);
    }
    .puzzle-question {
      font-size: 18px;
      font-weight: 500;
      margin-bottom: 25px;
      line-height: 1.6;
    }
    .puzzle-options {
      display: grid;
      gap: 10px;
      margin-bottom: 20px;
    }
    .puzzle-option {
      background: var(--card);
      border: 2px solid var(--border);
      border-radius: 8px;
      padding: 14px 18px;
      font-family: 'Fira Code', monospace;
      font-size: 14px;
      color: var(--text);
      cursor: pointer;
      transition: all 0.2s;
      text-align: left;
    }
    .puzzle-option:hover {
      border-color: var(--cyan);
      background: rgba(0, 212, 255, 0.05);
    }
    .puzzle-option.selected {
      border-color: var(--cyan);
      background: rgba(0, 212, 255, 0.1);
    }
    .puzzle-option.correct {
      border-color: var(--green);
      background: rgba(0, 255, 136, 0.15);
    }
    .puzzle-option.wrong {
      border-color: var(--red);
      background: rgba(255, 68, 85, 0.1);
    }
    .puzzle-input {
      width: 100%;
      background: var(--card);
      border: 2px solid var(--border);
      border-radius: 8px;
      padding: 14px 18px;
      font-family: 'Fira Code', monospace;
      font-size: 14px;
      color: var(--text);
      outline: none;
      margin-bottom: 20px;
      transition: border-color 0.2s;
    }
    .puzzle-input:focus {
      border-color: var(--cyan);
    }
    .puzzle-input::placeholder {
      color: var(--text-dim);
    }
    .submit-btn {
      background: linear-gradient(135deg, var(--green), var(--cyan));
      border: none;
      border-radius: 8px;
      padding: 14px 30px;
      color: #000;
      font-family: 'Space Grotesk', sans-serif;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 20px rgba(0, 255, 136, 0.3);
    }
    .submit-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }
    .code-reward {
      display: none;
      margin-top: 25px;
      animation: slideIn 0.5s ease;
    }
    @keyframes slideIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .code-reward.visible {
      display: block;
    }
    .reward-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 12px;
    }
    .reward-header span {
      font-size: 20px;
    }
    .reward-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--green);
    }
    .code-block {
      background: #0d0d12;
      border: 1px solid var(--border);
      border-radius: 8px;
      overflow: hidden;
    }
    .code-header {
      background: var(--card);
      padding: 10px 15px;
      font-size: 12px;
      color: var(--text-dim);
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .code-content {
      padding: 15px;
      font-family: 'Fira Code', monospace;
      font-size: 13px;
      line-height: 1.6;
      overflow-x: auto;
      white-space: pre;
    }
    .code-content .keyword { color: var(--purple); }
    .code-content .function { color: var(--cyan); }
    .code-content .string { color: var(--green); }
    .code-content .number { color: var(--orange); }
    .code-content .comment { color: var(--text-dim); font-style: italic; }
    .code-content .operator { color: var(--red); }
    .next-btn {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 12px 25px;
      color: var(--text);
      font-family: 'Space Grotesk', sans-serif;
      font-size: 14px;
      cursor: pointer;
      margin-top: 15px;
      transition: all 0.2s;
    }
    .next-btn:hover {
      border-color: var(--cyan);
      background: rgba(0, 212, 255, 0.1);
    }
    .complete-screen {
      display: none;
      text-align: center;
      padding: 60px 20px;
    }
    .complete-screen.visible {
      display: block;
    }
    .complete-icon {
      font-size: 64px;
      margin-bottom: 20px;
    }
    .complete-title {
      font-size: 28px;
      font-weight: 700;
      color: var(--green);
      margin-bottom: 10px;
    }
    .complete-text {
      color: var(--text-dim);
      margin-bottom: 30px;
    }
    .all-code-btn {
      background: linear-gradient(135deg, var(--purple), var(--cyan));
      border: none;
      border-radius: 8px;
      padding: 14px 30px;
      color: #fff;
      font-family: 'Space Grotesk', sans-serif;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
    }
    .hint-btn {
      background: none;
      border: none;
      color: var(--text-dim);
      font-size: 12px;
      cursor: pointer;
      margin-left: 15px;
      text-decoration: underline;
    }
    .hint-btn:hover {
      color: var(--orange);
    }
    .hint-text {
      background: rgba(255, 136, 0, 0.1);
      border: 1px solid rgba(255, 136, 0, 0.3);
      border-radius: 6px;
      padding: 12px;
      margin-bottom: 20px;
      font-size: 13px;
      color: var(--orange);
      display: none;
    }
    .hint-text.visible {
      display: block;
    }
    .backlink {
      display: block;
      text-align: center;
      margin-top: 40px;
      padding-bottom: 20px;
      color: var(--text-dim);
      font-size: 12px;
      text-decoration: none;
    }
    .backlink:hover {
      color: var(--green);
    }
    .locked-overlay {
      position: relative;
    }
    .encrypted-preview {
      font-family: 'Fira Code', monospace;
      font-size: 12px;
      color: var(--text-dim);
      background: var(--card);
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      overflow: hidden;
      position: relative;
    }
    .encrypted-preview::after {
      content: 'ENCRYPTED';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 14px;
      font-weight: 600;
      color: var(--red);
      background: var(--bg);
      padding: 8px 16px;
      border-radius: 4px;
      border: 1px solid var(--red);
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>{ Code Unlock }</h1>
      <p class="subtitle">// solve puzzles to decrypt source code</p>
    </header>

    <div class="progress-bar">
      <span class="progress-label">Decryption Progress:</span>
      <div class="progress-track">
        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
      </div>
      <span class="progress-text" id="progressText">0 / 8</span>
    </div>

    <div id="puzzleContainer"></div>

    <div class="complete-screen" id="completeScreen">
      <div class="complete-icon">ðŸ”“</div>
      <h2 class="complete-title">Full Access Granted!</h2>
      <p class="complete-text">You've decrypted all code segments. The source is yours.</p>
      <button class="all-code-btn" onclick="showAllCode()">View All Unlocked Code</button>
    </div>

    <a href="https://sloppy.live" class="backlink">sloppy.live</a>
  </div>

  <script>
    const puzzles = [
      {
        type: 'logic',
        question: 'What is the output of: console.log(typeof typeof 1)',
        options: ['"number"', '"string"', '"undefined"', '"object"'],
        answer: 1,
        hint: 'typeof always returns a string...',
        code: {
          title: 'Type Coercion Magic',
          file: 'utils/types.js',
          content: `<span class="comment">// JavaScript type coercion secrets</span>
<span class="keyword">const</span> <span class="function">getType</span> = (val) <span class="operator">=></span> {
  <span class="keyword">if</span> (val <span class="operator">===</span> <span class="keyword">null</span>) <span class="keyword">return</span> <span class="string">'null'</span>;
  <span class="keyword">if</span> (Array.<span class="function">isArray</span>(val)) <span class="keyword">return</span> <span class="string">'array'</span>;
  <span class="keyword">return</span> <span class="keyword">typeof</span> val;
};

<span class="comment">// Fun fact: typeof null === 'object' is a bug from 1995!</span>`
        }
      },
      {
        type: 'pattern',
        question: 'Complete the sequence: 2, 6, 12, 20, 30, ?',
        inputType: 'text',
        answer: '42',
        hint: 'Look at the differences between consecutive numbers...',
        code: {
          title: 'Sequence Generator',
          file: 'algorithms/sequence.js',
          content: `<span class="comment">// n(n+1) sequence generator</span>
<span class="keyword">function</span>* <span class="function">oblong</span>() {
  <span class="keyword">let</span> n = <span class="number">1</span>;
  <span class="keyword">while</span> (<span class="keyword">true</span>) {
    <span class="keyword">yield</span> n <span class="operator">*</span> (n <span class="operator">+</span> <span class="number">1</span>);
    n<span class="operator">++</span>;
  }
}

<span class="keyword">const</span> gen = <span class="function">oblong</span>();
<span class="comment">// gen.next().value â†’ 2, 6, 12, 20, 30, 42...</span>`
        }
      },
      {
        type: 'code',
        question: 'What does this return? [1,2,3].map(parseInt)',
        options: ['[1, 2, 3]', '[1, NaN, NaN]', '[NaN, NaN, NaN]', '[1, 1, 1]'],
        answer: 1,
        hint: 'parseInt takes two arguments: string and radix...',
        code: {
          title: 'The parseInt Trap',
          file: 'gotchas/parseint.js',
          content: `<span class="comment">// The classic JavaScript gotcha</span>
<span class="comment">// map passes (element, index, array) to callback</span>
<span class="comment">// parseInt expects (string, radix)</span>

[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].<span class="function">map</span>(parseInt)
<span class="comment">// â†’ parseInt(1, 0) = 1  (radix 0 defaults to 10)</span>
<span class="comment">// â†’ parseInt(2, 1) = NaN (no base-1 system)</span>
<span class="comment">// â†’ parseInt(3, 2) = NaN (3 invalid in binary)</span>

<span class="comment">// Fix:</span>
[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].<span class="function">map</span>(n <span class="operator">=></span> <span class="function">parseInt</span>(n, <span class="number">10</span>))`
        }
      },
      {
        type: 'riddle',
        question: 'I have keys but no locks. I have space but no room. You can enter but can\'t go inside. What am I?',
        inputType: 'text',
        answer: 'keyboard',
        hint: 'You\'re using one right now to type your answer...',
        code: {
          title: 'Keyboard Event Handler',
          file: 'input/keyboard.js',
          content: `<span class="comment">// Elegant keyboard input handler</span>
<span class="keyword">const</span> keys = <span class="keyword">new</span> Set();

<span class="keyword">const</span> <span class="function">handleInput</span> = {
  <span class="function">keydown</span>(e) { keys.<span class="function">add</span>(e.code); },
  <span class="function">keyup</span>(e) { keys.<span class="function">delete</span>(e.code); },
  <span class="function">isPressed</span>(code) { <span class="keyword">return</span> keys.<span class="function">has</span>(code); },
  <span class="function">isCombo</span>(...codes) {
    <span class="keyword">return</span> codes.<span class="function">every</span>(c <span class="operator">=></span> keys.<span class="function">has</span>(c));
  }
};

<span class="comment">// Check for Ctrl+Shift+S combo</span>
<span class="keyword">if</span> (handleInput.<span class="function">isCombo</span>(<span class="string">'ControlLeft'</span>, <span class="string">'ShiftLeft'</span>, <span class="string">'KeyS'</span>)) {
  <span class="function">saveDocument</span>();
}`
        }
      },
      {
        type: 'math',
        question: 'In binary, what is 1010 + 0110?',
        options: ['1100', '10000', '1110', '1111'],
        answer: 1,
        hint: '1010 is 10 in decimal, 0110 is 6...',
        code: {
          title: 'Binary Operations',
          file: 'core/binary.js',
          content: `<span class="comment">// Binary manipulation utilities</span>
<span class="keyword">const</span> Binary = {
  <span class="function">toBin</span>: n <span class="operator">=></span> (n <span class="operator">>>></span> <span class="number">0</span>).<span class="function">toString</span>(<span class="number">2</span>),
  <span class="function">toDec</span>: s <span class="operator">=></span> <span class="function">parseInt</span>(s, <span class="number">2</span>),

  <span class="comment">// Bit manipulation</span>
  <span class="function">setBit</span>: (n, pos) <span class="operator">=></span> n <span class="operator">|</span> (<span class="number">1</span> <span class="operator"><<</span> pos),
  <span class="function">clearBit</span>: (n, pos) <span class="operator">=></span> n <span class="operator">&</span> <span class="operator">~</span>(<span class="number">1</span> <span class="operator"><<</span> pos),
  <span class="function">toggleBit</span>: (n, pos) <span class="operator">=></span> n <span class="operator">^</span> (<span class="number">1</span> <span class="operator"><<</span> pos),
  <span class="function">checkBit</span>: (n, pos) <span class="operator">=></span> <span class="operator">!!</span>(n <span class="operator">&</span> (<span class="number">1</span> <span class="operator"><<</span> pos))
};

<span class="comment">// 1010 + 0110 = 10000 (10 + 6 = 16)</span>`
        }
      },
      {
        type: 'code',
        question: 'What\'s the value of x? let x = (1, 2, 3);',
        options: ['1', '2', '3', '[1, 2, 3]'],
        answer: 2,
        hint: 'The comma operator evaluates each expression and returns the last one...',
        code: {
          title: 'Comma Operator',
          file: 'quirks/comma.js',
          content: `<span class="comment">// The comma operator - rarely used but powerful</span>
<span class="keyword">let</span> x = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>); <span class="comment">// x = 3</span>

<span class="comment">// Useful in for loops for multiple updates</span>
<span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, j = <span class="number">10</span>; i <span class="operator"><</span> j; i<span class="operator">++</span>, j<span class="operator">--</span>) {
  console.<span class="function">log</span>(i, j);
}

<span class="comment">// Or in arrow functions without braces</span>
<span class="keyword">const</span> <span class="function">sideEffect</span> = x <span class="operator">=></span> (console.<span class="function">log</span>(x), x <span class="operator">*</span> <span class="number">2</span>);
<span class="comment">// Logs x, then returns x * 2</span>`
        }
      },
      {
        type: 'pattern',
        question: 'What comes next? ðŸ”´ðŸ”µðŸ”´ðŸ”µðŸ”µðŸ”´ðŸ”µðŸ”µðŸ”µðŸ”´?',
        options: ['ðŸ”µ', 'ðŸ”´', 'ðŸ”µðŸ”µ', 'ðŸ”µðŸ”µðŸ”µðŸ”µ'],
        answer: 3,
        hint: 'Count the blues after each red...',
        code: {
          title: 'Pattern Generator',
          file: 'visual/patterns.js',
          content: `<span class="comment">// Growing pattern generator</span>
<span class="keyword">function</span>* <span class="function">growingPattern</span>(a, b) {
  <span class="keyword">let</span> count = <span class="number">1</span>;
  <span class="keyword">while</span> (<span class="keyword">true</span>) {
    <span class="keyword">yield</span> a;
    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i <span class="operator"><</span> count; i<span class="operator">++</span>) {
      <span class="keyword">yield</span> b;
    }
    count<span class="operator">++</span>;
  }
}

<span class="keyword">const</span> circles = <span class="function">growingPattern</span>(<span class="string">'ðŸ”´'</span>, <span class="string">'ðŸ”µ'</span>);
<span class="comment">// ðŸ”´ðŸ”µ ðŸ”´ðŸ”µðŸ”µ ðŸ”´ðŸ”µðŸ”µðŸ”µ ðŸ”´ðŸ”µðŸ”µðŸ”µðŸ”µ ...</span>`
        }
      },
      {
        type: 'logic',
        question: 'What\'s the result? !!"false" == !!"true"',
        options: ['true', 'false', 'TypeError', 'undefined'],
        answer: 0,
        hint: 'Any non-empty string is truthy...',
        code: {
          title: 'Boolean Coercion',
          file: 'core/boolean.js',
          content: `<span class="comment">// JavaScript truthiness deep dive</span>
<span class="keyword">const</span> falsy = [<span class="number">0</span>, <span class="string">''</span>, <span class="keyword">null</span>, <span class="keyword">undefined</span>, <span class="keyword">NaN</span>, <span class="keyword">false</span>];
<span class="keyword">const</span> truthy = [<span class="number">1</span>, <span class="string">'0'</span>, [], {}, <span class="string">'false'</span>, <span class="keyword">new</span> Boolean(<span class="keyword">false</span>)];

<span class="comment">// Double-bang converts to boolean</span>
<span class="operator">!!</span><span class="string">"false"</span> <span class="comment">// true (non-empty string)</span>
<span class="operator">!!</span><span class="string">"true"</span>  <span class="comment">// true (non-empty string)</span>
<span class="keyword">true</span> <span class="operator">==</span> <span class="keyword">true</span> <span class="comment">// true!</span>

<span class="comment">// Gotcha: "false" as a string is truthy!</span>
<span class="keyword">if</span> (<span class="string">"false"</span>) console.<span class="function">log</span>(<span class="string">"This prints!"</span>);`
        }
      }
    ];

    let currentPuzzle = 0;
    let solved = new Set();
    let showingHint = false;

    function renderPuzzle() {
      if (currentPuzzle >= puzzles.length) {
        document.getElementById('puzzleContainer').innerHTML = '';
        document.getElementById('completeScreen').classList.add('visible');
        return;
      }

      const puzzle = puzzles[currentPuzzle];
      const container = document.getElementById('puzzleContainer');

      let inputHtml = '';
      if (puzzle.inputType === 'text') {
        inputHtml = `<input type="text" class="puzzle-input" id="puzzleInput" placeholder="Type your answer...">`;
      } else {
        inputHtml = `<div class="puzzle-options">
          ${puzzle.options.map((opt, i) => `
            <button class="puzzle-option" data-index="${i}">${opt}</button>
          `).join('')}
        </div>`;
      }

      container.innerHTML = `
        <div class="puzzle-card">
          <div class="puzzle-header">
            <span class="puzzle-type">${puzzle.type}</span>
            <span class="puzzle-number">Puzzle ${currentPuzzle + 1} of ${puzzles.length}</span>
          </div>

          <div class="encrypted-preview">
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
          </div>

          <p class="puzzle-question">${puzzle.question}</p>

          <div class="hint-text" id="hintText">${puzzle.hint}</div>

          ${inputHtml}

          <button class="submit-btn" id="submitBtn">Decrypt Code</button>
          <button class="hint-btn" id="hintBtn">Need a hint?</button>

          <div class="code-reward" id="codeReward">
            <div class="reward-header">
              <span>ðŸ”“</span>
              <span class="reward-title">Code Unlocked: ${puzzle.code.title}</span>
            </div>
            <div class="code-block">
              <div class="code-header">
                <span>${puzzle.code.file}</span>
                <span>JavaScript</span>
              </div>
              <div class="code-content">${puzzle.code.content}</div>
            </div>
            <button class="next-btn" id="nextBtn">Next Puzzle â†’</button>
          </div>
        </div>
      `;

      // Event listeners
      if (puzzle.inputType === 'text') {
        document.getElementById('puzzleInput').addEventListener('keypress', (e) => {
          if (e.key === 'Enter') checkAnswer();
        });
      } else {
        document.querySelectorAll('.puzzle-option').forEach(btn => {
          btn.addEventListener('click', () => {
            document.querySelectorAll('.puzzle-option').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
          });
        });
      }

      document.getElementById('submitBtn').addEventListener('click', checkAnswer);
      document.getElementById('hintBtn').addEventListener('click', () => {
        document.getElementById('hintText').classList.toggle('visible');
      });
    }

    function checkAnswer() {
      const puzzle = puzzles[currentPuzzle];
      let isCorrect = false;
      let userAnswer;

      if (puzzle.inputType === 'text') {
        userAnswer = document.getElementById('puzzleInput').value.trim().toLowerCase();
        isCorrect = userAnswer === puzzle.answer.toLowerCase();
      } else {
        const selected = document.querySelector('.puzzle-option.selected');
        if (!selected) return;
        userAnswer = parseInt(selected.dataset.index);
        isCorrect = userAnswer === puzzle.answer;

        // Show correct/wrong styling
        document.querySelectorAll('.puzzle-option').forEach((btn, i) => {
          if (i === puzzle.answer) btn.classList.add('correct');
          else if (i === userAnswer) btn.classList.add('wrong');
        });
      }

      if (isCorrect) {
        solved.add(currentPuzzle);
        updateProgress();
        document.getElementById('codeReward').classList.add('visible');
        document.getElementById('submitBtn').disabled = true;
        document.getElementById('hintBtn').style.display = 'none';

        document.getElementById('nextBtn').addEventListener('click', () => {
          currentPuzzle++;
          renderPuzzle();
        });
      } else {
        // Shake effect for wrong answer
        const card = document.querySelector('.puzzle-card');
        card.style.animation = 'none';
        card.offsetHeight;
        card.style.animation = 'shake 0.5s ease';
      }
    }

    function updateProgress() {
      const pct = (solved.size / puzzles.length) * 100;
      document.getElementById('progressFill').style.width = pct + '%';
      document.getElementById('progressText').textContent = `${solved.size} / ${puzzles.length}`;
    }

    function showAllCode() {
      const container = document.getElementById('puzzleContainer');
      container.innerHTML = puzzles.map((p, i) => `
        <div class="puzzle-card">
          <div class="reward-header">
            <span>ðŸ”“</span>
            <span class="reward-title">${p.code.title}</span>
          </div>
          <div class="code-block">
            <div class="code-header">
              <span>${p.code.file}</span>
              <span>JavaScript</span>
            </div>
            <div class="code-content">${p.code.content}</div>
          </div>
        </div>
      `).join('');
      document.getElementById('completeScreen').classList.remove('visible');
    }

    // Add shake animation
    const style = document.createElement('style');
    style.textContent = `
      @keyframes shake {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-10px); }
        75% { transform: translateX(10px); }
      }
    `;
    document.head.appendChild(style);

    // Initialize
    renderPuzzle();
  </script>
<script src="/sloppy-header/sloppy-bar.js"></script>
</body>
</html>
