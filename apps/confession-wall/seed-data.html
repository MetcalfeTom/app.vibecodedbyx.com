<!DOCTYPE html>
<html>
<head>
    <title>Seed Confession Wall</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.39.0/dist/umd/supabase.js"></script>
</head>
<body>
    <h1>Adding Sample Confessions...</h1>
    <div id="status"></div>

    <script>
        // Initialize Supabase
        const SUPABASE_URL = 'https://yjyxteqzhhmtrgcaekgz.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlqeXh0ZXF6aGhtdHJnY2Fla2d6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTczNTg3NDIsImV4cCI6MjA3MjkzNDc0Mn0.G8SRde7IN2QFW1EnASM8IS32IUYR2eenCCjdDdioiBU';

        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        const sampleConfessions = [
            {
                content: "I started learning to code at 30 and finally landed my dream job. It's never too late to chase your dreams!",
                theme: "dreams",
                likes: 15
            },
            {
                content: "I've been pretending to like coffee for years just to fit in at work meetings. I actually prefer tea.",
                theme: "work",
                likes: 8
            },
            {
                content: "I told my family I'm too busy to visit, but really I'm just anxious about seeing them after so long.",
                theme: "family",
                likes: 23
            },
            {
                content: "Sometimes I dance in my room alone and pretend I'm performing at a sold-out concert.",
                theme: "general",
                likes: 12
            },
            {
                content: "I've been in love with my best friend for 3 years but I'm too scared to tell them.",
                theme: "love",
                likes: 31
            },
            {
                content: "I keep all the handwritten notes my grandmother left me in a special box. I read them when I miss her.",
                theme: "family",
                likes: 19
            },
            {
                content: "I quit my toxic job without having another one lined up. Scariest and best decision I've ever made.",
                theme: "work",
                likes: 27
            },
            {
                content: "I wish I had told my friend how much they meant to me before they moved away. Now it feels too late.",
                theme: "regret",
                likes: 16
            },
            {
                content: "I've been writing a novel for 2 years but I'm too scared to show it to anyone. What if it's terrible?",
                theme: "dreams",
                likes: 22
            },
            {
                content: "I bought my mom flowers just because, and seeing her smile made my entire week.",
                theme: "family",
                likes: 34
            }
        ];

        async function seedData() {
            const status = document.getElementById('status');

            try {
                // Sign in anonymously first
                const { data: authData, error: authError } = await supabase.auth.signInAnonymously();
                if (authError) throw authError;

                status.innerHTML += '<p>‚úÖ Authenticated successfully</p>';

                for (let i = 0; i < sampleConfessions.length; i++) {
                    const confession = sampleConfessions[i];

                    const { data, error } = await supabase
                        .from('confessions')
                        .insert({
                            content: confession.content,
                            theme: confession.theme,
                            likes: confession.likes,
                            is_approved: true,
                            user_id: authData.user.id
                        });

                    if (error) {
                        console.error('Error inserting confession:', error);
                        status.innerHTML += `<p>‚ùå Error with confession ${i + 1}: ${error.message}</p>`;
                    } else {
                        status.innerHTML += `<p>‚úÖ Added confession ${i + 1}</p>`;
                    }

                    // Small delay between insertions
                    await new Promise(resolve => setTimeout(resolve, 100));
                }

                status.innerHTML += '<p><strong>üéâ All sample confessions added successfully!</strong></p>';
                status.innerHTML += '<p><a href="index.html">Go to Confession Wall</a></p>';

            } catch (error) {
                console.error('Error:', error);
                status.innerHTML += `<p>‚ùå Error: ${error.message}</p>`;
            }
        }

        // Run when page loads
        window.addEventListener('load', seedData);
    </script>
</body>
</html>