<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claude Chat - AI Assistant</title>
    <link rel="icon" href="https://emojicdn.elk.sh/ü§ñ">

    <!-- Open Graph meta tags -->
    <meta property="og:title" content="Claude Chat - AI Assistant">
    <meta property="og:description" content="Chat with Claude, Anthropic's AI assistant. Get help with coding, writing, analysis, and more!">
    <meta property="og:url" content="https://app.vibecodedbyx.com/claude/">
    <meta property="og:image" content="https://app.vibecodedbyx.com/claude/og-image.png">
    <meta property="og:type" content="website">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            height: 100vh;
            overflow: hidden;
        }

        .container {
            display: flex;
            flex-direction: column;
            height: 100vh;
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 0 50px rgba(0, 0, 0, 0.1);
        }

        .header {
            background: #2563eb;
            color: white;
            padding: 1rem;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .header .subtitle {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-top: 0.25rem;
        }

        .livestream-link {
            position: absolute;
            top: 1rem;
            right: 1rem;
            color: white;
            text-decoration: none;
            font-size: 0.8rem;
            opacity: 0.8;
            transition: opacity 0.2s;
        }

        .livestream-link:hover {
            opacity: 1;
        }

        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            background: #f8fafc;
        }

        .message {
            margin-bottom: 1rem;
            display: flex;
            gap: 0.75rem;
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            flex-shrink: 0;
        }

        .message.user .message-avatar {
            background: #2563eb;
            color: white;
        }

        .message.assistant .message-avatar {
            background: #059669;
            color: white;
        }

        .message-content {
            background: white;
            border-radius: 12px;
            padding: 0.75rem 1rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            max-width: 70%;
            word-wrap: break-word;
        }

        .message.user .message-content {
            background: #2563eb;
            color: white;
        }

        .input-container {
            padding: 1rem;
            background: white;
            border-top: 1px solid #e5e7eb;
            display: flex;
            gap: 0.5rem;
        }

        .message-input {
            flex: 1;
            padding: 0.75rem 1rem;
            border: 1px solid #d1d5db;
            border-radius: 8px;
            font-size: 1rem;
            resize: none;
            min-height: 44px;
            max-height: 120px;
        }

        .message-input:focus {
            outline: none;
            border-color: #2563eb;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .send-button {
            padding: 0.75rem 1.5rem;
            background: #2563eb;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s;
            align-self: flex-end;
        }

        .send-button:hover:not(:disabled) {
            background: #1d4ed8;
        }

        .send-button:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }

        .typing-indicator {
            display: none;
            align-items: center;
            gap: 0.5rem;
            color: #6b7280;
            font-style: italic;
            margin-bottom: 1rem;
        }

        .typing-dots {
            display: flex;
            gap: 2px;
        }

        .typing-dot {
            width: 6px;
            height: 6px;
            background: #6b7280;
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }

        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }

        .error-message {
            background: #fef2f2;
            color: #dc2626;
            padding: 0.75rem 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            border: 1px solid #fecaca;
        }

        @media (max-width: 768px) {
            .container {
                height: 100vh;
            }

            .livestream-link {
                position: static;
                display: block;
                margin-top: 0.5rem;
            }

            .message-content {
                max-width: 85%;
            }

            .input-container {
                padding: 0.75rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="https://www.vibecodedbyx.com" class="livestream-link">‚Üê Back to Stream</a>
            <h1>ü§ñ Claude Chat</h1>
            <div class="subtitle">Your AI Assistant</div>
        </div>

        <div class="chat-container" id="chatContainer">
            <div class="message assistant">
                <div class="message-avatar">ü§ñ</div>
                <div class="message-content">
                    Hello! I'm Claude, your AI assistant. I can help you with coding, writing, analysis, math, and much more. What would you like to talk about?
                </div>
            </div>
        </div>

        <div class="typing-indicator" id="typingIndicator">
            <div class="message-avatar">ü§ñ</div>
            <span>Claude is typing</span>
            <div class="typing-dots">
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            </div>
        </div>

        <div class="input-container">
            <textarea
                id="messageInput"
                class="message-input"
                placeholder="Type your message here..."
                rows="1"
            ></textarea>
            <button id="sendButton" class="send-button">Send</button>
        </div>
    </div>

    <script type="module">
        import { createClient } from 'https://esm.sh/@supabase/supabase-js@2'

        // Initialize Supabase client
        const supabase = createClient(
            'https://nrpzjebqljdcsmyqjfpx.supabase.co',
            'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5ycHpqZWJxbGpkY3NteXFqZnB4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzI3NDI3MjAsImV4cCI6MjA0ODMxODcyMH0.Dqb6HJhWG9MfhHTK8vWhZMH_p_xvGlFZgRPsD6kjjPg'
        )

        const chatContainer = document.getElementById('chatContainer')
        const messageInput = document.getElementById('messageInput')
        const sendButton = document.getElementById('sendButton')
        const typingIndicator = document.getElementById('typingIndicator')

        let currentUser = null

        // Initialize auth
        async function initAuth() {
            try {
                const { data: { session } } = await supabase.auth.getSession()

                if (!session) {
                    // Sign in anonymously
                    const { data, error } = await supabase.auth.signInAnonymously()
                    if (error) throw error
                    currentUser = data.user
                } else {
                    currentUser = session.user
                }

                loadChatHistory()
            } catch (error) {
                console.error('Auth error:', error)
                showError('Failed to initialize authentication')
            }
        }

        // Load chat history from database
        async function loadChatHistory() {
            try {
                const { data, error } = await supabase
                    .from('claude_messages')
                    .select('*')
                    .eq('user_id', currentUser.id)
                    .order('created_at', { ascending: true })
                    .limit(50)

                if (error) throw error

                // Clear container except welcome message
                const welcomeMessage = chatContainer.querySelector('.message.assistant')
                chatContainer.innerHTML = ''
                chatContainer.appendChild(welcomeMessage)

                // Add messages from history
                data.forEach(message => {
                    addMessage(message.content, message.role, false)
                })

                scrollToBottom()
            } catch (error) {
                console.error('Failed to load chat history:', error)
            }
        }

        // Save message to database
        async function saveMessage(content, role) {
            try {
                const { error } = await supabase
                    .from('claude_messages')
                    .insert([
                        {
                            user_id: currentUser.id,
                            content: content,
                            role: role
                        }
                    ])

                if (error) throw error
            } catch (error) {
                console.error('Failed to save message:', error)
            }
        }

        // Add message to chat
        function addMessage(content, role, save = true) {
            const messageDiv = document.createElement('div')
            messageDiv.className = `message ${role}`

            const avatar = document.createElement('div')
            avatar.className = 'message-avatar'
            avatar.textContent = role === 'user' ? 'üë§' : 'ü§ñ'

            const messageContent = document.createElement('div')
            messageContent.className = 'message-content'
            messageContent.textContent = content

            messageDiv.appendChild(avatar)
            messageDiv.appendChild(messageContent)

            chatContainer.appendChild(messageDiv)
            scrollToBottom()

            if (save) {
                saveMessage(content, role)
            }
        }

        // Show error message
        function showError(message) {
            const errorDiv = document.createElement('div')
            errorDiv.className = 'error-message'
            errorDiv.textContent = message
            chatContainer.appendChild(errorDiv)
            scrollToBottom()
        }

        // Simulate Claude response (placeholder)
        async function getClaude Response(userMessage) {
            // This is a placeholder - in a real app you'd integrate with Claude's API
            const responses = [
                "I understand your question. This is a demo response since I don't have access to the actual Claude API in this environment.",
                "That's an interesting point! In a real implementation, I would provide a thoughtful and helpful response.",
                "I'd be happy to help with that. This Claude chat interface is working correctly - you're seeing a simulated response.",
                "Great question! This demo shows how the chat interface works. In production, this would connect to Claude's actual API.",
                "I'm here to assist you. This response is simulated, but the chat interface is fully functional and ready for API integration."
            ]

            // Add some variety based on message content
            if (userMessage.toLowerCase().includes('code') || userMessage.toLowerCase().includes('programming')) {
                return "I'd love to help you with coding! This is a demo response, but in the real version I could assist with programming questions, debugging, code reviews, and more."
            }

            if (userMessage.toLowerCase().includes('hello') || userMessage.toLowerCase().includes('hi')) {
                return "Hello there! Nice to meet you. This chat interface is working perfectly - I'm just showing you a demo response since we're not connected to the real Claude API yet."
            }

            return responses[Math.floor(Math.random() * responses.length)]
        }

        // Send message
        async function sendMessage() {
            const message = messageInput.value.trim()
            if (!message) return

            // Disable input
            messageInput.disabled = true
            sendButton.disabled = true
            messageInput.value = ''

            // Add user message
            addMessage(message, 'user')

            // Show typing indicator
            typingIndicator.style.display = 'flex'
            scrollToBottom()

            try {
                // Simulate thinking time
                await new Promise(resolve => setTimeout(resolve, 1000 + Math.random() * 2000))

                const response = await getClaude Response(message)

                // Hide typing indicator
                typingIndicator.style.display = 'none'

                // Add Claude response
                addMessage(response, 'assistant')

            } catch (error) {
                typingIndicator.style.display = 'none'
                showError('Sorry, I encountered an error. Please try again.')
                console.error('Error:', error)
            } finally {
                // Re-enable input
                messageInput.disabled = false
                sendButton.disabled = false
                messageInput.focus()
            }
        }

        // Scroll to bottom
        function scrollToBottom() {
            chatContainer.scrollTop = chatContainer.scrollHeight
        }

        // Auto-resize textarea
        function autoResize() {
            messageInput.style.height = 'auto'
            messageInput.style.height = Math.min(messageInput.scrollHeight, 120) + 'px'
        }

        // Event listeners
        sendButton.addEventListener('click', sendMessage)

        messageInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault()
                sendMessage()
            }
        })

        messageInput.addEventListener('input', autoResize)

        // Initialize the app
        initAuth()
    </script>
</body>
</html>