<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>NYE Vibe - New Year's Eve Party</title>
  <link rel="icon" href="https://emojicdn.elk.sh/üéâ">
  <meta name="description" content="You're the guest of honor at the ultimate virtual NYE party!">
  <meta property="og:title" content="NYE Vibe">
  <meta property="og:description" content="Virtual New Year's Eve party - you're the VIP!">
  <meta property="og:url" content="https://app.sloppy.live/nye-vibe">
  <meta property="og:image" content="https://app.sloppy.live/nye-vibe/og-image.png">
  <meta property="og:type" content="website">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;800;900&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      background: linear-gradient(135deg, #0a0a1a 0%, #1a0a2e 50%, #0a1a2e 100%);
      font-family: 'Inter', sans-serif;
      min-height: 100vh;
      overflow-x: hidden;
      color: #fff;
    }
    .party-bg {
      position: fixed;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
    }
    .disco-ball {
      position: absolute;
      top: -50px;
      left: 50%;
      transform: translateX(-50%);
      width: 120px;
      height: 120px;
      background: radial-gradient(circle at 30% 30%, #fff, #888, #444);
      border-radius: 50%;
      box-shadow: 0 0 60px rgba(255, 255, 255, 0.3);
      animation: disco 4s linear infinite;
    }
    @keyframes disco {
      from { transform: translateX(-50%) rotate(0deg); }
      to { transform: translateX(-50%) rotate(360deg); }
    }
    .light-beam {
      position: absolute;
      width: 4px;
      height: 300px;
      background: linear-gradient(to bottom, rgba(255,255,255,0.4), transparent);
      top: 70px;
      left: 50%;
      transform-origin: top center;
      animation: beam 3s ease-in-out infinite;
      filter: blur(2px);
    }
    .light-beam:nth-child(2) { animation-delay: -0.5s; }
    .light-beam:nth-child(3) { animation-delay: -1s; }
    .light-beam:nth-child(4) { animation-delay: -1.5s; }
    .light-beam:nth-child(5) { animation-delay: -2s; }
    @keyframes beam {
      0%, 100% { transform: rotate(-30deg); opacity: 0.3; }
      50% { transform: rotate(30deg); opacity: 0.6; }
    }
    .container {
      position: relative;
      z-index: 10;
      max-width: 900px;
      margin: 0 auto;
      padding: 20px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    .vip-banner {
      text-align: center;
      padding: 15px;
      background: linear-gradient(90deg, transparent, rgba(255, 215, 0, 0.2), transparent);
      border-top: 1px solid rgba(255, 215, 0, 0.3);
      border-bottom: 1px solid rgba(255, 215, 0, 0.3);
      margin-bottom: 30px;
    }
    .vip-text {
      font-size: 14px;
      color: #ffd700;
      text-transform: uppercase;
      letter-spacing: 3px;
      font-weight: 600;
    }
    .countdown-section {
      text-align: center;
      padding: 40px 20px;
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    .countdown-label {
      font-size: 16px;
      color: rgba(255, 255, 255, 0.7);
      text-transform: uppercase;
      letter-spacing: 2px;
      margin-bottom: 20px;
    }
    .countdown {
      display: flex;
      justify-content: center;
      gap: 15px;
      flex-wrap: wrap;
      margin-bottom: 30px;
    }
    .countdown-unit {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 16px;
      padding: 20px 25px;
      min-width: 90px;
    }
    .countdown-value {
      font-family: 'Playfair Display', serif;
      font-size: clamp(36px, 8vw, 56px);
      font-weight: 900;
      background: linear-gradient(135deg, #fff, #ffd700);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      line-height: 1;
    }
    .countdown-name {
      font-size: 11px;
      color: rgba(255, 255, 255, 0.6);
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-top: 8px;
    }
    .year-display {
      font-family: 'Playfair Display', serif;
      font-size: clamp(80px, 20vw, 200px);
      font-weight: 900;
      background: linear-gradient(135deg, #ffd700, #ff6b9d, #a855f7, #00d4ff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 0 0 80px rgba(255, 215, 0, 0.3);
      animation: glow 2s ease-in-out infinite alternate;
      display: none;
    }
    @keyframes glow {
      from { filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.5)); }
      to { filter: drop-shadow(0 0 40px rgba(255, 107, 157, 0.5)); }
    }
    .guests-section {
      padding: 20px;
    }
    .section-title {
      font-size: 13px;
      color: rgba(255, 255, 255, 0.5);
      text-transform: uppercase;
      letter-spacing: 2px;
      margin-bottom: 15px;
    }
    .guests-row {
      display: flex;
      gap: 15px;
      overflow-x: auto;
      padding-bottom: 10px;
      scrollbar-width: none;
    }
    .guests-row::-webkit-scrollbar {
      display: none;
    }
    .guest {
      flex-shrink: 0;
      text-align: center;
      animation: float 3s ease-in-out infinite;
    }
    .guest:nth-child(2) { animation-delay: -0.5s; }
    .guest:nth-child(3) { animation-delay: -1s; }
    .guest:nth-child(4) { animation-delay: -1.5s; }
    .guest:nth-child(5) { animation-delay: -2s; }
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-8px); }
    }
    .guest-avatar {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: linear-gradient(135deg, #ff6b9d, #a855f7);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      margin-bottom: 8px;
      border: 2px solid rgba(255, 255, 255, 0.3);
    }
    .guest-name {
      font-size: 12px;
      color: rgba(255, 255, 255, 0.8);
    }
    .guest-status {
      font-size: 10px;
      color: #ffd700;
    }
    .chat-section {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 16px;
      padding: 20px;
      margin: 20px 0;
      max-height: 200px;
      overflow-y: auto;
    }
    .chat-message {
      display: flex;
      gap: 10px;
      margin-bottom: 12px;
      animation: slideIn 0.3s ease;
    }
    @keyframes slideIn {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }
    .chat-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: linear-gradient(135deg, #00d4ff, #a855f7);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 16px;
      flex-shrink: 0;
    }
    .chat-content {
      flex: 1;
    }
    .chat-name {
      font-size: 12px;
      font-weight: 600;
      color: #ffd700;
      margin-bottom: 2px;
    }
    .chat-text {
      font-size: 13px;
      color: rgba(255, 255, 255, 0.9);
      line-height: 1.4;
    }
    .toast-btn {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      background: linear-gradient(135deg, #ffd700, #ff6b9d);
      border: none;
      border-radius: 50px;
      padding: 18px 40px;
      color: #000;
      font-family: 'Inter', sans-serif;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 10px 40px rgba(255, 215, 0, 0.4);
      transition: all 0.3s;
      z-index: 100;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .toast-btn:hover {
      transform: translateX(-50%) scale(1.05);
      box-shadow: 0 15px 50px rgba(255, 215, 0, 0.5);
    }
    .toast-btn:active {
      transform: translateX(-50%) scale(0.98);
    }
    .toast-btn .icon {
      font-size: 20px;
    }
    .confetti {
      position: fixed;
      pointer-events: none;
      z-index: 1000;
    }
    .toast-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.8);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 500;
    }
    .toast-overlay.visible {
      display: flex;
    }
    .toast-modal {
      text-align: center;
      padding: 40px;
      animation: toastPop 0.5s ease;
    }
    @keyframes toastPop {
      0% { transform: scale(0.5); opacity: 0; }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); opacity: 1; }
    }
    .toast-glass {
      font-size: 120px;
      display: block;
      margin-bottom: 20px;
      animation: clink 0.5s ease 0.3s;
    }
    @keyframes clink {
      0%, 100% { transform: rotate(0deg); }
      25% { transform: rotate(-15deg); }
      75% { transform: rotate(15deg); }
    }
    .toast-message {
      font-family: 'Playfair Display', serif;
      font-size: 32px;
      font-weight: 700;
      color: #ffd700;
      margin-bottom: 10px;
    }
    .toast-sub {
      font-size: 16px;
      color: rgba(255, 255, 255, 0.8);
    }
    .celebration {
      display: none;
    }
    .celebration.active {
      display: block;
    }
    .firework {
      position: fixed;
      pointer-events: none;
    }
    .backlink {
      position: fixed;
      bottom: 10px;
      right: 15px;
      color: rgba(255, 255, 255, 0.3);
      font-size: 11px;
      text-decoration: none;
      z-index: 10;
    }
    .backlink:hover {
      color: #ffd700;
    }
    .sound-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 20px;
      z-index: 100;
      transition: all 0.2s;
    }
    .sound-btn:hover {
      background: rgba(255, 255, 255, 0.2);
    }
    .dance-btn {
      position: fixed;
      bottom: 30px;
      right: 20px;
      background: linear-gradient(135deg, #a855f7, #ff6b9d);
      border: none;
      border-radius: 50px;
      padding: 14px 24px;
      color: #fff;
      font-family: 'Inter', sans-serif;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 8px 30px rgba(168, 85, 247, 0.4);
      transition: all 0.3s;
      z-index: 100;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .dance-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 12px 40px rgba(168, 85, 247, 0.5);
    }
    .dance-btn.active {
      background: linear-gradient(135deg, #ff6b9d, #ffd700);
      animation: dancePulse 0.5s ease-in-out infinite alternate;
    }
    @keyframes dancePulse {
      from { box-shadow: 0 8px 30px rgba(255, 107, 157, 0.4); }
      to { box-shadow: 0 15px 50px rgba(255, 215, 0, 0.6); }
    }
    .chat-section.hidden {
      display: none;
    }
    /* Intense dance mode */
    body.dance-mode .light-beam {
      width: 8px;
      height: 500px;
      animation: beamIntense 0.5s ease-in-out infinite;
      filter: blur(3px);
    }
    body.dance-mode .light-beam:nth-child(2) { animation-delay: -0.1s; background: linear-gradient(to bottom, rgba(255, 107, 157, 0.6), transparent); }
    body.dance-mode .light-beam:nth-child(3) { animation-delay: -0.2s; background: linear-gradient(to bottom, rgba(168, 85, 247, 0.6), transparent); }
    body.dance-mode .light-beam:nth-child(4) { animation-delay: -0.3s; background: linear-gradient(to bottom, rgba(0, 212, 255, 0.6), transparent); }
    body.dance-mode .light-beam:nth-child(5) { animation-delay: -0.4s; background: linear-gradient(to bottom, rgba(255, 215, 0, 0.6), transparent); }
    @keyframes beamIntense {
      0% { transform: rotate(-45deg); opacity: 0.8; }
      50% { transform: rotate(45deg); opacity: 1; }
      100% { transform: rotate(-45deg); opacity: 0.8; }
    }
    body.dance-mode .disco-ball {
      animation: discoIntense 0.5s linear infinite;
      box-shadow: 0 0 100px rgba(255, 255, 255, 0.5), 0 0 200px rgba(168, 85, 247, 0.3);
    }
    @keyframes discoIntense {
      from { transform: translateX(-50%) rotate(0deg) scale(1); }
      50% { transform: translateX(-50%) rotate(180deg) scale(1.1); }
      to { transform: translateX(-50%) rotate(360deg) scale(1); }
    }
    .extra-beam {
      position: absolute;
      width: 6px;
      height: 400px;
      top: 70px;
      left: 50%;
      transform-origin: top center;
      filter: blur(4px);
      opacity: 0;
      transition: opacity 0.3s;
    }
    body.dance-mode .extra-beam {
      opacity: 1;
      animation: beamIntense 0.4s ease-in-out infinite;
    }
    .extra-beam:nth-child(6) { background: linear-gradient(to bottom, rgba(0, 255, 136, 0.5), transparent); animation-delay: -0.05s; }
    .extra-beam:nth-child(7) { background: linear-gradient(to bottom, rgba(255, 87, 87, 0.5), transparent); animation-delay: -0.15s; }
    .extra-beam:nth-child(8) { background: linear-gradient(to bottom, rgba(87, 255, 255, 0.5), transparent); animation-delay: -0.25s; }
    .extra-beam:nth-child(9) { background: linear-gradient(to bottom, rgba(255, 255, 87, 0.5), transparent); animation-delay: -0.35s; }
    body.dance-mode {
      animation: bgPulse 1s ease-in-out infinite alternate;
    }
    @keyframes bgPulse {
      from { background: linear-gradient(135deg, #0a0a1a 0%, #1a0a2e 50%, #0a1a2e 100%); }
      to { background: linear-gradient(135deg, #1a0a2e 0%, #2a0a3e 50%, #0a2a3e 100%); }
    }
    .dance-overlay {
      position: fixed;
      inset: 0;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.5s;
      z-index: 5;
    }
    body.dance-mode .dance-overlay {
      opacity: 1;
      animation: strobeOverlay 0.3s steps(1) infinite;
    }
    @keyframes strobeOverlay {
      0% { background: rgba(168, 85, 247, 0.05); }
      33% { background: rgba(255, 107, 157, 0.05); }
      66% { background: rgba(0, 212, 255, 0.05); }
    }
    .fireworks-btn {
      position: fixed;
      bottom: 30px;
      left: 20px;
      background: linear-gradient(135deg, #ff5757, #ffa500);
      border: none;
      border-radius: 50px;
      padding: 14px 24px;
      color: #fff;
      font-family: 'Inter', sans-serif;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 8px 30px rgba(255, 87, 87, 0.4);
      transition: all 0.3s;
      z-index: 100;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .fireworks-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 12px 40px rgba(255, 87, 87, 0.5);
    }
    .fireworks-btn:active {
      transform: scale(0.98);
    }
    .firework-particle {
      position: fixed;
      pointer-events: none;
      z-index: 1000;
      border-radius: 50%;
    }
    .firework-trail {
      position: fixed;
      pointer-events: none;
      z-index: 999;
      width: 4px;
      background: linear-gradient(to top, transparent, #ffd700);
      border-radius: 2px;
    }
    .firework-spark {
      position: fixed;
      pointer-events: none;
      z-index: 1000;
      border-radius: 50%;
    }
    .firework-glow {
      position: fixed;
      pointer-events: none;
      z-index: 998;
      border-radius: 50%;
      filter: blur(20px);
    }
  </style>
</head>
<body>
  <div class="party-bg">
    <div class="disco-ball"></div>
    <div class="light-beam"></div>
    <div class="light-beam"></div>
    <div class="light-beam"></div>
    <div class="light-beam"></div>
    <div class="light-beam"></div>
    <div class="extra-beam"></div>
    <div class="extra-beam"></div>
    <div class="extra-beam"></div>
    <div class="extra-beam"></div>
  </div>
  <div class="dance-overlay"></div>

  <button class="sound-btn" id="soundBtn" title="Toggle Sound">üîä</button>

  <div class="container">
    <div class="vip-banner">
      <span class="vip-text">‚ú® You're the Guest of Honor Tonight ‚ú®</span>
    </div>

    <div class="countdown-section">
      <div class="countdown-label">Countdown to <span id="yearLabel">2026</span></div>
      <div class="countdown" id="countdown">
        <div class="countdown-unit">
          <div class="countdown-value" id="days">00</div>
          <div class="countdown-name">Days</div>
        </div>
        <div class="countdown-unit">
          <div class="countdown-value" id="hours">00</div>
          <div class="countdown-name">Hours</div>
        </div>
        <div class="countdown-unit">
          <div class="countdown-value" id="minutes">00</div>
          <div class="countdown-name">Minutes</div>
        </div>
        <div class="countdown-unit">
          <div class="countdown-value" id="seconds">00</div>
          <div class="countdown-name">Seconds</div>
        </div>
      </div>
      <div class="year-display" id="yearDisplay">2026</div>
    </div>

    <div class="guests-section">
      <div class="section-title">Party Guests</div>
      <div class="guests-row" id="guestsRow"></div>
    </div>

    <div class="chat-section" id="chatSection">
      <div class="section-title">Party Chat</div>
      <div id="chatMessages"></div>
    </div>
  </div>

  <button class="toast-btn" id="toastBtn">
    <span class="icon">ü•Ç</span>
    <span>Raise a Toast!</span>
  </button>

  <button class="dance-btn" id="danceBtn">
    <span>üíÉ</span>
    <span>Shut Up & Dance!</span>
  </button>

  <button class="fireworks-btn" id="fireworksBtn">
    <span>üéÜ</span>
    <span>Fireworks!</span>
  </button>

  <div class="toast-overlay" id="toastOverlay">
    <div class="toast-modal">
      <span class="toast-glass">ü•Ç</span>
      <div class="toast-message">Cheers to You!</div>
      <div class="toast-sub">The whole party is toasting in your honor!</div>
    </div>
  </div>

  <a href="https://sloppy.live" class="backlink">sloppy.live</a>

  <script>
    // Virtual guests
    const guests = [
      { name: 'Alex', emoji: 'üòé', status: 'Dancing' },
      { name: 'Sam', emoji: 'ü•≥', status: 'Cheering' },
      { name: 'Jordan', emoji: 'üíÉ', status: 'Vibing' },
      { name: 'Taylor', emoji: 'üï∫', status: 'Grooving' },
      { name: 'Plato', emoji: 'üßê', status: 'Pondering' },
      { name: 'Casey', emoji: 'üòÑ', status: 'Happy' },
      { name: 'Morgan', emoji: 'üéä', status: 'Celebrating' },
      { name: 'Jamie', emoji: '‚ú®', status: 'Sparkling' }
    ];

    // Chat messages
    const chatMessages = [
      { name: 'Alex', emoji: 'üòé', text: "Can't believe you made it! This party is for YOU! üéâ" },
      { name: 'Plato', emoji: 'üßê', text: "Ah, but what IS a year? Merely a human construct to measure the immeasurable river of time..." },
      { name: 'Sam', emoji: 'ü•≥', text: "The guest of honor has arrived! Let's gooo!" },
      { name: 'Jordan', emoji: 'üíÉ', text: "I've been waiting all year for this moment!" },
      { name: 'Plato', emoji: 'üßê', text: "We stand at the precipice of temporal transition, where past and future briefly kiss..." },
      { name: 'Taylor', emoji: 'üï∫', text: "You look amazing tonight! ‚ú®" },
      { name: 'Casey', emoji: 'üòÑ', text: "So glad you're here to celebrate with us!" },
      { name: 'Plato', emoji: 'üßê', text: "Each second that passes is simultaneously a birth and a death. *stares into champagne glass profoundly*" },
      { name: 'Morgan', emoji: 'üéä', text: "The countdown is getting exciting!!" },
      { name: 'Jamie', emoji: '‚ú®', text: "Here's to an incredible new year ahead!" },
      { name: 'Plato', emoji: 'üßê', text: "Is midnight truly 'new'? Or simply the eternal now wearing a different mask? ü§î" },
      { name: 'Alex', emoji: 'üòé', text: "Everyone raise your glass for the VIP!" },
      { name: 'Sam', emoji: 'ü•≥', text: "This party wouldn't be the same without you!" },
      { name: 'Plato', emoji: 'üßê', text: "We celebrate the illusion of beginnings, yet every ending contains within it infinite beginnings..." },
      { name: 'Jordan', emoji: 'üíÉ', text: "New year, new adventures! üöÄ" },
      { name: 'Taylor', emoji: 'üï∫', text: "Let's make some memories tonight!" },
      { name: 'Plato', emoji: 'üßê', text: "As Heraclitus said, you cannot step into the same year twice. The year you left is not the year that was." }
    ];

    // Toast responses
    const toastResponses = [
      "To an amazing year ahead!",
      "Cheers to you, our VIP!",
      "May your dreams come true!",
      "Here's to new beginnings!",
      "To health, happiness, and success!",
      "Cheers to the best year yet!"
    ];

    // Plato's philosophical toasts
    const philosopherToasts = [
      "To the eternal now! For the past is memory, the future imagination, and only this moment truly exists...",
      "We raise our glasses not to a year, but to the ineffable mystery of consciousness experiencing time itself!",
      "As the clock strikes midnight, remember: we are but stardust briefly aware of its own existence. Cheers!",
      "To the beautiful absurdity of counting rotations around a star and calling it 'new'! *wipes tear*",
      "May your next 365 rotations around the sun be filled with the wisdom that all moments are one moment...",
      "Here's to impermanence! The only constant in this fleeting dance of atoms we call existence!"
    ];

    let soundEnabled = false;
    let audioContext = null;
    let isMidnight = false;

    // Initialize guests
    const guestsRow = document.getElementById('guestsRow');
    guests.forEach(guest => {
      const div = document.createElement('div');
      div.className = 'guest';
      div.innerHTML = `
        <div class="guest-avatar">${guest.emoji}</div>
        <div class="guest-name">${guest.name}</div>
        <div class="guest-status">${guest.status}</div>
      `;
      guestsRow.appendChild(div);
    });

    // Chat system
    const chatMessagesEl = document.getElementById('chatMessages');
    let chatIndex = 0;

    function addChatMessage() {
      const msg = chatMessages[chatIndex % chatMessages.length];
      const div = document.createElement('div');
      div.className = 'chat-message';
      div.innerHTML = `
        <div class="chat-avatar">${msg.emoji}</div>
        <div class="chat-content">
          <div class="chat-name">${msg.name}</div>
          <div class="chat-text">${msg.text}</div>
        </div>
      `;
      chatMessagesEl.appendChild(div);
      chatMessagesEl.scrollTop = chatMessagesEl.scrollHeight;

      // Keep only last 10 messages
      while (chatMessagesEl.children.length > 10) {
        chatMessagesEl.removeChild(chatMessagesEl.firstChild);
      }

      chatIndex++;
    }

    // Add initial messages
    for (let i = 0; i < 3; i++) {
      addChatMessage();
    }

    // Add new message periodically
    setInterval(addChatMessage, 5000 + Math.random() * 3000);

    // Countdown
    function updateCountdown() {
      const now = new Date();
      const currentYear = now.getFullYear();
      const newYear = new Date(currentYear + 1, 0, 1, 0, 0, 0);

      // If we're past midnight on Jan 1, target next year
      if (now >= newYear) {
        newYear.setFullYear(currentYear + 2);
      }

      const targetYear = newYear.getFullYear();
      document.getElementById('yearLabel').textContent = targetYear;
      document.getElementById('yearDisplay').textContent = targetYear;

      const diff = newYear - now;

      if (diff <= 0 && !isMidnight) {
        isMidnight = true;
        triggerMidnight();
        return;
      }

      const days = Math.floor(diff / (1000 * 60 * 60 * 24));
      const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
      const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
      const seconds = Math.floor((diff % (1000 * 60)) / 1000);

      document.getElementById('days').textContent = String(days).padStart(2, '0');
      document.getElementById('hours').textContent = String(hours).padStart(2, '0');
      document.getElementById('minutes').textContent = String(minutes).padStart(2, '0');
      document.getElementById('seconds').textContent = String(seconds).padStart(2, '0');

      // Final countdown sound effect
      if (diff <= 10000 && diff > 0 && soundEnabled) {
        // Could add countdown beeps here
      }
    }

    setInterval(updateCountdown, 1000);
    updateCountdown();

    // Toast feature
    const toastBtn = document.getElementById('toastBtn');
    const toastOverlay = document.getElementById('toastOverlay');

    toastBtn.addEventListener('click', () => {
      // Show toast modal
      const response = toastResponses[Math.floor(Math.random() * toastResponses.length)];
      toastOverlay.querySelector('.toast-sub').textContent = response;
      toastOverlay.classList.add('visible');

      // Play sound
      if (soundEnabled) playToastSound();

      // Spawn confetti
      spawnConfetti();

      // Add chat message
      const toastMsg = document.createElement('div');
      toastMsg.className = 'chat-message';
      toastMsg.innerHTML = `
        <div class="chat-avatar">ü•Ç</div>
        <div class="chat-content">
          <div class="chat-name">Everyone</div>
          <div class="chat-text">*The whole party raises their glasses to YOU!* ü•Ç‚ú®</div>
        </div>
      `;
      chatMessagesEl.appendChild(toastMsg);
      chatMessagesEl.scrollTop = chatMessagesEl.scrollHeight;

      // Plato adds a philosophical toast
      setTimeout(() => {
        const platoToast = philosopherToasts[Math.floor(Math.random() * philosopherToasts.length)];
        const platoMsg = document.createElement('div');
        platoMsg.className = 'chat-message';
        platoMsg.innerHTML = `
          <div class="chat-avatar">üßê</div>
          <div class="chat-content">
            <div class="chat-name">Plato</div>
            <div class="chat-text">${platoToast}</div>
          </div>
        `;
        chatMessagesEl.appendChild(platoMsg);
        chatMessagesEl.scrollTop = chatMessagesEl.scrollHeight;
      }, 1500);

      // Hide after 3 seconds
      setTimeout(() => {
        toastOverlay.classList.remove('visible');
      }, 3000);
    });

    toastOverlay.addEventListener('click', () => {
      toastOverlay.classList.remove('visible');
    });

    // Confetti
    function spawnConfetti() {
      const colors = ['#ffd700', '#ff6b9d', '#a855f7', '#00d4ff', '#00ff88', '#ff5757'];

      for (let i = 0; i < 100; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.cssText = `
          left: ${Math.random() * 100}vw;
          top: -20px;
          width: ${5 + Math.random() * 10}px;
          height: ${5 + Math.random() * 10}px;
          background: ${colors[Math.floor(Math.random() * colors.length)]};
          border-radius: ${Math.random() > 0.5 ? '50%' : '0'};
          animation: fall ${2 + Math.random() * 3}s linear forwards;
        `;
        document.body.appendChild(confetti);

        setTimeout(() => confetti.remove(), 5000);
      }
    }

    // Add confetti animation
    const style = document.createElement('style');
    style.textContent = `
      @keyframes fall {
        to {
          transform: translateY(110vh) rotate(${360 + Math.random() * 360}deg);
          opacity: 0;
        }
      }
    `;
    document.head.appendChild(style);

    // Midnight celebration
    function triggerMidnight() {
      document.getElementById('countdown').style.display = 'none';
      document.getElementById('yearDisplay').style.display = 'block';

      // Massive confetti burst
      for (let i = 0; i < 5; i++) {
        setTimeout(spawnConfetti, i * 500);
      }

      // Special chat messages
      const celebrations = [
        "üéâ HAPPY NEW YEAR!!! üéâ",
        "WE MADE IT! Here's to an amazing year!",
        "Cheers to the VIP of the party - YOU! ü•Ç",
        "What an incredible countdown! Let's celebrate!"
      ];

      celebrations.forEach((text, i) => {
        setTimeout(() => {
          const msg = document.createElement('div');
          msg.className = 'chat-message';
          msg.innerHTML = `
            <div class="chat-avatar">üéä</div>
            <div class="chat-content">
              <div class="chat-name">Everyone</div>
              <div class="chat-text">${text}</div>
            </div>
          `;
          chatMessagesEl.appendChild(msg);
          chatMessagesEl.scrollTop = chatMessagesEl.scrollHeight;
        }, i * 1500);
      });

      if (soundEnabled) playFireworks();
    }

    // Sound effects using Web Audio API
    const soundBtn = document.getElementById('soundBtn');
    soundBtn.addEventListener('click', () => {
      soundEnabled = !soundEnabled;
      soundBtn.textContent = soundEnabled ? 'üîä' : 'üîá';

      if (soundEnabled && !audioContext) {
        audioContext = new (window.AudioContext || window.webkitAudioContext)();
      }
    });

    function playToastSound() {
      if (!audioContext) return;
      const osc = audioContext.createOscillator();
      const gain = audioContext.createGain();
      osc.connect(gain);
      gain.connect(audioContext.destination);
      osc.frequency.setValueAtTime(800, audioContext.currentTime);
      osc.frequency.exponentialRampToValueAtTime(1200, audioContext.currentTime + 0.1);
      gain.gain.setValueAtTime(0.3, audioContext.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
      osc.start();
      osc.stop(audioContext.currentTime + 0.3);
    }

    function playFireworks() {
      if (!audioContext) return;
      for (let i = 0; i < 5; i++) {
        setTimeout(() => {
          const osc = audioContext.createOscillator();
          const gain = audioContext.createGain();
          osc.type = 'sawtooth';
          osc.connect(gain);
          gain.connect(audioContext.destination);
          osc.frequency.setValueAtTime(100 + Math.random() * 200, audioContext.currentTime);
          osc.frequency.exponentialRampToValueAtTime(50, audioContext.currentTime + 0.5);
          gain.gain.setValueAtTime(0.2, audioContext.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
          osc.start();
          osc.stop(audioContext.currentTime + 0.5);
        }, i * 300);
      }
    }

    // Shut Up and Dance button
    const danceBtn = document.getElementById('danceBtn');
    const chatSection = document.getElementById('chatSection');
    let danceMode = false;

    danceBtn.addEventListener('click', () => {
      danceMode = !danceMode;

      if (danceMode) {
        document.body.classList.add('dance-mode');
        chatSection.classList.add('hidden');
        danceBtn.classList.add('active');
        danceBtn.querySelector('span:last-child').textContent = 'Back to Chat';

        // Play dance sound
        if (soundEnabled) playDanceSound();
      } else {
        document.body.classList.remove('dance-mode');
        chatSection.classList.remove('hidden');
        danceBtn.classList.remove('active');
        danceBtn.querySelector('span:last-child').textContent = 'Shut Up & Dance!';
      }
    });

    function playDanceSound() {
      if (!audioContext) return;
      // Quick beat drop effect
      for (let i = 0; i < 3; i++) {
        setTimeout(() => {
          const osc = audioContext.createOscillator();
          const gain = audioContext.createGain();
          osc.type = 'square';
          osc.connect(gain);
          gain.connect(audioContext.destination);
          osc.frequency.setValueAtTime(150, audioContext.currentTime);
          osc.frequency.exponentialRampToValueAtTime(80, audioContext.currentTime + 0.15);
          gain.gain.setValueAtTime(0.15, audioContext.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.15);
          osc.start();
          osc.stop(audioContext.currentTime + 0.15);
        }, i * 100);
      }
    }

    // Auto confetti cannon every minute
    setInterval(() => {
      spawnConfetti();
      if (soundEnabled) playToastSound();
    }, 60000);

    // Fireworks system
    const fireworksBtn = document.getElementById('fireworksBtn');
    const fireworkColors = [
      '#ff5757', '#ffd700', '#00ff88', '#00d4ff', '#ff6b9d',
      '#a855f7', '#ffa500', '#ff1493', '#00ffff', '#ffff00'
    ];

    function launchFirework(startX) {
      const color = fireworkColors[Math.floor(Math.random() * fireworkColors.length)];
      const targetY = 100 + Math.random() * 200;

      // Create trail
      const trail = document.createElement('div');
      trail.className = 'firework-trail';
      trail.style.left = startX + 'px';
      trail.style.bottom = '0';
      trail.style.height = '0';
      trail.style.background = `linear-gradient(to top, transparent, ${color})`;
      document.body.appendChild(trail);

      // Animate trail going up
      let trailHeight = 0;
      const trailSpeed = 15 + Math.random() * 10;
      const trailInterval = setInterval(() => {
        trailHeight += trailSpeed;
        trail.style.height = trailHeight + 'px';
        trail.style.bottom = '0';

        if (trailHeight >= window.innerHeight - targetY) {
          clearInterval(trailInterval);
          trail.remove();

          // Explode!
          explodeFirework(startX, targetY, color);
        }
      }, 16);
    }

    function explodeFirework(x, y, color) {
      const particleCount = 40 + Math.floor(Math.random() * 30);
      const screenY = window.innerHeight - y;

      // Create glow effect
      const glow = document.createElement('div');
      glow.className = 'firework-glow';
      glow.style.left = (x - 50) + 'px';
      glow.style.top = (screenY - 50) + 'px';
      glow.style.width = '100px';
      glow.style.height = '100px';
      glow.style.background = color;
      glow.style.opacity = '0.8';
      document.body.appendChild(glow);

      // Fade glow
      setTimeout(() => {
        glow.style.transition = 'opacity 0.5s';
        glow.style.opacity = '0';
        setTimeout(() => glow.remove(), 500);
      }, 100);

      // Create explosion particles
      for (let i = 0; i < particleCount; i++) {
        const spark = document.createElement('div');
        spark.className = 'firework-spark';

        const angle = (Math.PI * 2 * i) / particleCount + (Math.random() - 0.5) * 0.5;
        const velocity = 3 + Math.random() * 5;
        const size = 3 + Math.random() * 4;

        spark.style.left = x + 'px';
        spark.style.top = screenY + 'px';
        spark.style.width = size + 'px';
        spark.style.height = size + 'px';
        spark.style.background = color;
        spark.style.boxShadow = `0 0 ${size * 2}px ${color}`;

        document.body.appendChild(spark);

        // Animate particle
        let vx = Math.cos(angle) * velocity;
        let vy = Math.sin(angle) * velocity;
        let px = x;
        let py = screenY;
        let opacity = 1;
        let gravity = 0.1;

        const animateSpark = () => {
          px += vx;
          py += vy;
          vy += gravity;
          vx *= 0.98;
          opacity -= 0.015;

          spark.style.left = px + 'px';
          spark.style.top = py + 'px';
          spark.style.opacity = opacity;

          if (opacity > 0) {
            requestAnimationFrame(animateSpark);
          } else {
            spark.remove();
          }
        };

        requestAnimationFrame(animateSpark);
      }

      // Play explosion sound
      if (soundEnabled) playFireworkSound();
    }

    function playFireworkSound() {
      if (!audioContext) return;

      // Boom sound
      const osc = audioContext.createOscillator();
      const gain = audioContext.createGain();
      osc.type = 'sawtooth';
      osc.connect(gain);
      gain.connect(audioContext.destination);
      osc.frequency.setValueAtTime(150 + Math.random() * 100, audioContext.currentTime);
      osc.frequency.exponentialRampToValueAtTime(30, audioContext.currentTime + 0.3);
      gain.gain.setValueAtTime(0.15, audioContext.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
      osc.start();
      osc.stop(audioContext.currentTime + 0.3);

      // Crackle
      setTimeout(() => {
        const noise = audioContext.createOscillator();
        const noiseGain = audioContext.createGain();
        noise.type = 'square';
        noise.connect(noiseGain);
        noiseGain.connect(audioContext.destination);
        noise.frequency.setValueAtTime(800 + Math.random() * 400, audioContext.currentTime);
        noiseGain.gain.setValueAtTime(0.05, audioContext.currentTime);
        noiseGain.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.2);
        noise.start();
        noise.stop(audioContext.currentTime + 0.2);
      }, 50);
    }

    function triggerFireworkShow() {
      // Launch multiple fireworks in sequence
      const fireworkCount = 12 + Math.floor(Math.random() * 8);

      for (let i = 0; i < fireworkCount; i++) {
        setTimeout(() => {
          const x = 50 + Math.random() * (window.innerWidth - 100);
          launchFirework(x);
        }, i * 200 + Math.random() * 300);
      }

      // Add a finale burst
      setTimeout(() => {
        for (let i = 0; i < 5; i++) {
          setTimeout(() => {
            const x = 100 + Math.random() * (window.innerWidth - 200);
            launchFirework(x);
          }, i * 100);
        }
      }, fireworkCount * 250);
    }

    fireworksBtn.addEventListener('click', () => {
      triggerFireworkShow();

      // Add chat reaction
      const reactions = [
        "üéÜ FIREWORKS! This is incredible!",
        "Ooooh! Ahhhhh! üéá",
        "Now THAT'S a party! üéÜ‚ú®",
        "The sky is on fire! üî•üéÜ"
      ];
      const msg = document.createElement('div');
      msg.className = 'chat-message';
      msg.innerHTML = `
        <div class="chat-avatar">üéÜ</div>
        <div class="chat-content">
          <div class="chat-name">Everyone</div>
          <div class="chat-text">${reactions[Math.floor(Math.random() * reactions.length)]}</div>
        </div>
      `;
      chatMessagesEl.appendChild(msg);
      chatMessagesEl.scrollTop = chatMessagesEl.scrollHeight;
    });
  </script>
<script src="/sloppy-header/sloppy-bar.js"></script>
<script src="/vibelib-extended.js"></script>
<script>
  // Compatibility Patch for Legacy Apps
  window.addEventListener("load", () => {
    if (window.SloppyKarma && window.VibeLib.Economy) {
      // Redirect old calls to new engine
      window.SloppyKarma.track = window.VibeLib.Economy.track;
    }
  });
</script>
</body>
</html>
