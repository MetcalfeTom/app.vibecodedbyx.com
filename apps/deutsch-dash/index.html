<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Deutsch Dash - Neon German Learning</title>
  <meta name="description" content="Learn German vocabulary with neon-powered games">
  <meta property="og:title" content="Deutsch Dash">
  <meta property="og:description" content="Neon German vocabulary games - Schnell lernen!">
  <meta property="og:url" content="https://sloppy.live/deutsch-dash">
  <meta property="og:image" content="https://sloppy.live/deutsch-dash/og-image.png">
  <link rel="icon" href="https://emojicdn.elk.sh/üá©üá™">
  <link href="https://fonts.googleapis.com/css2?family=Russo+One&family=Exo+2:wght@400;700;900&display=swap" rel="stylesheet">
  <style>
    :root {
      --cefr-A1: #00ff88;
      --cefr-A2: #00ccff;
      --cefr-B1: #ffcc00;
      --cefr-B2: #ff8800;
      --cefr-C1: #ff0040;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      min-height: 100vh;
      background: linear-gradient(135deg, #0a0a0a 0%, #1a0a0a 50%, #0a0a0a 100%);
      font-family: 'Exo 2', sans-serif;
      color: #fff;
      overflow-x: hidden;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }

    /* Header */
    .header {
      text-align: center;
      margin-bottom: 30px;
      padding: 25px;
      background: linear-gradient(180deg, rgba(255, 0, 0, 0.1), rgba(255, 200, 0, 0.05));
      border: 2px solid;
      border-image: linear-gradient(180deg, #ff0040, #ffcc00) 1;
      position: relative;
    }

    .header::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      background: linear-gradient(180deg, rgba(255, 0, 64, 0.3), rgba(255, 204, 0, 0.3));
      filter: blur(20px);
      z-index: -1;
    }

    h1 {
      font-family: 'Russo One', sans-serif;
      font-size: 3rem;
      letter-spacing: 4px;
      background: linear-gradient(180deg, #ff0040, #ffcc00);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-shadow: 0 0 30px rgba(255, 100, 0, 0.5);
      margin-bottom: 5px;
    }

    .subtitle {
      font-size: 1rem;
      color: #888;
      letter-spacing: 3px;
    }

    /* Stats Bar */
    .stats-bar {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin-bottom: 25px;
      flex-wrap: wrap;
    }

    .stat {
      text-align: center;
      padding: 15px 25px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 204, 0, 0.3);
      border-radius: 8px;
    }

    .stat-value {
      font-size: 2rem;
      font-weight: 900;
      color: #ffcc00;
      text-shadow: 0 0 20px rgba(255, 204, 0, 0.5);
    }

    .stat-label {
      font-size: 0.7rem;
      color: #666;
      letter-spacing: 2px;
      text-transform: uppercase;
    }

    /* Game Mode Selection */
    .mode-select {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin-bottom: 25px;
    }

    .mode-btn {
      padding: 20px 15px;
      background: rgba(0, 0, 0, 0.5);
      border: 2px solid #333;
      color: #888;
      font-family: 'Exo 2', sans-serif;
      font-size: 0.9rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .mode-btn:hover {
      border-color: #ff0040;
      color: #ff0040;
      box-shadow: 0 0 20px rgba(255, 0, 64, 0.3);
    }

    .mode-btn.active {
      background: linear-gradient(180deg, rgba(255, 0, 64, 0.2), rgba(255, 204, 0, 0.1));
      border-color: #ff0040;
      color: #fff;
      box-shadow: 0 0 30px rgba(255, 0, 64, 0.4);
    }

    .mode-icon {
      font-size: 1.5rem;
      display: block;
      margin-bottom: 8px;
    }

    /* Category Selection */
    .category-bar {
      display: flex;
      gap: 10px;
      margin-bottom: 25px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .cat-btn {
      padding: 8px 16px;
      background: transparent;
      border: 1px solid #444;
      color: #666;
      font-family: 'Exo 2', sans-serif;
      font-size: 0.75rem;
      cursor: pointer;
      transition: all 0.2s;
      border-radius: 20px;
    }

    .cat-btn:hover {
      border-color: #ffcc00;
      color: #ffcc00;
    }

    .cat-btn.active {
      background: #ffcc00;
      border-color: #ffcc00;
      color: #000;
    }

    .cat-btn.elite {
      border-color: #ff0040;
      color: #ff0040;
    }

    .cat-btn.elite:hover {
      border-color: #ff0040;
      color: #ff0040;
      box-shadow: 0 0 10px rgba(255, 0, 64, 0.5);
    }

    .cat-btn.elite.active {
      background: linear-gradient(180deg, #ff0040, #cc0033);
      border-color: #ff0040;
      color: #fff;
      box-shadow: 0 0 15px rgba(255, 0, 64, 0.5);
    }

    .elite-badge {
      display: inline-block;
      padding: 3px 8px;
      background: linear-gradient(180deg, #ff0040, #cc0033);
      font-size: 0.6rem;
      font-weight: 900;
      letter-spacing: 1px;
      border-radius: 3px;
      margin-left: 8px;
      vertical-align: middle;
      animation: elitePulse 2s infinite;
    }

    @keyframes elitePulse {
      0%, 100% { box-shadow: 0 0 5px rgba(255, 0, 64, 0.5); }
      50% { box-shadow: 0 0 20px rgba(255, 0, 64, 0.8); }
    }

    /* CEFR Selector */
    .cefr-selector {
      text-align: center;
      margin-bottom: 20px;
      padding: 15px;
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid #333;
      border-radius: 8px;
    }

    .cefr-title {
      font-size: 0.7rem;
      color: #666;
      letter-spacing: 3px;
      margin-bottom: 10px;
    }

    .cefr-buttons {
      display: flex;
      justify-content: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .cefr-btn {
      padding: 10px 18px;
      background: rgba(0, 0, 0, 0.5);
      border: 2px solid #333;
      color: #666;
      font-family: 'Russo One', sans-serif;
      font-size: 1rem;
      cursor: pointer;
      transition: all 0.2s;
      border-radius: 6px;
    }

    .cefr-btn:hover {
      border-color: #ffcc00;
      color: #ffcc00;
    }

    .cefr-btn.active {
      background: linear-gradient(180deg, rgba(255, 204, 0, 0.2), rgba(255, 204, 0, 0.05));
      border-color: #ffcc00;
      color: #ffcc00;
      box-shadow: 0 0 15px rgba(255, 204, 0, 0.3);
    }

    .cefr-btn[data-level="A1"].active { border-color: #00ff88; color: #00ff88; box-shadow: 0 0 15px rgba(0, 255, 136, 0.3); }
    .cefr-btn[data-level="A2"].active { border-color: #00ccff; color: #00ccff; box-shadow: 0 0 15px rgba(0, 204, 255, 0.3); }
    .cefr-btn[data-level="B1"].active { border-color: #ffcc00; color: #ffcc00; box-shadow: 0 0 15px rgba(255, 204, 0, 0.3); }
    .cefr-btn[data-level="B2"].active { border-color: #ff8800; color: #ff8800; box-shadow: 0 0 15px rgba(255, 136, 0, 0.3); }
    .cefr-btn[data-level="C1"].active { border-color: #ff0040; color: #ff0040; box-shadow: 0 0 15px rgba(255, 0, 64, 0.3); }

    .cefr-hint {
      font-size: 0.7rem;
      color: #555;
      margin-top: 10px;
    }

    .cefr-hint span {
      color: #ffcc00;
    }

    /* Certificate Modal */
    .certificate-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.5s;
    }

    .certificate-overlay.show {
      opacity: 1;
      pointer-events: all;
    }

    .certificate {
      background: linear-gradient(135deg, #0a0a0a, #1a0a0a);
      border: 4px solid;
      border-image: linear-gradient(180deg, #ffcc00, #ff0040) 1;
      padding: 40px;
      text-align: center;
      max-width: 500px;
      position: relative;
      animation: certGlow 2s infinite;
    }

    @keyframes certGlow {
      0%, 100% { box-shadow: 0 0 30px rgba(255, 204, 0, 0.3), 0 0 60px rgba(255, 0, 64, 0.2); }
      50% { box-shadow: 0 0 50px rgba(255, 204, 0, 0.5), 0 0 100px rgba(255, 0, 64, 0.3); }
    }

    .cert-header {
      font-size: 0.8rem;
      color: #666;
      letter-spacing: 4px;
      margin-bottom: 10px;
    }

    .cert-level {
      font-family: 'Russo One', sans-serif;
      font-size: 4rem;
      background: linear-gradient(180deg, #ffcc00, #ff0040);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin: 20px 0;
    }

    .cert-title {
      font-size: 1.5rem;
      color: #fff;
      margin-bottom: 10px;
    }

    .cert-desc {
      font-size: 0.9rem;
      color: #888;
      margin-bottom: 20px;
    }

    .cert-stats {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin: 20px 0;
    }

    .cert-stat {
      text-align: center;
    }

    .cert-stat-value {
      font-size: 2rem;
      font-weight: 900;
      color: #ffcc00;
    }

    .cert-stat-label {
      font-size: 0.7rem;
      color: #666;
      text-transform: uppercase;
    }

    .cert-close {
      margin-top: 20px;
      padding: 12px 30px;
      background: linear-gradient(180deg, #ff0040, #cc0033);
      border: none;
      color: #fff;
      font-family: 'Exo 2', sans-serif;
      font-size: 1rem;
      cursor: pointer;
      border-radius: 6px;
    }

    /* Game Area */
    .game-area {
      background: rgba(0, 0, 0, 0.5);
      border: 2px solid #222;
      border-radius: 12px;
      padding: 30px;
      min-height: 400px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    /* Flash Card Mode */
    .flash-card {
      width: 100%;
      max-width: 400px;
      min-height: 250px;
      background: linear-gradient(135deg, #1a1a1a, #0a0a0a);
      border: 3px solid #ff0040;
      border-radius: 16px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s;
      position: relative;
      perspective: 1000px;
    }

    .flash-card:hover {
      box-shadow: 0 0 40px rgba(255, 0, 64, 0.4);
      transform: scale(1.02);
    }

    .flash-card.flipped {
      border-color: #ffcc00;
    }

    .card-word {
      font-size: 2.5rem;
      font-weight: 900;
      text-align: center;
      padding: 20px;
    }

    .card-german {
      color: #ff0040;
      text-shadow: 0 0 20px rgba(255, 0, 64, 0.5);
    }

    .card-english {
      color: #ffcc00;
      text-shadow: 0 0 20px rgba(255, 204, 0, 0.5);
    }

    .card-hint {
      font-size: 0.8rem;
      color: #666;
      position: absolute;
      bottom: 15px;
    }

    .card-category {
      font-size: 0.7rem;
      color: #444;
      position: absolute;
      top: 15px;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    /* Quiz Mode */
    .quiz-warning {
      font-size: 0.8rem;
      color: #ffcc00;
      background: rgba(255, 204, 0, 0.1);
      padding: 8px 16px;
      border-radius: 4px;
      margin-bottom: 15px;
      letter-spacing: 1px;
    }

    .quiz-question {
      font-size: 2rem;
      font-weight: 900;
      color: #ff0040;
      text-shadow: 0 0 20px rgba(255, 0, 64, 0.5);
      margin-bottom: 30px;
      text-align: center;
    }

    .quiz-options {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      width: 100%;
      max-width: 500px;
    }

    .quiz-option {
      padding: 20px;
      background: rgba(255, 255, 255, 0.05);
      border: 2px solid #333;
      color: #fff;
      font-family: 'Exo 2', sans-serif;
      font-size: 1.1rem;
      cursor: pointer;
      transition: all 0.2s;
      border-radius: 8px;
    }

    .quiz-option:hover {
      border-color: #ffcc00;
      background: rgba(255, 204, 0, 0.1);
    }

    .quiz-option.correct {
      border-color: #00ff88;
      background: rgba(0, 255, 136, 0.2);
      color: #00ff88;
    }

    .quiz-option.wrong {
      border-color: #ff0040;
      background: rgba(255, 0, 64, 0.2);
      color: #ff0040;
    }

    /* Speed Match Mode */
    .speed-container {
      width: 100%;
      text-align: center;
    }

    .speed-timer {
      font-size: 3rem;
      font-weight: 900;
      color: #ff0040;
      text-shadow: 0 0 30px rgba(255, 0, 64, 0.5);
      margin-bottom: 20px;
    }

    .speed-word {
      font-size: 2.5rem;
      font-weight: 900;
      color: #ffcc00;
      text-shadow: 0 0 20px rgba(255, 204, 0, 0.5);
      margin-bottom: 25px;
    }

    .speed-input {
      width: 100%;
      max-width: 400px;
      padding: 15px 20px;
      background: rgba(0, 0, 0, 0.5);
      border: 2px solid #333;
      color: #fff;
      font-family: 'Exo 2', sans-serif;
      font-size: 1.5rem;
      text-align: center;
      border-radius: 8px;
      outline: none;
    }

    .speed-input:focus {
      border-color: #ffcc00;
      box-shadow: 0 0 20px rgba(255, 204, 0, 0.3);
    }

    .speed-input.correct {
      border-color: #00ff88;
      box-shadow: 0 0 20px rgba(0, 255, 136, 0.3);
    }

    .speed-input.wrong {
      border-color: #ff0040;
      box-shadow: 0 0 20px rgba(255, 0, 64, 0.3);
    }

    /* Buttons */
    .game-btn {
      padding: 15px 40px;
      background: linear-gradient(180deg, #ff0040, #cc0033);
      border: none;
      color: #fff;
      font-family: 'Exo 2', sans-serif;
      font-size: 1rem;
      font-weight: 700;
      cursor: pointer;
      border-radius: 8px;
      text-transform: uppercase;
      letter-spacing: 2px;
      transition: all 0.2s;
      margin-top: 20px;
    }

    .game-btn:hover {
      transform: scale(1.05);
      box-shadow: 0 0 30px rgba(255, 0, 64, 0.5);
    }

    .game-btn.secondary {
      background: transparent;
      border: 2px solid #ffcc00;
      color: #ffcc00;
    }

    /* Streak indicator */
    .streak {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 10px 20px;
      background: rgba(0, 0, 0, 0.8);
      border: 2px solid #00ff88;
      border-radius: 8px;
      font-weight: 700;
      color: #00ff88;
      text-shadow: 0 0 10px rgba(0, 255, 136, 0.5);
      opacity: 0;
      transform: translateY(-20px);
      transition: all 0.3s;
    }

    .streak.visible {
      opacity: 1;
      transform: translateY(0);
    }

    /* Result feedback */
    .feedback {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 4rem;
      font-weight: 900;
      pointer-events: none;
      opacity: 0;
      transition: all 0.3s;
    }

    .feedback.show {
      opacity: 1;
      animation: feedbackPop 0.5s ease-out;
    }

    .feedback.correct {
      color: #00ff88;
      text-shadow: 0 0 40px rgba(0, 255, 136, 0.8);
    }

    .feedback.wrong {
      color: #ff0040;
      text-shadow: 0 0 40px rgba(255, 0, 64, 0.8);
    }

    @keyframes feedbackPop {
      0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; }
      50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
    }

    /* Footer */
    .back-link {
      display: block;
      text-align: center;
      margin-top: 30px;
      color: #444;
      text-decoration: none;
      font-size: 0.8rem;
      letter-spacing: 2px;
    }

    .back-link:hover {
      color: #ffcc00;
    }

    /* Responsive */
    @media (max-width: 600px) {
      h1 { font-size: 2rem; }
      .mode-select { grid-template-columns: 1fr; }
      .quiz-options { grid-template-columns: 1fr; }
      .card-word { font-size: 1.8rem; }
    }

    .hidden { display: none !important; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>DEUTSCH DASH</h1>
      <div class="subtitle">SCHNELL LERNEN ‚Ä¢ <span class="elite-badge">ELITE MODE</span></div>
    </div>

    <div class="stats-bar">
      <div class="stat">
        <div class="stat-value" id="score">0</div>
        <div class="stat-label">Score</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="streak">0</div>
        <div class="stat-label">Streak</div>
      </div>
      <div class="stat">
        <div class="stat-value" id="learned">0</div>
        <div class="stat-label">Learned</div>
      </div>
    </div>

    <div class="mode-select">
      <button class="mode-btn active" data-mode="flash">
        <span class="mode-icon">üé¥</span>
        Flash Cards
      </button>
      <button class="mode-btn" data-mode="quiz">
        <span class="mode-icon">‚ùì</span>
        Quiz
      </button>
      <button class="mode-btn" data-mode="speed">
        <span class="mode-icon">‚ö°</span>
        Speed Dash
      </button>
    </div>

    <!-- CEFR Level Selector -->
    <div class="cefr-selector">
      <div class="cefr-title">CEFR LEVELS</div>
      <div class="cefr-buttons">
        <button class="cefr-btn active" data-level="A1" title="Beginner">A1</button>
        <button class="cefr-btn active" data-level="A2" title="Elementary">A2</button>
        <button class="cefr-btn active" data-level="B1" title="Intermediate">B1</button>
        <button class="cefr-btn active" data-level="B2" title="Upper Intermediate">B2</button>
        <button class="cefr-btn active" data-level="C1" title="Advanced">C1</button>
      </div>
      <div class="cefr-hint" id="cefrHint">Click levels to toggle ‚Ä¢ <span id="wordCount">0</span> words selected</div>
    </div>

    <div class="game-area" id="gameArea">
      <!-- Game content loaded dynamically -->
    </div>

    <a href="https://sloppy.live" class="back-link">SLOPPY.LIVE</a>
  </div>

  <div class="streak" id="streakIndicator">üî• STREAK!</div>
  <div class="feedback" id="feedback"></div>

  <!-- CEFR Certificate Modal -->
  <div class="certificate-overlay" id="certificateOverlay">
    <div class="certificate">
      <div class="cert-header">DEUTSCH DASH CERTIFICATE</div>
      <div class="cert-level" id="certLevel">B1</div>
      <div class="cert-title" id="certTitle">Intermediate German</div>
      <div class="cert-desc" id="certDesc">You have demonstrated proficiency in German vocabulary at the B1 level.</div>
      <div class="cert-stats">
        <div class="cert-stat">
          <div class="cert-stat-value" id="certScore">0</div>
          <div class="cert-stat-label">Score</div>
        </div>
        <div class="cert-stat">
          <div class="cert-stat-value" id="certWords">0</div>
          <div class="cert-stat-label">Words</div>
        </div>
        <div class="cert-stat">
          <div class="cert-stat-value" id="certAccuracy">0%</div>
          <div class="cert-stat-label">Accuracy</div>
        </div>
      </div>
      <button class="cert-close" onclick="closeCertificate()">WEITER LERNEN</button>
    </div>
  </div>

  <script>
    // ========================================
    // DEUTSCH DASH - CEFR VOCABULARY DATABASE
    // Modular word banks from A1 (beginner) to C1 (advanced)
    // ========================================

    const cefrVocabulary = {
      // A1 - BEGINNER: Basic survival German
      A1: [
        // Greetings & Basics
        { de: 'Hallo', en: 'Hello', traps: ['Hollow', 'Halo', 'Hall'], cat: 'greetings' },
        { de: 'Tsch√ºss', en: 'Goodbye', traps: ['Goodnight', 'Good day', 'Good luck'], cat: 'greetings' },
        { de: 'Danke', en: 'Thank you', traps: ['Thanks to', 'Thankful', 'Think'], cat: 'greetings' },
        { de: 'Bitte', en: 'Please', traps: ['Bitter', 'Bite', 'Better'], cat: 'greetings' },
        { de: 'Ja', en: 'Yes', traps: ['Yeah', 'Yell', 'Yet'], cat: 'basics' },
        { de: 'Nein', en: 'No', traps: ['Nine', 'None', 'New'], cat: 'basics' },
        { de: 'Gut', en: 'Good', traps: ['Gut (intestine)', 'Got', 'God'], cat: 'basics' },
        // Pronouns
        { de: 'Ich', en: 'I', traps: ['Itch', 'Each', 'Icy'], cat: 'pronouns' },
        { de: 'Du', en: 'You (informal)', traps: ['Do', 'Due', 'Dew'], cat: 'pronouns' },
        { de: 'Er', en: 'He', traps: ['Air', 'Ear', 'Her'], cat: 'pronouns' },
        { de: 'Sie', en: 'She/They/You (formal)', traps: ['See', 'Sea', 'Say'], cat: 'pronouns' },
        { de: 'Wir', en: 'We', traps: ['Were', 'Wire', 'Wear'], cat: 'pronouns' },
        // Numbers 1-10
        { de: 'Eins', en: 'One', traps: ['Ice', 'Eyes', 'Ounce'], cat: 'numbers' },
        { de: 'Zwei', en: 'Two', traps: ['Twice', 'Sway', 'Twig'], cat: 'numbers' },
        { de: 'Drei', en: 'Three', traps: ['Dry', 'Drew', 'Drain'], cat: 'numbers' },
        { de: 'Vier', en: 'Four', traps: ['Fear', 'Fire', 'Fir'], cat: 'numbers' },
        { de: 'F√ºnf', en: 'Five', traps: ['Fun', 'Funf', 'Fume'], cat: 'numbers' },
        { de: 'Sechs', en: 'Six', traps: ['Sects', 'Hex', 'Seeks'], cat: 'numbers' },
        { de: 'Sieben', en: 'Seven', traps: ['Sieve', 'Siege', 'See Ben'], cat: 'numbers' },
        { de: 'Acht', en: 'Eight', traps: ['Act', 'Ache', 'Yacht'], cat: 'numbers' },
        { de: 'Neun', en: 'Nine', traps: ['Noun', 'Noon', 'None'], cat: 'numbers' },
        { de: 'Zehn', en: 'Ten', traps: ['Zen', 'Zeal', 'Teen'], cat: 'numbers' },
        // Colors
        { de: 'Rot', en: 'Red', traps: ['Rot (decay)', 'Root', 'Wrote'], cat: 'colors' },
        { de: 'Blau', en: 'Blue', traps: ['Blow', 'Blaze', 'Blur'], cat: 'colors' },
        { de: 'Gr√ºn', en: 'Green', traps: ['Grin', 'Groan', 'Grain'], cat: 'colors' },
        { de: 'Gelb', en: 'Yellow', traps: ['Yell', 'Gel', 'Geld'], cat: 'colors' },
        { de: 'Schwarz', en: 'Black', traps: ['Swartz', 'Swart', 'Quartz'], cat: 'colors' },
        { de: 'Wei√ü', en: 'White', traps: ['Wise', 'Wheat', 'Vice'], cat: 'colors' },
        // Basic food/drink
        { de: 'Wasser', en: 'Water', traps: ['Waiter', 'Waster', 'Weather'], cat: 'food' },
        { de: 'Brot', en: 'Bread', traps: ['Broth', 'Broad', 'Broke'], cat: 'food' },
        { de: 'Kaffee', en: 'Coffee', traps: ['Cafe', 'Caffeine', 'Cough'], cat: 'food' },
        { de: 'Tee', en: 'Tea', traps: ['Tee (golf)', 'Tree', 'The'], cat: 'food' },
        { de: 'Milch', en: 'Milk', traps: ['Mulch', 'Mild', 'Mill'], cat: 'food' },
        // Basic verbs
        { de: 'sein', en: 'to be', traps: ['to see', 'sign', 'to sin'], cat: 'verbs' },
        { de: 'haben', en: 'to have', traps: ['to hover', 'haven', 'to heave'], cat: 'verbs' },
        { de: 'gehen', en: 'to go', traps: ['to get', 'to give', 'gay hen'], cat: 'verbs' },
        { de: 'kommen', en: 'to come', traps: ['to comb', 'comma', 'to calm'], cat: 'verbs' },
        { de: 'essen', en: 'to eat', traps: ['essence', 'to ease', 'essay'], cat: 'verbs' },
        { de: 'trinken', en: 'to drink', traps: ['to think', 'trinket', 'to trick'], cat: 'verbs' },
      ],

      // A2 - ELEMENTARY: Everyday situations
      A2: [
        // More greetings
        { de: 'Guten Morgen', en: 'Good morning', traps: ['Good evening', 'Good night', 'Good day'], cat: 'greetings' },
        { de: 'Guten Tag', en: 'Good day', traps: ['Good morning', 'Good night', 'Good luck'], cat: 'greetings' },
        { de: 'Gute Nacht', en: 'Good night', traps: ['Good morning', 'Goodnight kiss', 'Good luck'], cat: 'greetings' },
        { de: 'Wie geht\'s?', en: 'How are you?', traps: ['Where are you?', 'Who are you?', 'What are you?'], cat: 'greetings' },
        // Question words
        { de: 'Was', en: 'What', traps: ['Was (past tense)', 'Wash', 'Wasp'], cat: 'questions' },
        { de: 'Wo', en: 'Where', traps: ['Who', 'Woe', 'Whoa'], cat: 'questions' },
        { de: 'Wann', en: 'When', traps: ['Want', 'Wan', 'Won'], cat: 'questions' },
        { de: 'Warum', en: 'Why', traps: ['Warm', 'War', 'Wary'], cat: 'questions' },
        { de: 'Wer', en: 'Who', traps: ['Were', 'Wear', 'Where'], cat: 'questions' },
        { de: 'Wie', en: 'How', traps: ['We', 'Wee', 'Why'], cat: 'questions' },
        // Animals
        { de: 'Hund', en: 'Dog', traps: ['Hunt', 'Hound', 'Hand'], cat: 'animals' },
        { de: 'Katze', en: 'Cat', traps: ['Catch', 'Cuts', 'Ketchup'], cat: 'animals' },
        { de: 'Vogel', en: 'Bird', traps: ['Vocal', 'Vogue', 'Foggy'], cat: 'animals' },
        { de: 'Fisch', en: 'Fish', traps: ['Dish', 'Fist', 'Wish'], cat: 'animals' },
        { de: 'Pferd', en: 'Horse', traps: ['Ford', 'Herd', 'Feared'], cat: 'animals' },
        { de: 'Maus', en: 'Mouse', traps: ['Mouth', 'House', 'Moose'], cat: 'animals' },
        // More food
        { de: 'K√§se', en: 'Cheese', traps: ['Case', 'Chase', 'Chose'], cat: 'food' },
        { de: 'Ei', en: 'Egg', traps: ['Eye', 'I', 'Eel'], cat: 'food' },
        { de: 'Apfel', en: 'Apple', traps: ['Awful', 'Apply', 'Ample'], cat: 'food' },
        { de: 'Suppe', en: 'Soup', traps: ['Supper', 'Super', 'Supply'], cat: 'food' },
        { de: 'Salat', en: 'Salad', traps: ['Salary', 'Salt', 'Solid'], cat: 'food' },
        { de: 'Kuchen', en: 'Cake', traps: ['Kitchen', 'Chicken', 'Cough'], cat: 'food' },
        // Numbers 11-20
        { de: 'Elf', en: 'Eleven', traps: ['Elf (creature)', 'Shelf', 'Self'], cat: 'numbers' },
        { de: 'Zw√∂lf', en: 'Twelve', traps: ['Swolf', 'Dwarf', 'Shelf'], cat: 'numbers' },
        { de: 'Zwanzig', en: 'Twenty', traps: ['Swing', 'Tweeze', 'Twice'], cat: 'numbers' },
        { de: 'Hundert', en: 'Hundred', traps: ['Hunter', 'Hinder', 'Hunted'], cat: 'numbers' },
        // More verbs
        { de: 'machen', en: 'to make/do', traps: ['machine', 'to match', 'to march'], cat: 'verbs' },
        { de: 'sehen', en: 'to see', traps: ['to say', 'to sew', 'to seek'], cat: 'verbs' },
        { de: 'sprechen', en: 'to speak', traps: ['to sprinkle', 'to spread', 'to spell'], cat: 'verbs' },
        { de: 'lernen', en: 'to learn', traps: ['to lean', 'lantern', 'to lure'], cat: 'verbs' },
        { de: 'arbeiten', en: 'to work', traps: ['to orbit', 'arbiter', 'to argue'], cat: 'verbs' },
        { de: 'spielen', en: 'to play', traps: ['to spill', 'to spell', 'spleen'], cat: 'verbs' },
        { de: 'schlafen', en: 'to sleep', traps: ['to slap', 'to slay', 'to slave'], cat: 'verbs' },
        // Basic compounds
        { de: 'Handschuh', en: 'Glove', traps: ['Hand shoe', 'Handshake', 'Hand show'], cat: 'compound' },
        { de: 'Geburtstag', en: 'Birthday', traps: ['Birth day', 'Gerbil', 'Garbage'], cat: 'compound' },
        { de: 'Kindergarten', en: 'Preschool', traps: ['Child garden', 'Kinder (chocolate)', 'Kind garden'], cat: 'compound' },
      ],

      // B1 - INTERMEDIATE: Independent communication
      B1: [
        // More colors
        { de: 'Grau', en: 'Gray', traps: ['Grow', 'Grave', 'Gravy'], cat: 'colors' },
        { de: 'Braun', en: 'Brown', traps: ['Brawn', 'Brain', 'Brow'], cat: 'colors' },
        { de: 'Orange', en: 'Orange', traps: ['Organ', 'Origin', 'Arrange'], cat: 'colors' },
        { de: 'Rosa', en: 'Pink', traps: ['Rose', 'Rosy', 'Ross'], cat: 'colors' },
        { de: 'Lila', en: 'Purple', traps: ['Lilac', 'Lily', 'Lilt'], cat: 'colors' },
        { de: 'Hellblau', en: 'Light blue', traps: ['Hell blue', 'Half blue', 'Halo blue'], cat: 'colors' },
        // More animals
        { de: 'Kuh', en: 'Cow', traps: ['Coo', 'Coup', 'Queue'], cat: 'animals' },
        { de: 'Schwein', en: 'Pig', traps: ['Swine', 'Swing', 'Shine'], cat: 'animals' },
        { de: 'Schaf', en: 'Sheep', traps: ['Shaft', 'Chef', 'Sharp'], cat: 'animals' },
        { de: 'B√§r', en: 'Bear', traps: ['Bar', 'Beer', 'Bare'], cat: 'animals' },
        { de: 'Wolf', en: 'Wolf', traps: ['Golf', 'Woof', 'Wool'], cat: 'animals' },
        { de: 'Fuchs', en: 'Fox', traps: ['Fax', 'Fix', 'Folks'], cat: 'animals' },
        { de: 'Hase', en: 'Rabbit', traps: ['Haze', 'Hazel', 'Hare'], cat: 'animals' },
        // Abstract concepts
        { de: 'Zeit', en: 'Time', traps: ['Site', 'Sight', 'Cite'], cat: 'abstract' },
        { de: 'Arbeit', en: 'Work', traps: ['Orbit', 'Rabbit', 'Art'], cat: 'abstract' },
        { de: 'Leben', en: 'Life', traps: ['Leave', 'Lever', 'Level'], cat: 'abstract' },
        { de: 'Liebe', en: 'Love', traps: ['Live', 'Leave', 'Liver'], cat: 'abstract' },
        { de: 'Freund', en: 'Friend', traps: ['Fraud', 'Front', 'Freed'], cat: 'abstract' },
        { de: 'Familie', en: 'Family', traps: ['Familiar', 'Fame', 'Famine'], cat: 'abstract' },
        // More verbs
        { de: 'lesen', en: 'to read', traps: ['to lease', 'lesson', 'to lessen'], cat: 'verbs' },
        { de: 'schreiben', en: 'to write', traps: ['to scribe', 'to shrive', 'to shriek'], cat: 'verbs' },
        { de: 'lieben', en: 'to love', traps: ['to leave', 'to live', 'to lie'], cat: 'verbs' },
        { de: 'denken', en: 'to think', traps: ['to dunk', 'to drink', 'to thank'], cat: 'verbs' },
        { de: 'wissen', en: 'to know (fact)', traps: ['to wish', 'wisdom', 'to whisk'], cat: 'verbs' },
        { de: 'kennen', en: 'to know (person)', traps: ['to keen', 'kennel', 'to can'], cat: 'verbs' },
        { de: 'verstehen', en: 'to understand', traps: ['to verse', 'first ten', 'to feast'], cat: 'verbs' },
        // Common compounds
        { de: 'Flugzeug', en: 'Airplane', traps: ['Fly thing', 'Flock', 'Flu'], cat: 'compound' },
        { de: 'K√ºhlschrank', en: 'Refrigerator', traps: ['Cool shrink', 'Kitchen', 'Cooler'], cat: 'compound' },
        { de: 'Krankenhaus', en: 'Hospital', traps: ['Sick house', 'Crank house', 'Crankshaft'], cat: 'compound' },
        { de: 'Fahrrad', en: 'Bicycle', traps: ['Far rad', 'Fairy', 'Pharaoh'], cat: 'compound' },
        { de: 'Fernseher', en: 'Television', traps: ['Far seer', 'Fern see', 'Ferny'], cat: 'compound' },
        // First false friends
        { de: 'bald', en: 'Soon', traps: ['Bald (hairless)', 'Ball', 'Bold'], cat: 'falseFriend' },
        { de: 'fast', en: 'Almost', traps: ['Fast (quick)', 'Feast', 'Fist'], cat: 'falseFriend' },
        { de: 'See', en: 'Lake', traps: ['See (vision)', 'Sea', 'Seen'], cat: 'falseFriend' },
        { de: 'Meer', en: 'Sea/Ocean', traps: ['Mere', 'Mirror', 'Mayor'], cat: 'falseFriend' },
      ],

      // B2 - UPPER INTERMEDIATE: Complex ideas
      B2: [
        // Complex animals
        { de: 'Eichh√∂rnchen', en: 'Squirrel', traps: ['Acorn', 'Echo', 'Etch'], cat: 'animals' },
        { de: 'Schmetterling', en: 'Butterfly', traps: ['Smattering', 'Shatter', 'Scatter'], cat: 'animals' },
        { de: 'Schildkr√∂te', en: 'Turtle', traps: ['Shield', 'Skill', 'Shelter'], cat: 'animals' },
        { de: 'Schlange', en: 'Snake', traps: ['Slang', 'Sling', 'Blank'], cat: 'animals' },
        { de: 'Frosch', en: 'Frog', traps: ['Fresh', 'Frost', 'Frosh'], cat: 'animals' },
        // Advanced food
        { de: 'Kartoffel', en: 'Potato', traps: ['Carton', 'Cattle', 'Kettle'], cat: 'food' },
        { de: 'H√§hnchen', en: 'Chicken', traps: ['Hatch', 'Hanging', 'Honey'], cat: 'food' },
        { de: 'Rindfleisch', en: 'Beef', traps: ['Raindrop', 'Rifle', 'Reef'], cat: 'food' },
        { de: 'Obst', en: 'Fruit', traps: ['Oops', 'Opt', 'Opus'], cat: 'food' },
        { de: 'Gem√ºse', en: 'Vegetables', traps: ['Germ', 'Gem', 'Goose'], cat: 'food' },
        // False friends
        { de: 'Gift', en: 'Poison', traps: ['Gift (present)', 'Gifted', 'Give'], cat: 'falseFriend' },
        { de: 'bekommen', en: 'to receive', traps: ['to become', 'to be calm', 'to be coming'], cat: 'falseFriend' },
        { de: 'aktuell', en: 'Current', traps: ['Actual', 'Actually', 'Active'], cat: 'falseFriend' },
        { de: 'Art', en: 'Type/Kind', traps: ['Art (painting)', 'Artist', 'Artful'], cat: 'falseFriend' },
        { de: 'Chef', en: 'Boss', traps: ['Chef (cook)', 'Cheap', 'Cheer'], cat: 'falseFriend' },
        { de: 'eventuell', en: 'Possibly', traps: ['Eventually', 'Event', 'Even'], cat: 'falseFriend' },
        { de: 'Fabrik', en: 'Factory', traps: ['Fabric', 'Fabricate', 'Fable'], cat: 'falseFriend' },
        { de: 'Handy', en: 'Cell phone', traps: ['Handy (useful)', 'Hand', 'Handle'], cat: 'falseFriend' },
        { de: 'Rat', en: 'Advice', traps: ['Rat (rodent)', 'Rate', 'Raid'], cat: 'falseFriend' },
        { de: 'sensibel', en: 'Sensitive', traps: ['Sensible', 'Sensory', 'Sensor'], cat: 'falseFriend' },
        { de: 'Wand', en: 'Wall', traps: ['Wand (magic)', 'Want', 'Wonder'], cat: 'falseFriend' },
        // Complex compounds
        { de: 'Staubsauger', en: 'Vacuum cleaner', traps: ['Dust sucker', 'Star gazer', 'Stubborn'], cat: 'compound' },
        { de: 'Rathaus', en: 'City hall', traps: ['Rat house', 'Rate house', 'Raid house'], cat: 'compound' },
        { de: 'Briefkasten', en: 'Mailbox', traps: ['Brief case', 'Breast', 'Breaker'], cat: 'compound' },
        { de: 'Schreibtisch', en: 'Desk', traps: ['Scribe dish', 'Screaming', 'Shrimp'], cat: 'compound' },
        // Business/work
        { de: 'Besprechung', en: 'Meeting', traps: ['Beseeching', 'Beseech', 'Bestow'], cat: 'work' },
        { de: 'Bewerbung', en: 'Application', traps: ['Beveraging', 'Behavior', 'Beloved'], cat: 'work' },
        { de: 'Vertrag', en: 'Contract', traps: ['Vertex', 'Ferret', 'Vert'], cat: 'work' },
        { de: 'Gehalt', en: 'Salary', traps: ['Geld', 'Gel', 'Health'], cat: 'work' },
      ],

      // C1 - ADVANCED: Near-native complexity
      C1: [
        // Cultural concepts
        { de: 'Zeitgeist', en: 'Spirit of the time', traps: ['Time ghost', 'Site geist', 'Zeitgest'], cat: 'culture' },
        { de: 'Schadenfreude', en: 'Joy at others misfortune', traps: ['Shadow fraud', 'Shade friend', 'Shatter'], cat: 'culture' },
        { de: 'Wanderlust', en: 'Desire to travel', traps: ['Wonder lust', 'Wander lost', 'Wall dust'], cat: 'culture' },
        { de: 'Weltanschauung', en: 'World view/philosophy', traps: ['World show', 'Wealth', 'Walt'], cat: 'culture' },
        { de: 'Fingerspitzengef√ºhl', en: 'Intuitive finesse', traps: ['Finger tips', 'Feeling', 'Fingers'], cat: 'culture' },
        { de: 'Ohrwurm', en: 'Catchy song (earworm)', traps: ['Ear worm', 'Or warm', 'Our worm'], cat: 'culture' },
        { de: 'Kummerspeck', en: 'Weight from emotional eating', traps: ['Cumbersome', 'Comfort', 'Cucumber'], cat: 'culture' },
        { de: 'Torschlusspanik', en: 'Fear of time running out', traps: ['Torch panic', 'Tour', 'Tore'], cat: 'culture' },
        // Complex false friends
        { de: 'Gymnasium', en: 'High school', traps: ['Gymnasium (gym)', 'Gymnast', 'Gum'], cat: 'falseFriend' },
        { de: 'Mist', en: 'Manure', traps: ['Mist (fog)', 'Missed', 'Misty'], cat: 'falseFriend' },
        { de: 'sympathisch', en: 'Likeable', traps: ['Sympathetic', 'Symphony', 'Symbol'], cat: 'falseFriend' },
        { de: 'Pr√§servativ', en: 'Condom', traps: ['Preservative', 'Preserve', 'President'], cat: 'falseFriend' },
        { de: 'Rezept', en: 'Recipe/Prescription', traps: ['Receipt', 'Reception', 'Recept'], cat: 'falseFriend' },
        { de: 'Billion', en: 'Trillion', traps: ['Billion (English)', 'Bill', 'Bull'], cat: 'falseFriend' },
        // Advanced compounds
        { de: 'Weltmeisterschaft', en: 'World championship', traps: ['World master', 'Wealth', 'Welt'], cat: 'compound' },
        { de: 'Geschwindigkeitsbegrenzung', en: 'Speed limit', traps: ['Speed begin', 'Gesture', 'Guest'], cat: 'compound' },
        { de: 'Rechtsschutzversicherung', en: 'Legal protection insurance', traps: ['Right shoe', 'Retch', 'Wretch'], cat: 'compound' },
        { de: 'Entschuldigung', en: 'Excuse me/Sorry', traps: ['End shoulder', 'Enchant', 'Ensure'], cat: 'compound' },
        // Academic/formal
        { de: 'Zusammenhang', en: 'Context/Connection', traps: ['Zoom hang', 'Zusammen', 'Zoos'], cat: 'academic' },
        { de: 'Voraussetzung', en: 'Prerequisite', traps: ['Foreset', 'Foresee', 'Foresight'], cat: 'academic' },
        { de: 'Auseinandersetzung', en: 'Dispute/Confrontation', traps: ['Outside set', 'Oust', 'Austin'], cat: 'academic' },
        { de: 'Selbstverst√§ndlich', en: 'Obviously/Of course', traps: ['Self-standing', 'Self verse', 'Selfish'], cat: 'academic' },
        { de: 'Wahrscheinlichkeit', en: 'Probability', traps: ['War shine', 'Worse', 'Worship'], cat: 'academic' },
        { de: 'Verantwortung', en: 'Responsibility', traps: ['Ferment', 'Fever', 'Forever'], cat: 'academic' },
      ]
    };

    // CEFR Level descriptions
    const cefrDescriptions = {
      A1: 'Beginner - Basic survival',
      A2: 'Elementary - Everyday situations',
      B1: 'Intermediate - Independent',
      B2: 'Upper Intermediate - Complex ideas',
      C1: 'Advanced - Near-native'
    };

    // ELITE MODE: Smart tricky distractors that look/sound similar
    let eliteMode = true; // Always elite for Kriegsschiff!

    // Selected CEFR levels (default: all)
    let selectedLevels = new Set(['A1', 'A2', 'B1', 'B2', 'C1']);

    // Game state
    let currentMode = 'flash';
    let score = 0;
    let streak = 0;
    let learned = new Set();
    let currentWord = null;
    let isFlipped = false;
    let speedTimer = null;
    let speedTimeLeft = 60;
    let totalAttempts = 0;
    let correctAttempts = 0;

    // Get words for selected CEFR levels
    function getWords() {
      let words = [];
      for (const level of selectedLevels) {
        if (cefrVocabulary[level]) {
          words = words.concat(cefrVocabulary[level]);
        }
      }
      return words;
    }

    // Update word count display
    function updateWordCount() {
      const count = getWords().length;
      document.getElementById('wordCount').textContent = count;
    }

    // Get highest active CEFR level
    function getHighestLevel() {
      const levels = ['C1', 'B2', 'B1', 'A2', 'A1'];
      for (const level of levels) {
        if (selectedLevels.has(level)) return level;
      }
      return 'A1';
    }

    // Show certificate
    function showCertificate() {
      const level = getHighestLevel();
      const accuracy = totalAttempts > 0 ? Math.round((correctAttempts / totalAttempts) * 100) : 0;

      document.getElementById('certLevel').textContent = level;
      document.getElementById('certTitle').textContent = cefrDescriptions[level];
      document.getElementById('certDesc').textContent = `Sie haben Deutschkenntnisse auf ${level}-Niveau nachgewiesen.`;
      document.getElementById('certScore').textContent = score;
      document.getElementById('certWords').textContent = learned.size;
      document.getElementById('certAccuracy').textContent = accuracy + '%';

      document.getElementById('certificateOverlay').classList.add('show');
    }

    // Close certificate
    function closeCertificate() {
      document.getElementById('certificateOverlay').classList.remove('show');
    }

    // Get random word
    function getRandomWord() {
      const words = getWords();
      return words[Math.floor(Math.random() * words.length)];
    }

    // Get category name for word
    function getCategoryForWord(word) {
      return word.cat || 'unknown';
    }

    // Get CEFR level for word
    function getLevelForWord(word) {
      for (const [level, words] of Object.entries(cefrVocabulary)) {
        if (words.some(w => w.de === word.de)) return level;
      }
      return 'A1';
    }

    // Shuffle array
    function shuffle(arr) {
      const a = [...arr];
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    // Show feedback
    function showFeedback(isCorrect) {
      const feedback = document.getElementById('feedback');
      feedback.textContent = isCorrect ? 'RICHTIG!' : 'FALSCH!';
      feedback.className = `feedback show ${isCorrect ? 'correct' : 'wrong'}`;
      setTimeout(() => feedback.className = 'feedback', 500);
    }

    // Update stats display
    function updateStats() {
      document.getElementById('score').textContent = score;
      document.getElementById('streak').textContent = streak;
      document.getElementById('learned').textContent = learned.size;

      const streakIndicator = document.getElementById('streakIndicator');
      if (streak >= 3) {
        streakIndicator.textContent = `üî• ${streak} STREAK!`;
        streakIndicator.classList.add('visible');
      } else {
        streakIndicator.classList.remove('visible');
      }
    }

    // Handle correct answer
    function handleCorrect() {
      score += 10 + (streak * 2);
      streak++;
      learned.add(currentWord.de);
      totalAttempts++;
      correctAttempts++;
      showFeedback(true);
      updateStats();

      // Check for certificate milestone (every 20 words learned)
      if (learned.size > 0 && learned.size % 20 === 0) {
        setTimeout(showCertificate, 500);
      }
    }

    // Handle wrong answer
    function handleWrong() {
      streak = 0;
      totalAttempts++;
      showFeedback(false);
      updateStats();
    }

    // ========================================
    // FLASH CARD MODE
    // ========================================

    function renderFlashCard() {
      currentWord = getRandomWord();
      if (!currentWord) {
        document.getElementById('gameArea').innerHTML = '<div style="color: #ff0040;">No words selected. Please choose at least one CEFR level.</div>';
        return;
      }
      isFlipped = false;
      const level = getLevelForWord(currentWord);
      const cat = getCategoryForWord(currentWord);

      document.getElementById('gameArea').innerHTML = `
        <div class="flash-card" id="flashCard">
          <div class="card-category"><span style="color: var(--cefr-${level}, #ffcc00)">${level}</span> ‚Ä¢ ${cat}</div>
          <div class="card-word card-german">${currentWord.de}</div>
          <div class="card-hint">Click to reveal</div>
        </div>
        <div style="display: flex; gap: 15px; margin-top: 20px;">
          <button class="game-btn secondary" id="knowBtn">I Know It ‚úì</button>
          <button class="game-btn" id="nextBtn">Next ‚Üí</button>
        </div>
      `;

      document.getElementById('flashCard').addEventListener('click', flipCard);
      document.getElementById('knowBtn').addEventListener('click', () => {
        handleCorrect();
        renderFlashCard();
      });
      document.getElementById('nextBtn').addEventListener('click', renderFlashCard);
    }

    function flipCard() {
      if (isFlipped) return;
      isFlipped = true;
      const card = document.getElementById('flashCard');
      card.classList.add('flipped');
      card.querySelector('.card-word').className = 'card-word card-english';
      card.querySelector('.card-word').textContent = currentWord.en;
      card.querySelector('.card-hint').textContent = currentWord.de + ' ‚Üí ' + currentWord.en;
    }

    // ========================================
    // QUIZ MODE - ELITE DIFFICULTY
    // Uses tricky distractors that look/sound similar
    // ========================================

    function renderQuiz() {
      currentWord = getRandomWord();

      // ELITE MODE: Use tricky trap distractors if available
      let distractors = [];

      if (eliteMode && currentWord.traps && currentWord.traps.length >= 3) {
        // Use the hand-crafted trap distractors
        distractors = currentWord.traps.slice(0, 3);
      } else {
        // Fallback: get similar words from same category or confusing words
        const words = getWords();
        const usedAnswers = new Set([currentWord.en]);

        // Try to find words with similar English translations
        const similarWords = words.filter(w => {
          if (usedAnswers.has(w.en)) return false;
          // Prefer words that start with same letter or have similar length
          const sameLetter = w.en[0].toLowerCase() === currentWord.en[0].toLowerCase();
          const similarLength = Math.abs(w.en.length - currentWord.en.length) <= 3;
          return sameLetter || similarLength;
        });

        shuffle(similarWords);

        while (distractors.length < 3 && similarWords.length > 0) {
          const w = similarWords.pop();
          if (!usedAnswers.has(w.en)) {
            distractors.push(w.en);
            usedAnswers.add(w.en);
          }
        }

        // Fill remaining with random words
        while (distractors.length < 3) {
          const w = words[Math.floor(Math.random() * words.length)];
          if (!usedAnswers.has(w.en)) {
            distractors.push(w.en);
            usedAnswers.add(w.en);
          }
        }
      }

      // Create options array with correct answer and distractors
      let options = [
        { answer: currentWord.en, correct: true },
        ...distractors.map(d => ({ answer: d, correct: false }))
      ];
      options = shuffle(options);

      const cat = getCategoryForWord(currentWord);
      const isFalseFriend = cat === 'falseFriends';
      const isCompound = cat === 'compounds';

      document.getElementById('gameArea').innerHTML = `
        ${isFalseFriend ? '<div class="quiz-warning">‚ö†Ô∏è FALSE FRIEND - Looks can deceive!</div>' : ''}
        ${isCompound ? '<div class="quiz-warning">üîó COMPOUND WORD - Think literally!</div>' : ''}
        <div class="quiz-question">${currentWord.de}</div>
        <div class="quiz-options">
          ${options.map(opt => `
            <button class="quiz-option" data-answer="${opt.answer}" data-correct="${opt.correct}">${opt.answer}</button>
          `).join('')}
        </div>
      `;

      document.querySelectorAll('.quiz-option').forEach(btn => {
        btn.addEventListener('click', () => checkQuizAnswer(btn));
      });
    }

    function checkQuizAnswer(btn) {
      const isCorrect = btn.dataset.correct === 'true';

      // Disable all buttons
      document.querySelectorAll('.quiz-option').forEach(b => {
        b.style.pointerEvents = 'none';
        if (b.dataset.correct === 'true') {
          b.classList.add('correct');
        } else if (b === btn && !isCorrect) {
          b.classList.add('wrong');
        }
      });

      if (isCorrect) {
        handleCorrect();
      } else {
        handleWrong();
      }

      // Next question after delay
      setTimeout(renderQuiz, 1200);
    }

    // ========================================
    // SPEED DASH MODE
    // ========================================

    function renderSpeedDash() {
      speedTimeLeft = 60;
      currentWord = getRandomWord();

      document.getElementById('gameArea').innerHTML = `
        <div class="speed-container">
          <div class="speed-timer" id="speedTimer">60</div>
          <div class="speed-word" id="speedWord">${currentWord.de}</div>
          <input type="text" class="speed-input" id="speedInput" placeholder="Type the English..." autocomplete="off">
          <button class="game-btn" id="startSpeedBtn">START DASH!</button>
        </div>
      `;

      document.getElementById('startSpeedBtn').addEventListener('click', startSpeedRound);
    }

    function startSpeedRound() {
      document.getElementById('startSpeedBtn').style.display = 'none';
      const input = document.getElementById('speedInput');
      input.focus();
      input.addEventListener('input', checkSpeedAnswer);

      speedTimer = setInterval(() => {
        speedTimeLeft--;
        document.getElementById('speedTimer').textContent = speedTimeLeft;

        if (speedTimeLeft <= 0) {
          clearInterval(speedTimer);
          endSpeedRound();
        }
      }, 1000);
    }

    function checkSpeedAnswer() {
      const input = document.getElementById('speedInput');
      const answer = input.value.trim().toLowerCase();
      const correct = currentWord.en.toLowerCase();

      if (answer === correct) {
        input.classList.add('correct');
        handleCorrect();

        setTimeout(() => {
          input.value = '';
          input.classList.remove('correct');
          currentWord = getRandomWord();
          document.getElementById('speedWord').textContent = currentWord.de;
        }, 200);
      }
    }

    function endSpeedRound() {
      document.getElementById('gameArea').innerHTML = `
        <div style="text-align: center;">
          <div style="font-size: 1.5rem; color: #ffcc00; margin-bottom: 20px;">TIME'S UP!</div>
          <div style="font-size: 3rem; font-weight: 900; color: #ff0040; margin-bottom: 10px;">${score} POINTS</div>
          <div style="font-size: 1.2rem; color: #666; margin-bottom: 30px;">${learned.size} words learned</div>
          <button class="game-btn" id="playAgainBtn">PLAY AGAIN</button>
        </div>
      `;

      document.getElementById('playAgainBtn').addEventListener('click', () => {
        score = 0;
        streak = 0;
        updateStats();
        renderSpeedDash();
      });
    }

    // ========================================
    // MODE & CATEGORY SWITCHING
    // ========================================

    function setMode(mode) {
      currentMode = mode;
      document.querySelectorAll('.mode-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.mode === mode);
      });

      if (speedTimer) {
        clearInterval(speedTimer);
        speedTimer = null;
      }

      switch (mode) {
        case 'flash': renderFlashCard(); break;
        case 'quiz': renderQuiz(); break;
        case 'speed': renderSpeedDash(); break;
      }
    }

    // Event listeners
    document.querySelectorAll('.mode-btn').forEach(btn => {
      btn.addEventListener('click', () => setMode(btn.dataset.mode));
    });

    // CEFR level toggle listeners
    document.querySelectorAll('.cefr-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const level = btn.dataset.level;
        if (selectedLevels.has(level)) {
          // Don't allow deselecting all levels
          if (selectedLevels.size > 1) {
            selectedLevels.delete(level);
            btn.classList.remove('active');
          }
        } else {
          selectedLevels.add(level);
          btn.classList.add('active');
        }
        updateWordCount();
        setMode(currentMode); // Refresh current mode with new words
      });
    });

    // Initialize
    updateWordCount();
    renderFlashCard();
  </script>
</body>
</html>
