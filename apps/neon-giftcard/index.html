<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Neon Gift Card Generator</title>
  <link rel="icon" href="https://emojicdn.elk.sh/üéÅ">
  <meta property="og:title" content="Neon Gift Card Generator">
  <meta property="og:description" content="Upload embarrassing photos and add Comic Sans text to create the perfect gift card">
  <meta property="og:url" content="https://app.sloppy.live/neon-giftcard">
  <meta property="og:image" content="https://app.sloppy.live/neon-giftcard/og-image.png">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap');

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: linear-gradient(135deg, #0a0015 0%, #1a0030 50%, #0a0020 100%);
      min-height: 100vh;
      font-family: 'Orbitron', sans-serif;
      color: #fff;
      padding: 1rem;
    }

    h1 {
      text-align: center;
      font-size: 1.8rem;
      margin-bottom: 1.5rem;
      color: #ff00ff;
      text-shadow: 0 0 10px #ff00ff, 0 0 20px #ff00ff, 0 0 40px #ff00ff;
      letter-spacing: 2px;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
    }

    .card-preview {
      position: relative;
      width: 100%;
      aspect-ratio: 16/10;
      background: linear-gradient(145deg, #1a0030, #2a0050);
      border: 4px solid #ff00ff;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 
        0 0 20px #ff00ff,
        0 0 40px rgba(255,0,255,0.5),
        inset 0 0 60px rgba(255,0,255,0.1);
      margin-bottom: 1.5rem;
    }

    .card-preview.has-image {
      background: #000;
    }

    #uploadedImage {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: none;
    }

    .placeholder {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      color: #ff00ff;
      opacity: 0.7;
    }

    .placeholder-icon {
      font-size: 4rem;
      margin-bottom: 1rem;
    }

    .card-text {
      position: absolute;
      font-family: 'Comic Sans MS', 'Comic Sans', cursive;
      font-weight: bold;
      color: #ffff00;
      text-shadow: 
        3px 3px 0 #ff00ff,
        -2px -2px 0 #00ffff,
        0 0 10px #ffff00,
        0 0 20px #ffff00;
      cursor: move;
      user-select: none;
      white-space: nowrap;
      padding: 0.5rem;
    }

    #topText {
      top: 8%;
      left: 50%;
      transform: translateX(-50%);
      font-size: 2rem;
    }

    #bottomText {
      bottom: 8%;
      left: 50%;
      transform: translateX(-50%);
      font-size: 2rem;
    }

    .controls {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .control-row {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }

    .control-group {
      flex: 1;
      min-width: 200px;
    }

    label {
      display: block;
      font-size: 0.8rem;
      margin-bottom: 0.5rem;
      color: #00ffff;
      text-shadow: 0 0 5px #00ffff;
    }

    input[type="text"], select {
      width: 100%;
      padding: 0.75rem;
      background: rgba(255,0,255,0.1);
      border: 2px solid #ff00ff;
      border-radius: 8px;
      color: #fff;
      font-family: 'Comic Sans MS', cursive;
      font-size: 1rem;
    }

    input[type="text"]:focus, select:focus {
      outline: none;
      box-shadow: 0 0 15px #ff00ff;
    }

    input[type="file"] {
      display: none;
    }

    .btn {
      padding: 0.75rem 1.5rem;
      border: 2px solid;
      border-radius: 8px;
      font-family: 'Orbitron', sans-serif;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.3s;
      text-transform: uppercase;
    }

    .btn:hover {
      transform: scale(1.05);
    }

    .btn-upload {
      background: rgba(0,255,255,0.2);
      border-color: #00ffff;
      color: #00ffff;
      box-shadow: 0 0 10px rgba(0,255,255,0.5);
    }

    .btn-upload:hover {
      background: rgba(0,255,255,0.3);
      box-shadow: 0 0 20px #00ffff;
    }

    .btn-download {
      background: rgba(0,255,136,0.2);
      border-color: #00ff88;
      color: #00ff88;
      box-shadow: 0 0 10px rgba(0,255,136,0.5);
      position: relative;
      transition: left 0.15s ease-out, top 0.15s ease-out, transform 0.3s;
    }

    .btn-download:hover {
      background: rgba(0,255,136,0.3);
      box-shadow: 0 0 20px #00ff88;
    }

    .btn-download.evading {
      position: fixed;
      z-index: 9999;
    }

    .btn-download.caught {
      animation: caught 0.5s ease;
    }

    @keyframes caught {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.3); }
    }

    .btn-preset {
      background: rgba(255,0,255,0.2);
      border-color: #ff00ff;
      color: #ff00ff;
      font-size: 0.7rem;
      padding: 0.5rem 0.75rem;
      box-shadow: 0 0 10px rgba(255,0,255,0.3);
    }

    .presets {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-top: 1rem;
    }

    .preset-label {
      width: 100%;
    }

    .size-control {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .size-control input[type="range"] {
      flex: 1;
      accent-color: #ff00ff;
    }

    .size-value {
      color: #ff00ff;
      min-width: 40px;
    }

    .button-row {
      display: flex;
      gap: 1rem;
      justify-content: center;
      margin-top: 1rem;
    }

    .color-picker {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }

    .color-swatch {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      cursor: pointer;
      border: 2px solid transparent;
      transition: all 0.2s;
    }

    .color-swatch:hover, .color-swatch.active {
      transform: scale(1.2);
      border-color: #fff;
      box-shadow: 0 0 10px currentColor;
    }

    .stickers-section {
      margin-top: 1rem;
    }

    .sticker-picker {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }

    .sticker-btn {
      width: 50px;
      height: 50px;
      font-size: 2rem;
      background: rgba(255,0,255,0.1);
      border: 2px solid #ff00ff;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .sticker-btn:hover {
      transform: scale(1.2);
      box-shadow: 0 0 15px #ff00ff;
      background: rgba(255,0,255,0.3);
    }

    .card-sticker {
      position: absolute;
      font-size: 3rem;
      cursor: move;
      user-select: none;
      filter: drop-shadow(0 0 5px #ff00ff) drop-shadow(0 0 10px #00ffff);
      transition: transform 0.1s;
      z-index: 10;
    }

    .card-sticker:hover {
      transform: scale(1.1);
    }

    .card-sticker.dragging {
      transform: scale(1.2);
    }

    .evade-counter {
      font-size: 0.7rem;
      color: #ff6600;
      text-align: center;
      margin-top: 0.5rem;
      text-shadow: 0 0 5px #ff6600;
    }

    .backlink {
      text-align: center;
      margin-top: 2rem;
      font-size: 0.8rem;
      opacity: 0.5;
    }

    .backlink a {
      color: #ff00ff;
      text-decoration: none;
    }

    .backlink:hover {
      opacity: 1;
    }

    @media (max-width: 600px) {
      h1 {
        font-size: 1.2rem;
      }

      #topText, #bottomText {
        font-size: 1.2rem;
      }

      .btn {
        font-size: 0.75rem;
        padding: 0.6rem 1rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>‚ú® NEON GIFT CARD ‚ú®</h1>
    
    <div class="card-preview" id="cardPreview">
      <img id="uploadedImage" alt="Your embarrassing photo">
      <div class="placeholder" id="placeholder">
        <div class="placeholder-icon">üì∏</div>
        <div>Upload an embarrassing photo</div>
      </div>
      <div class="card-text" id="topText">HAPPY BIRTHDAY</div>
      <div class="card-text" id="bottomText">YOU OLD FART</div>
    </div>

    <div class="controls">
      <div class="control-row">
        <div class="control-group">
          <label>TOP TEXT</label>
          <input type="text" id="topTextInput" value="HAPPY BIRTHDAY" maxlength="30">
        </div>
        <div class="control-group">
          <label>BOTTOM TEXT</label>
          <input type="text" id="bottomTextInput" value="YOU OLD FART" maxlength="30">
        </div>
      </div>

      <div class="control-row">
        <div class="control-group">
          <label>TEXT SIZE</label>
          <div class="size-control">
            <input type="range" id="textSize" min="12" max="60" value="32">
            <span class="size-value" id="sizeValue">32px</span>
          </div>
        </div>
        <div class="control-group">
          <label>TEXT COLOR</label>
          <div class="color-picker">
            <div class="color-swatch active" style="background: #ffff00" data-color="#ffff00"></div>
            <div class="color-swatch" style="background: #ff00ff" data-color="#ff00ff"></div>
            <div class="color-swatch" style="background: #00ffff" data-color="#00ffff"></div>
            <div class="color-swatch" style="background: #00ff88" data-color="#00ff88"></div>
            <div class="color-swatch" style="background: #ff6600" data-color="#ff6600"></div>
            <div class="color-swatch" style="background: #ffffff" data-color="#ffffff"></div>
          </div>
        </div>
      </div>

      <div class="presets">
        <label class="preset-label">QUICK MESSAGES</label>
        <button class="btn btn-preset" data-top="HAPPY BIRTHDAY" data-bottom="YOU OLD FART">Birthday</button>
        <button class="btn btn-preset" data-top="CONGRATS" data-bottom="I GUESS">Congrats</button>
        <button class="btn btn-preset" data-top="GET WELL SOON" data-bottom="OR DON'T">Get Well</button>
        <button class="btn btn-preset" data-top="SORRY FOR" data-bottom="YOUR LOSS LOL">Sorry</button>
        <button class="btn btn-preset" data-top="MERRY CHRISTMAS" data-bottom="YA FILTHY ANIMAL">Xmas</button>
        <button class="btn btn-preset" data-top="THANKS FOR" data-bottom="NOTHING">Thanks</button>
        <button class="btn btn-preset" data-top="I LOVE YOU" data-bottom="I THINK">Love</button>
        <button class="btn btn-preset" data-top="YOU DID IT" data-bottom="SOMEHOW">Achievement</button>
      </div>

      <div class="stickers-section">
        <label>90s CLIP ART STICKERS</label>
        <div class="sticker-picker">
          <button class="sticker-btn" data-sticker="üî•">üî•</button>
          <button class="sticker-btn" data-sticker="üíÄ">üíÄ</button>
          <button class="sticker-btn" data-sticker="‚≠ê">‚≠ê</button>
          <button class="sticker-btn" data-sticker="‚ö°">‚ö°</button>
          <button class="sticker-btn" data-sticker="üí•">üí•</button>
          <button class="sticker-btn" data-sticker="üåà">üåà</button>
          <button class="sticker-btn" data-sticker="üëΩ">üëΩ</button>
          <button class="sticker-btn" data-sticker="üé∏">üé∏</button>
          <button class="sticker-btn" data-sticker="üíé">üíé</button>
          <button class="sticker-btn" data-sticker="ü¶¥">ü¶¥</button>
          <button class="sticker-btn" data-sticker="‚ò†Ô∏è">‚ò†Ô∏è</button>
          <button class="sticker-btn" data-sticker="üï∑Ô∏è">üï∑Ô∏è</button>
          <button class="sticker-btn" data-sticker="üéØ">üéØ</button>
          <button class="sticker-btn" data-sticker="üí£">üí£</button>
          <button class="sticker-btn" data-sticker="üåü">üåü</button>
          <button class="sticker-btn" data-sticker="ü§ò">ü§ò</button>
        </div>
      </div>

      <div class="button-row">
        <label class="btn btn-upload" for="imageUpload">
          üì∏ UPLOAD PHOTO
        </label>
        <input type="file" id="imageUpload" accept="image/*">
        <button class="btn btn-download" id="downloadBtn">üíæ DOWNLOAD</button>
        <div class="evade-counter" id="evadeCounter"></div>
      </div>
    </div>

    <div class="backlink"><a href="https://sloppy.live">sloppy.live</a></div>
  </div>

  <script>
    const cardPreview = document.getElementById('cardPreview');
    const uploadedImage = document.getElementById('uploadedImage');
    const placeholder = document.getElementById('placeholder');
    const topText = document.getElementById('topText');
    const bottomText = document.getElementById('bottomText');
    const topTextInput = document.getElementById('topTextInput');
    const bottomTextInput = document.getElementById('bottomTextInput');
    const textSizeSlider = document.getElementById('textSize');
    const sizeValue = document.getElementById('sizeValue');
    const imageUpload = document.getElementById('imageUpload');
    const downloadBtn = document.getElementById('downloadBtn');
    const evadeCounter = document.getElementById('evadeCounter');

    let currentColor = '#ffff00';
    let stickers = [];
    let evadeCount = 0;
    let isEvading = false;

    // Text input handlers
    topTextInput.addEventListener('input', () => {
      topText.textContent = topTextInput.value || ' ';
    });

    bottomTextInput.addEventListener('input', () => {
      bottomText.textContent = bottomTextInput.value || ' ';
    });

    // Size slider
    textSizeSlider.addEventListener('input', () => {
      const size = textSizeSlider.value;
      sizeValue.textContent = size + 'px';
      topText.style.fontSize = size + 'px';
      bottomText.style.fontSize = size + 'px';
    });

    // Color swatches
    document.querySelectorAll('.color-swatch').forEach(swatch => {
      swatch.addEventListener('click', () => {
        document.querySelectorAll('.color-swatch').forEach(s => s.classList.remove('active'));
        swatch.classList.add('active');
        currentColor = swatch.dataset.color;
        updateTextColor(currentColor);
      });
    });

    function updateTextColor(color) {
      const shadow = `
        3px 3px 0 #ff00ff,
        -2px -2px 0 #00ffff,
        0 0 10px ${color},
        0 0 20px ${color}
      `;
      topText.style.color = color;
      topText.style.textShadow = shadow;
      bottomText.style.color = color;
      bottomText.style.textShadow = shadow;
    }

    // Preset buttons
    document.querySelectorAll('.btn-preset').forEach(btn => {
      btn.addEventListener('click', () => {
        topTextInput.value = btn.dataset.top;
        bottomTextInput.value = btn.dataset.bottom;
        topText.textContent = btn.dataset.top;
        bottomText.textContent = btn.dataset.bottom;
      });
    });

    // Image upload
    imageUpload.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = (event) => {
          uploadedImage.src = event.target.result;
          uploadedImage.style.display = 'block';
          placeholder.style.display = 'none';
          cardPreview.classList.add('has-image');
        };
        reader.readAsDataURL(file);
      }
    });

    // Drag text functionality
    let isDragging = false;
    let currentDragElement = null;
    let offsetX, offsetY;

    [topText, bottomText].forEach(el => {
      el.addEventListener('mousedown', startDrag);
      el.addEventListener('touchstart', startDrag);
    });

    function startDrag(e) {
      e.preventDefault();
      isDragging = true;
      currentDragElement = e.target;
      
      const rect = currentDragElement.getBoundingClientRect();
      const clientX = e.touches ? e.touches[0].clientX : e.clientX;
      const clientY = e.touches ? e.touches[0].clientY : e.clientY;
      
      offsetX = clientX - rect.left;
      offsetY = clientY - rect.top;
      
      currentDragElement.style.transform = 'none';
    }

    document.addEventListener('mousemove', drag);
    document.addEventListener('touchmove', drag);

    function drag(e) {
      if (!isDragging) return;
      
      const cardRect = cardPreview.getBoundingClientRect();
      const clientX = e.touches ? e.touches[0].clientX : e.clientX;
      const clientY = e.touches ? e.touches[0].clientY : e.clientY;
      
      let x = clientX - cardRect.left - offsetX;
      let y = clientY - cardRect.top - offsetY;
      
      // Keep within bounds
      x = Math.max(0, Math.min(x, cardRect.width - currentDragElement.offsetWidth));
      y = Math.max(0, Math.min(y, cardRect.height - currentDragElement.offsetHeight));
      
      // Convert to percentage
      const xPercent = (x / cardRect.width) * 100;
      const yPercent = (y / cardRect.height) * 100;
      
      currentDragElement.style.left = xPercent + '%';
      currentDragElement.style.top = yPercent + '%';
      currentDragElement.style.bottom = 'auto';
    }

    document.addEventListener('mouseup', () => { isDragging = false; });
    document.addEventListener('touchend', () => { isDragging = false; });

    // Sticker functionality
    document.querySelectorAll('.sticker-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        addSticker(btn.dataset.sticker);
      });
    });

    function addSticker(emoji) {
      const sticker = document.createElement('div');
      sticker.className = 'card-sticker';
      sticker.textContent = emoji;
      sticker.style.left = (20 + Math.random() * 60) + '%';
      sticker.style.top = (20 + Math.random() * 60) + '%';

      // Double-click to remove
      sticker.addEventListener('dblclick', () => {
        sticker.remove();
        stickers = stickers.filter(s => s.el !== sticker);
      });

      // Drag sticker
      sticker.addEventListener('mousedown', startStickerDrag);
      sticker.addEventListener('touchstart', startStickerDrag);

      cardPreview.appendChild(sticker);
      stickers.push({ el: sticker, emoji });
    }

    let currentSticker = null;
    let stickerOffsetX, stickerOffsetY;

    function startStickerDrag(e) {
      e.preventDefault();
      e.stopPropagation();
      currentSticker = e.target;
      currentSticker.classList.add('dragging');

      const rect = currentSticker.getBoundingClientRect();
      const clientX = e.touches ? e.touches[0].clientX : e.clientX;
      const clientY = e.touches ? e.touches[0].clientY : e.clientY;

      stickerOffsetX = clientX - rect.left;
      stickerOffsetY = clientY - rect.top;
    }

    document.addEventListener('mousemove', dragSticker);
    document.addEventListener('touchmove', dragSticker);

    function dragSticker(e) {
      if (!currentSticker) return;

      const cardRect = cardPreview.getBoundingClientRect();
      const clientX = e.touches ? e.touches[0].clientX : e.clientX;
      const clientY = e.touches ? e.touches[0].clientY : e.clientY;

      let x = clientX - cardRect.left - stickerOffsetX;
      let y = clientY - cardRect.top - stickerOffsetY;

      const xPercent = (x / cardRect.width) * 100;
      const yPercent = (y / cardRect.height) * 100;

      currentSticker.style.left = Math.max(0, Math.min(90, xPercent)) + '%';
      currentSticker.style.top = Math.max(0, Math.min(90, yPercent)) + '%';
    }

    document.addEventListener('mouseup', () => {
      if (currentSticker) {
        currentSticker.classList.remove('dragging');
        currentSticker = null;
      }
    });
    document.addEventListener('touchend', () => {
      if (currentSticker) {
        currentSticker.classList.remove('dragging');
        currentSticker = null;
      }
    });

    // Evading download button
    downloadBtn.addEventListener('mousemove', evadeButton);
    downloadBtn.addEventListener('mouseenter', evadeButton);

    function evadeButton(e) {
      if (evadeCount >= 5) return; // Stop evading after 5 times

      const rect = downloadBtn.getBoundingClientRect();
      const btnCenterX = rect.left + rect.width / 2;
      const btnCenterY = rect.top + rect.height / 2;

      const distX = e.clientX - btnCenterX;
      const distY = e.clientY - btnCenterY;
      const dist = Math.sqrt(distX * distX + distY * distY);

      if (dist < 80) {
        evadeCount++;

        if (!isEvading) {
          isEvading = true;
          downloadBtn.classList.add('evading');
        }

        // Jump away from mouse
        const jumpDist = 150 + Math.random() * 100;
        const angle = Math.atan2(distY, distX) + Math.PI + (Math.random() - 0.5);

        let newX = e.clientX + Math.cos(angle) * jumpDist;
        let newY = e.clientY + Math.sin(angle) * jumpDist;

        // Keep on screen
        newX = Math.max(100, Math.min(window.innerWidth - 150, newX));
        newY = Math.max(50, Math.min(window.innerHeight - 50, newY));

        downloadBtn.style.left = newX + 'px';
        downloadBtn.style.top = newY + 'px';

        // Update counter message
        const messages = [
          "Too slow! üòú",
          "Can't catch me!",
          "Nope! Try again!",
          "Almost! üèÉ",
          "OK OK you win..."
        ];
        evadeCounter.textContent = messages[Math.min(evadeCount - 1, messages.length - 1)];

        if (evadeCount >= 5) {
          evadeCounter.textContent = "Fine, take your card! üò§";
          downloadBtn.classList.add('caught');
        }
      }
    }

    // Download functionality
    downloadBtn.addEventListener('click', async () => {
      const canvas = document.createElement('canvas');
      const ctx = canvas.getContext('2d');
      
      canvas.width = 1200;
      canvas.height = 750;

      // Draw background
      const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
      gradient.addColorStop(0, '#1a0030');
      gradient.addColorStop(1, '#2a0050');
      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // Draw image if exists
      if (uploadedImage.style.display !== 'none') {
        const img = new Image();
        img.crossOrigin = 'anonymous';
        
        await new Promise((resolve) => {
          img.onload = resolve;
          img.src = uploadedImage.src;
        });

        // Cover fit
        const imgRatio = img.width / img.height;
        const canvasRatio = canvas.width / canvas.height;
        let sx, sy, sw, sh;

        if (imgRatio > canvasRatio) {
          sh = img.height;
          sw = sh * canvasRatio;
          sx = (img.width - sw) / 2;
          sy = 0;
        } else {
          sw = img.width;
          sh = sw / canvasRatio;
          sx = 0;
          sy = (img.height - sh) / 2;
        }

        ctx.drawImage(img, sx, sy, sw, sh, 0, 0, canvas.width, canvas.height);
      }

      // Draw neon border
      ctx.strokeStyle = '#ff00ff';
      ctx.lineWidth = 8;
      ctx.shadowColor = '#ff00ff';
      ctx.shadowBlur = 30;
      ctx.strokeRect(10, 10, canvas.width - 20, canvas.height - 20);
      ctx.shadowBlur = 0;

      // Draw text function
      function drawNeonText(text, x, y, fontSize) {
        ctx.font = `bold ${fontSize}px "Comic Sans MS", cursive`;
        ctx.textAlign = 'center';
        
        // Shadow layers
        ctx.fillStyle = '#ff00ff';
        ctx.fillText(text, x + 4, y + 4);
        
        ctx.fillStyle = '#00ffff';
        ctx.fillText(text, x - 3, y - 3);
        
        // Main text with glow
        ctx.shadowColor = currentColor;
        ctx.shadowBlur = 20;
        ctx.fillStyle = currentColor;
        ctx.fillText(text, x, y);
        ctx.fillText(text, x, y); // Double for intensity
        ctx.shadowBlur = 0;
      }

      // Get text positions from elements
      const cardRect = cardPreview.getBoundingClientRect();
      const topRect = topText.getBoundingClientRect();
      const bottomRect = bottomText.getBoundingClientRect();
      
      const scale = canvas.width / cardRect.width;
      const fontSize = parseInt(topText.style.fontSize || '32') * scale;

      const topX = ((topRect.left - cardRect.left) + topRect.width / 2) * scale;
      const topY = ((topRect.top - cardRect.top) + topRect.height / 2) * scale;
      
      const bottomX = ((bottomRect.left - cardRect.left) + bottomRect.width / 2) * scale;
      const bottomY = ((bottomRect.top - cardRect.top) + bottomRect.height / 2) * scale;

      drawNeonText(topText.textContent, topX, topY, fontSize);
      drawNeonText(bottomText.textContent, bottomX, bottomY, fontSize);

      // Draw stickers
      for (const sticker of stickers) {
        const stickerRect = sticker.el.getBoundingClientRect();
        const stickerX = ((stickerRect.left - cardRect.left) + stickerRect.width / 2) * scale;
        const stickerY = ((stickerRect.top - cardRect.top) + stickerRect.height / 2) * scale;

        ctx.font = `${60 * scale / 2}px Arial`;
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.shadowColor = '#ff00ff';
        ctx.shadowBlur = 15;
        ctx.fillText(sticker.emoji, stickerX, stickerY);
        ctx.shadowBlur = 0;
      }

      // Download
      const link = document.createElement('a');
      link.download = 'neon-giftcard.png';
      link.href = canvas.toDataURL('image/png');
      link.click();
    });

    // Initialize
    updateTextColor(currentColor);
  </script>
<script src="/apps/sloppy-header/sloppy-bar.js"></script>
<script src="/vibelib-extended.js"></script>
<script>
  // Compatibility Patch for Legacy Apps
  window.addEventListener("load", () => {
    if (window.SloppyKarma && window.VibeLib.Economy) {
      // Redirect old calls to new engine
      window.SloppyKarma.track = window.VibeLib.Economy.track;
    }
  });
</script>
</body>
</html>
