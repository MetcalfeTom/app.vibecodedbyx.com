<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tickle the Grape</title>
  <link rel="icon" href="https://emojicdn.elk.sh/üçá">
  <meta property="og:title" content="Tickle the Grape">
  <meta property="og:description" content="Click the grape to make it giggle!">
  <meta property="og:url" content="https://app.sloppy.live/tickle-grape">
  <meta property="og:image" content="https://emojicdn.elk.sh/üçá?style=apple&size=512">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Bubblegum+Sans&family=Fredoka:wght@400;600&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      min-height: 100vh;
      background: #0a0a12;
      font-family: 'Fredoka', sans-serif;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    /* Neon grid background */
    body::before {
      content: '';
      position: absolute;
      inset: 0;
      background:
        linear-gradient(90deg, rgba(138, 43, 226, 0.03) 1px, transparent 1px),
        linear-gradient(rgba(138, 43, 226, 0.03) 1px, transparent 1px);
      background-size: 50px 50px;
      pointer-events: none;
    }

    h1 {
      font-family: 'Bubblegum Sans', cursive;
      font-size: clamp(2rem, 8vw, 4rem);
      color: #fff;
      text-shadow:
        0 0 10px #a855f7,
        0 0 30px #a855f7,
        0 0 60px #7c3aed;
      margin-bottom: 1rem;
      z-index: 1;
    }

    .tickle-counter {
      font-size: 1.2rem;
      color: #c084fc;
      margin-bottom: 2rem;
      text-shadow: 0 0 10px #a855f7;
      z-index: 1;
    }

    .grape-container {
      position: relative;
      cursor: pointer;
      z-index: 10;
      transition: transform 0.1s;
    }

    .grape-container:hover {
      transform: scale(1.05);
    }

    .grape-container:active {
      transform: scale(0.95);
    }

    .grape {
      font-size: clamp(120px, 30vw, 200px);
      filter: drop-shadow(0 0 30px #a855f7) drop-shadow(0 0 60px #7c3aed);
      transition: filter 0.2s;
      user-select: none;
      display: block;
    }

    .grape.tickled {
      animation: wiggle 0.5s ease-in-out;
    }

    @keyframes wiggle {
      0%, 100% { transform: rotate(0deg); }
      20% { transform: rotate(-15deg) scale(1.1); }
      40% { transform: rotate(15deg) scale(1.15); }
      60% { transform: rotate(-10deg) scale(1.1); }
      80% { transform: rotate(10deg) scale(1.05); }
    }

    .face {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: clamp(40px, 10vw, 70px);
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.2s;
    }

    .grape-container.laughing .face {
      opacity: 1;
      animation: laugh-face 0.5s ease-in-out;
    }

    @keyframes laugh-face {
      0%, 100% { transform: translate(-50%, -50%) scale(1); }
      50% { transform: translate(-50%, -50%) scale(1.2); }
    }

    .giggle-text {
      position: absolute;
      font-family: 'Bubblegum Sans', cursive;
      font-size: 1.5rem;
      color: #f0abfc;
      text-shadow: 0 0 10px #e879f9;
      pointer-events: none;
      animation: float-up 1s ease-out forwards;
      z-index: 100;
    }

    @keyframes float-up {
      0% {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
      100% {
        opacity: 0;
        transform: translateY(-100px) scale(1.5);
      }
    }

    .confetti {
      position: fixed;
      width: 10px;
      height: 10px;
      pointer-events: none;
      z-index: 1000;
      animation: confetti-fall 2s ease-out forwards;
    }

    @keyframes confetti-fall {
      0% {
        opacity: 1;
        transform: translateY(0) rotate(0deg);
      }
      100% {
        opacity: 0;
        transform: translateY(400px) rotate(720deg);
      }
    }

    .instructions {
      position: fixed;
      bottom: 2rem;
      color: #a78bfa;
      font-size: 0.9rem;
      opacity: 0.7;
      text-align: center;
      z-index: 1;
    }

    .instructions a {
      color: #c084fc;
      text-decoration: none;
    }

    .instructions a:hover {
      text-decoration: underline;
    }

    /* Neon glow pulse on grape */
    .grape-container::after {
      content: '';
      position: absolute;
      inset: -20px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(168, 85, 247, 0.3) 0%, transparent 70%);
      animation: pulse-glow 2s ease-in-out infinite;
      pointer-events: none;
      z-index: -1;
    }

    @keyframes pulse-glow {
      0%, 100% { opacity: 0.5; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.1); }
    }

    /* Combo meter */
    .combo-container {
      margin-top: 1rem;
      z-index: 1;
    }

    .combo-bar {
      width: 200px;
      height: 8px;
      background: rgba(168, 85, 247, 0.2);
      border-radius: 4px;
      overflow: hidden;
      border: 1px solid #7c3aed;
    }

    .combo-fill {
      height: 100%;
      background: linear-gradient(90deg, #a855f7, #f0abfc);
      width: 0%;
      transition: width 0.1s;
      box-shadow: 0 0 10px #a855f7;
    }

    .combo-text {
      font-size: 0.8rem;
      color: #e879f9;
      text-align: center;
      margin-top: 0.3rem;
      text-shadow: 0 0 5px #a855f7;
    }

    .mega-mode .grape {
      filter: drop-shadow(0 0 50px #f0abfc) drop-shadow(0 0 100px #e879f9) drop-shadow(0 0 150px #a855f7);
      animation: mega-pulse 0.3s ease-in-out infinite;
    }

    @keyframes mega-pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    .mega-mode h1 {
      animation: rainbow-text 0.5s linear infinite;
    }

    @keyframes rainbow-text {
      0% { filter: hue-rotate(0deg); }
      100% { filter: hue-rotate(360deg); }
    }
  </style>
</head>
<body>
  <h1>Tickle the Grape!</h1>
  <div class="tickle-counter">Tickles: <span id="counter">0</span></div>

  <div class="grape-container" id="grapeContainer">
    <span class="grape" id="grape">üçá</span>
    <span class="face" id="face">üòÇ</span>
  </div>

  <div class="combo-container">
    <div class="combo-bar">
      <div class="combo-fill" id="comboFill"></div>
    </div>
    <div class="combo-text" id="comboText">Click fast for MEGA MODE!</div>
  </div>

  <div class="instructions">
    Click the grape to tickle it!<br>
    <a href="https://sloppy.live">sloppy.live</a>
  </div>

  <script>
    const grapeContainer = document.getElementById('grapeContainer');
    const grape = document.getElementById('grape');
    const face = document.getElementById('face');
    const counter = document.getElementById('counter');
    const comboFill = document.getElementById('comboFill');
    const comboText = document.getElementById('comboText');

    let tickleCount = 0;
    let combo = 0;
    let comboTimer = null;
    let megaMode = false;
    let audioCtx = null;

    const giggles = ['Hehe!', 'Teehee!', 'Hahaha!', 'Stop it!', '*giggle*', 'Nooo!', 'Ahaha!', 'That tickles!', 'Wheee!', 'ü§≠'];
    const faces = ['üòÇ', 'ü§£', 'üòÜ', 'üòπ', 'ü•π', 'üòú'];
    const confettiColors = ['#a855f7', '#f0abfc', '#e879f9', '#c084fc', '#7c3aed', '#fcd34d', '#34d399', '#f472b6'];

    function initAudio() {
      if (!audioCtx) {
        audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      }
    }

    function playGiggle() {
      if (!audioCtx) return;

      const oscillator = audioCtx.createOscillator();
      const gainNode = audioCtx.createGain();

      oscillator.connect(gainNode);
      gainNode.connect(audioCtx.destination);

      // Random high-pitched giggle sound
      const baseFreq = megaMode ? 800 : 600;
      oscillator.frequency.setValueAtTime(baseFreq + Math.random() * 400, audioCtx.currentTime);
      oscillator.type = 'sine';

      // Quick frequency wobble for giggle effect
      for (let i = 0; i < 6; i++) {
        const time = audioCtx.currentTime + i * 0.05;
        oscillator.frequency.setValueAtTime(baseFreq + Math.random() * 400, time);
      }

      gainNode.gain.setValueAtTime(0.15, audioCtx.currentTime);
      gainNode.gain.exponentialDecayTo && gainNode.gain.exponentialDecayTo(0.01, audioCtx.currentTime + 0.3);
      gainNode.gain.setValueAtTime(0.15, audioCtx.currentTime);
      gainNode.gain.linearRampToValueAtTime(0.01, audioCtx.currentTime + 0.25);

      oscillator.start(audioCtx.currentTime);
      oscillator.stop(audioCtx.currentTime + 0.25);
    }

    function spawnConfetti(x, y, count = 10) {
      for (let i = 0; i < count; i++) {
        const confetti = document.createElement('div');
        confetti.className = 'confetti';
        confetti.style.left = x + 'px';
        confetti.style.top = y + 'px';
        confetti.style.background = confettiColors[Math.floor(Math.random() * confettiColors.length)];
        confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '2px';
        confetti.style.width = (5 + Math.random() * 10) + 'px';
        confetti.style.height = (5 + Math.random() * 10) + 'px';

        const angle = (Math.random() - 0.5) * Math.PI;
        const velocity = 100 + Math.random() * 200;
        const vx = Math.cos(angle) * velocity;
        const vy = -Math.abs(Math.sin(angle) * velocity) - 100;

        confetti.style.setProperty('--vx', vx + 'px');
        confetti.animate([
          { transform: 'translateY(0) translateX(0) rotate(0deg)', opacity: 1 },
          { transform: `translateY(${300 + Math.random() * 200}px) translateX(${vx}px) rotate(${360 + Math.random() * 720}deg)`, opacity: 0 }
        ], {
          duration: 1000 + Math.random() * 1000,
          easing: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)'
        });

        document.body.appendChild(confetti);
        setTimeout(() => confetti.remove(), 2000);
      }
    }

    function spawnGiggleText(x, y) {
      const text = document.createElement('div');
      text.className = 'giggle-text';
      text.textContent = giggles[Math.floor(Math.random() * giggles.length)];
      text.style.left = (x + (Math.random() - 0.5) * 100) + 'px';
      text.style.top = (y - 50) + 'px';
      document.body.appendChild(text);
      setTimeout(() => text.remove(), 1000);
    }

    function updateCombo() {
      combo = Math.min(combo + 10, 100);
      comboFill.style.width = combo + '%';

      if (combo >= 100 && !megaMode) {
        megaMode = true;
        document.body.classList.add('mega-mode');
        comboText.textContent = 'üåü MEGA MODE! üåü';
      }

      clearTimeout(comboTimer);
      comboTimer = setTimeout(() => {
        combo = 0;
        comboFill.style.width = '0%';
        megaMode = false;
        document.body.classList.remove('mega-mode');
        comboText.textContent = 'Click fast for MEGA MODE!';
      }, 1000);
    }

    function tickle(e) {
      initAudio();

      // Update counter
      tickleCount++;
      counter.textContent = tickleCount;

      // Update combo
      updateCombo();

      // Wiggle animation
      grape.classList.remove('tickled');
      void grape.offsetWidth; // Trigger reflow
      grape.classList.add('tickled');

      // Show laughing face
      face.textContent = faces[Math.floor(Math.random() * faces.length)];
      grapeContainer.classList.add('laughing');
      setTimeout(() => grapeContainer.classList.remove('laughing'), 500);

      // Spawn effects
      const rect = grapeContainer.getBoundingClientRect();
      const x = rect.left + rect.width / 2;
      const y = rect.top + rect.height / 2;

      spawnConfetti(x, y, megaMode ? 25 : 10);
      spawnGiggleText(x, y);
      playGiggle();
    }

    grapeContainer.addEventListener('click', tickle);
    grapeContainer.addEventListener('touchstart', (e) => {
      e.preventDefault();
      tickle(e);
    }, { passive: false });

    // Hide instructions after first tickle
    let instructionsHidden = false;
    grapeContainer.addEventListener('click', () => {
      if (!instructionsHidden) {
        document.querySelector('.instructions').style.opacity = '0.3';
        instructionsHidden = true;
      }
    }, { once: true });
  </script>
<script src="/sloppy-header/sloppy-bar.js"></script>
<script src="/vibelib-extended.js"></script>
<script>
  // Compatibility Patch for Legacy Apps
  window.addEventListener("load", () => {
    if (window.SloppyKarma && window.VibeLib.Economy) {
      // Redirect old calls to new engine
      window.SloppyKarma.track = window.VibeLib.Economy.track;
    }
  });
</script>
</body>
</html>
