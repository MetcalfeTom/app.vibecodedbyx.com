<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Neon ASCII Donut</title>
  <link rel="icon" href="https://emojicdn.elk.sh/ðŸ©">
  <meta property="og:title" content="Neon ASCII Donut">
  <meta property="og:description" content="Hypnotic spinning ASCII donut with color-cycling neon glow">
  <meta property="og:url" content="https://sloppy.live/neon-donut">
  <meta property="og:image" content="https://sloppy.live/neon-donut/og-image.png">
  <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      background: #0a0a0f;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-family: 'Fira Code', monospace;
      overflow: hidden;
    }

    .container {
      text-align: center;
    }

    h1 {
      font-size: 2rem;
      margin-bottom: 1rem;
      letter-spacing: 4px;
      transition: color 0.5s, text-shadow 0.5s;
    }

    #donut {
      font-size: 10px;
      line-height: 1;
      letter-spacing: 2px;
      white-space: pre;
      transition: color 0.3s, text-shadow 0.3s;
    }

    .controls {
      margin-top: 1.5rem;
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      justify-content: center;
    }

    button {
      background: transparent;
      border: 2px solid currentColor;
      padding: 0.5rem 1.5rem;
      font-family: 'Fira Code', monospace;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.3s;
      border-radius: 4px;
    }

    button:hover {
      transform: scale(1.05);
    }

    .speed-control {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: #888;
    }

    .speed-control input {
      width: 100px;
      accent-color: currentColor;
    }

    .backlink {
      position: fixed;
      bottom: 1rem;
      font-size: 0.8rem;
      opacity: 0.5;
      transition: opacity 0.3s, color 0.3s;
    }

    .backlink:hover {
      opacity: 1;
    }

    .backlink a {
      color: inherit;
      text-decoration: none;
    }

    @media (max-width: 600px) {
      #donut {
        font-size: 6px;
        letter-spacing: 1px;
      }

      h1 {
        font-size: 1.3rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1 id="title">NEON DONUT</h1>
    <pre id="donut"></pre>
    <div class="controls">
      <button id="pauseBtn">PAUSE</button>
      <button id="colorBtn">CYCLE COLORS</button>
      <div class="speed-control">
        <span>SPEED:</span>
        <input type="range" id="speedSlider" min="1" max="100" value="50">
      </div>
    </div>
  </div>
  <div class="backlink"><a href="https://sloppy.live">sloppy.live</a></div>

  <script>
    const donutEl = document.getElementById('donut');
    const titleEl = document.getElementById('title');
    const pauseBtn = document.getElementById('pauseBtn');
    const colorBtn = document.getElementById('colorBtn');
    const speedSlider = document.getElementById('speedSlider');
    const backlink = document.querySelector('.backlink');

    // Neon color palette
    const colors = [
      { primary: '#ff00ff', glow: '#ff00ff' },  // Magenta
      { primary: '#00ffff', glow: '#00ffff' },  // Cyan
      { primary: '#ff3366', glow: '#ff3366' },  // Pink
      { primary: '#00ff88', glow: '#00ff88' },  // Green
      { primary: '#ffee00', glow: '#ffee00' },  // Yellow
      { primary: '#ff6600', glow: '#ff6600' },  // Orange
      { primary: '#9b4dff', glow: '#9b4dff' },  // Purple
      { primary: '#00eeff', glow: '#00eeff' },  // Electric blue
    ];

    let colorIndex = 0;
    let A = 0, B = 0;
    let paused = false;
    let autoCycle = true;
    let frameCount = 0;

    function updateColors(color) {
      const { primary, glow } = color;

      donutEl.style.color = primary;
      donutEl.style.textShadow = `
        0 0 5px ${glow},
        0 0 10px ${glow},
        0 0 20px ${glow},
        0 0 40px ${glow}
      `;

      titleEl.style.color = primary;
      titleEl.style.textShadow = `
        0 0 10px ${glow},
        0 0 20px ${glow},
        0 0 40px ${glow}
      `;

      document.querySelectorAll('button').forEach(btn => {
        btn.style.color = primary;
        btn.style.boxShadow = `0 0 10px ${glow}`;
      });

      backlink.style.color = primary;
      speedSlider.style.accentColor = primary;
    }

    function renderDonut() {
      const width = window.innerWidth < 600 ? 50 : 80;
      const height = window.innerWidth < 600 ? 24 : 22;

      let b = [];
      let z = [];

      for (let k = 0; k < width * height; k++) {
        b[k] = ' ';
        z[k] = 0;
      }

      const chars = '.,-~:;=!*#$@';

      for (let j = 0; j < 6.28; j += 0.07) {
        for (let i = 0; i < 6.28; i += 0.02) {
          const c = Math.sin(i);
          const d = Math.cos(j);
          const e = Math.sin(A);
          const f = Math.sin(j);
          const g = Math.cos(A);
          const h = d + 2;
          const D = 1 / (c * h * e + f * g + 5);
          const l = Math.cos(i);
          const m = Math.cos(B);
          const n = Math.sin(B);
          const t = c * h * g - f * e;

          const x = Math.floor(width / 2 + (width / 2.5) * D * (l * h * m - t * n));
          const y = Math.floor(height / 2 + (height / 2) * D * (l * h * n + t * m));
          const o = x + width * y;
          const N = Math.floor(8 * ((f * e - c * d * g) * m - c * d * e - f * g - l * d * n));

          if (y > 0 && y < height && x > 0 && x < width && D > z[o]) {
            z[o] = D;
            b[o] = chars[Math.max(0, N)];
          }
        }
      }

      let output = '';
      for (let k = 0; k < width * height; k++) {
        output += (k % width === width - 1) ? '\n' : b[k];
      }

      donutEl.textContent = output;
    }

    function animate() {
      if (!paused) {
        const speed = speedSlider.value / 1000;
        A += 0.04 * speed * 2;
        B += 0.02 * speed * 2;

        frameCount++;

        // Auto cycle colors every ~120 frames
        if (autoCycle && frameCount % 120 === 0) {
          colorIndex = (colorIndex + 1) % colors.length;
          updateColors(colors[colorIndex]);
        }

        renderDonut();
      }

      requestAnimationFrame(animate);
    }

    // Controls
    pauseBtn.addEventListener('click', () => {
      paused = !paused;
      pauseBtn.textContent = paused ? 'PLAY' : 'PAUSE';
    });

    colorBtn.addEventListener('click', () => {
      autoCycle = !autoCycle;
      colorBtn.textContent = autoCycle ? 'CYCLE COLORS' : 'MANUAL MODE';
      if (!autoCycle) {
        // Manual: advance to next color on click
        colorIndex = (colorIndex + 1) % colors.length;
        updateColors(colors[colorIndex]);
      }
    });

    // Handle resize
    window.addEventListener('resize', renderDonut);

    // Initialize
    updateColors(colors[0]);
    animate();
  </script>
<script src="/sloppy-header/sloppy-bar.js"></script>
</body>
</html>
