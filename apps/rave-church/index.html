<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rave Church — Neon Scripture & Techno Visions</title>
<link rel="icon" href="https://emojicdn.elk.sh/⛪">
<meta property="og:title" content="Rave Church">
<meta property="og:description" content="Pulsing neon bible verses over procedural techno visuals. Enter the church.">
<meta property="og:url" content="https://app.sloppy.live/rave-church">
<meta property="og:image" content="https://image.pollinations.ai/prompt/neon%20stained%20glass%20window%20in%20dark%20church%20with%20laser%20beams%20rave%20psychedelic%20purple%20cyan%20magenta%20glowing%20cross?width=1200&height=630&nologo=true&referrer=sloppy.live">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{background:#000;overflow:hidden;cursor:crosshair;font-family:serif}
canvas{position:fixed;inset:0;z-index:0}

/* Verse overlay */
.verse-layer{position:fixed;inset:0;z-index:2;display:flex;align-items:center;justify-content:center;
  pointer-events:none;perspective:800px}
.verse-box{text-align:center;max-width:80%;padding:20px;transform-style:preserve-3d}
.verse-text{font-family:'Times New Roman',serif;font-size:clamp(1.4rem,5vw,3.2rem);font-weight:700;
  line-height:1.3;letter-spacing:.02em;
  text-shadow:0 0 20px var(--glow),0 0 60px var(--glow),0 0 120px var(--glow2);
  transition:opacity .8s,transform .8s;animation:verse-pulse 2s ease-in-out infinite alternate}
.verse-ref{font-size:clamp(.6rem,1.5vw,.9rem);margin-top:12px;opacity:.5;letter-spacing:.2em;text-transform:uppercase;
  font-family:monospace}
@keyframes verse-pulse{
  0%{transform:scale(1) rotateX(0deg);filter:brightness(1)}
  100%{transform:scale(1.03) rotateX(2deg);filter:brightness(1.3)}
}

/* Cross */
.cross{position:fixed;z-index:1;pointer-events:none}
.cross-v{position:absolute;width:4px;height:120px;left:50%;top:50%;transform:translate(-50%,-60%);
  background:linear-gradient(to bottom,transparent,var(--glow),transparent);opacity:.3}
.cross-h{position:absolute;width:80px;height:4px;left:50%;top:50%;transform:translate(-50%,-80%);
  background:linear-gradient(to right,transparent,var(--glow),transparent);opacity:.3}

/* BPM indicator */
.bpm{position:fixed;bottom:16px;right:16px;z-index:10;font-family:monospace;font-size:.6rem;
  color:rgba(255,255,255,.25);letter-spacing:.1em}

/* Start overlay */
.start-overlay{position:fixed;inset:0;z-index:100;background:rgba(0,0,0,.95);
  display:flex;flex-direction:column;align-items:center;justify-content:center;cursor:pointer;transition:opacity .5s}
.start-overlay.hidden{opacity:0;pointer-events:none}
.start-title{font-family:'Times New Roman',serif;font-size:clamp(2rem,6vw,4rem);font-weight:700;
  background:linear-gradient(135deg,#e040fb,#00e5ff,#ffea00);-webkit-background-clip:text;-webkit-text-fill-color:transparent;
  text-shadow:none;margin-bottom:12px}
.start-sub{font-family:monospace;font-size:.7rem;color:rgba(255,255,255,.4);letter-spacing:.15em;text-transform:uppercase;
  animation:blink-start 1.5s ease-in-out infinite}
@keyframes blink-start{0%,100%{opacity:.4}50%{opacity:1}}
</style>
</head>
<body>
<canvas id="c"></canvas>

<div class="cross" id="cross">
  <div class="cross-v"></div>
  <div class="cross-h"></div>
</div>

<div class="verse-layer">
  <div class="verse-box">
    <div class="verse-text" id="verse-text"></div>
    <div class="verse-ref" id="verse-ref"></div>
  </div>
</div>

<div class="bpm" id="bpm">♱ 128 BPM</div>

<div class="start-overlay" id="start" onclick="enterChurch()">
  <div class="start-title">⛪ RAVE CHURCH</div>
  <div class="start-sub">click to enter</div>
</div>

<script>
// ═══════════════════════════════════════
// NEON SCRIPTURE
// ═══════════════════════════════════════
const VERSES = [
  { text: "And God said, Let there be light: and there was light.", ref: "Genesis 1:3" },
  { text: "The light shines in the darkness, and the darkness has not overcome it.", ref: "John 1:5" },
  { text: "I am the way, the truth, and the life.", ref: "John 14:6" },
  { text: "Be still, and know that I am God.", ref: "Psalm 46:10" },
  { text: "For where two or three gather in my name, there am I with them.", ref: "Matthew 18:20" },
  { text: "The Lord is my shepherd; I shall not want.", ref: "Psalm 23:1" },
  { text: "I can do all things through Christ who strengthens me.", ref: "Philippians 4:13" },
  { text: "Fear not, for I am with you.", ref: "Isaiah 41:10" },
  { text: "In the beginning was the Word, and the Word was with God.", ref: "John 1:1" },
  { text: "He makes me lie down in green pastures. He leads me beside still waters.", ref: "Psalm 23:2" },
  { text: "Blessed are the pure in heart, for they shall see God.", ref: "Matthew 5:8" },
  { text: "For God so loved the world, that he gave his only begotten Son.", ref: "John 3:16" },
  { text: "Your word is a lamp to my feet and a light to my path.", ref: "Psalm 119:105" },
  { text: "And now these three remain: faith, hope and love. But the greatest of these is love.", ref: "1 Corinthians 13:13" },
  { text: "Every good gift and every perfect gift is from above, coming down from the Father of lights.", ref: "James 1:17" },
  { text: "The heavens declare the glory of God; the skies proclaim the work of his hands.", ref: "Psalm 19:1" },
  { text: "Create in me a clean heart, O God, and renew a right spirit within me.", ref: "Psalm 51:10" },
  { text: "I have told you these things, so that in me you may have peace.", ref: "John 16:33" },
  { text: "Come to me, all you who are weary and burdened, and I will give you rest.", ref: "Matthew 11:28" },
  { text: "The earth is the Lord's, and everything in it.", ref: "Psalm 24:1" },
];

const NEON_SCHEMES = [
  { color: '#e040fb', glow: '#e040fb', glow2: '#7c4dff' },
  { color: '#00e5ff', glow: '#00e5ff', glow2: '#1de9b6' },
  { color: '#ffea00', glow: '#ffea00', glow2: '#ff6d00' },
  { color: '#ff1744', glow: '#ff1744', glow2: '#f50057' },
  { color: '#76ff03', glow: '#76ff03', glow2: '#00e676' },
  { color: '#d500f9', glow: '#d500f9', glow2: '#651fff' },
  { color: '#00b0ff', glow: '#00b0ff', glow2: '#304ffe' },
  { color: '#ff9100', glow: '#ff9100', glow2: '#ff3d00' },
];

let verseIdx = 0;
let schemeIdx = 0;

function nextVerse() {
  verseIdx = (verseIdx + 1) % VERSES.length;
  schemeIdx = (schemeIdx + 1) % NEON_SCHEMES.length;
  const v = VERSES[verseIdx];
  const s = NEON_SCHEMES[schemeIdx];

  const el = document.getElementById('verse-text');
  const ref = document.getElementById('verse-ref');
  const cross = document.getElementById('cross');

  // Fade out
  el.style.opacity = '0';
  el.style.transform = 'scale(0.9) rotateY(10deg)';

  setTimeout(() => {
    document.documentElement.style.setProperty('--glow', s.glow);
    document.documentElement.style.setProperty('--glow2', s.glow2);
    el.style.color = s.color;
    ref.style.color = s.color;
    cross.querySelector('.cross-v').style.background = `linear-gradient(to bottom,transparent,${s.glow},transparent)`;
    cross.querySelector('.cross-h').style.background = `linear-gradient(to right,transparent,${s.glow},transparent)`;
    el.textContent = v.text;
    ref.textContent = '— ' + v.ref;
    el.style.opacity = '1';
    el.style.transform = 'scale(1) rotateY(0deg)';
  }, 600);
}

// ═══════════════════════════════════════
// PROCEDURAL TECHNO VISUALS (Canvas)
// ═══════════════════════════════════════
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
let W, H, time = 0, bpm = 128, beatPhase = 0;
let mouseX = 0.5, mouseY = 0.5;
let started = false;

function resize() {
  W = canvas.width = window.innerWidth;
  H = canvas.height = window.innerHeight;
}
window.addEventListener('resize', resize);
resize();

window.addEventListener('mousemove', e => {
  mouseX = e.clientX / W;
  mouseY = e.clientY / H;
});
window.addEventListener('touchmove', e => {
  mouseX = e.touches[0].clientX / W;
  mouseY = e.touches[0].clientY / H;
}, { passive: true });

// Beat sync
function getBeat() {
  const beatsPerSec = bpm / 60;
  return (time * beatsPerSec) % 1;
}

function getBar() {
  const beatsPerSec = bpm / 60;
  return ((time * beatsPerSec) / 4) % 1;
}

// ── Visual layers ──

function drawTunnel() {
  const beat = getBeat();
  const kick = Math.pow(Math.max(0, 1 - beat * 4), 3);
  const cx = W / 2 + Math.sin(time * 0.3) * 60 * mouseX;
  const cy = H / 2 + Math.cos(time * 0.4) * 40 * mouseY;

  for (let i = 20; i >= 0; i--) {
    const t = (i / 20 + time * 0.15) % 1;
    const size = t * Math.max(W, H) * 0.9 + kick * 40;
    const hue = (time * 30 + i * 18) % 360;
    const alpha = (1 - t) * 0.3;
    const sides = 3 + Math.floor(mouseX * 5);

    ctx.strokeStyle = `hsla(${hue}, 100%, 60%, ${alpha})`;
    ctx.lineWidth = 1.5 + kick * 3;
    ctx.beginPath();
    for (let s = 0; s <= sides; s++) {
      const angle = (s / sides) * Math.PI * 2 + time * 0.5 + i * 0.15;
      const x = cx + Math.cos(angle) * size;
      const y = cy + Math.sin(angle) * size;
      s === 0 ? ctx.moveTo(x, y) : ctx.lineTo(x, y);
    }
    ctx.closePath();
    ctx.stroke();
  }
}

function drawLaserGrid() {
  const bar = getBar();
  const intensity = 0.15 + Math.pow(Math.sin(bar * Math.PI), 2) * 0.2;
  const hue = (time * 20 + 180) % 360;

  ctx.strokeStyle = `hsla(${hue}, 100%, 50%, ${intensity})`;
  ctx.lineWidth = 0.5;

  // Horizontal perspective lines
  for (let i = 0; i < 15; i++) {
    const y = H * 0.5 + (i - 7) * (30 + Math.sin(time + i) * 10);
    ctx.beginPath();
    ctx.moveTo(0, y + Math.sin(time * 2 + i * 0.5) * 5);
    ctx.lineTo(W, y + Math.sin(time * 2 + i * 0.5 + 3) * 5);
    ctx.stroke();
  }

  // Vertical converging lines
  const vanishX = W * mouseX;
  const vanishY = H * mouseY;
  for (let i = 0; i < 12; i++) {
    const angle = (i / 12) * Math.PI * 2;
    const dist = Math.max(W, H);
    ctx.beginPath();
    ctx.moveTo(vanishX, vanishY);
    ctx.lineTo(vanishX + Math.cos(angle + time * 0.1) * dist, vanishY + Math.sin(angle + time * 0.1) * dist);
    ctx.stroke();
  }
}

function drawStainedGlass() {
  const bar = getBar();
  const segments = 6 + Math.floor(mouseY * 6);
  const cx = W / 2, cy = H / 2;
  const maxR = Math.min(W, H) * 0.4;
  const rotation = time * 0.2;
  const breathe = 1 + Math.sin(time * 0.8) * 0.1;

  for (let ring = 0; ring < 4; ring++) {
    const r = maxR * (0.3 + ring * 0.2) * breathe;
    for (let i = 0; i < segments; i++) {
      const a1 = (i / segments) * Math.PI * 2 + rotation + ring * 0.3;
      const a2 = ((i + 1) / segments) * Math.PI * 2 + rotation + ring * 0.3;
      const hue = (time * 15 + i * (360 / segments) + ring * 60) % 360;
      const alpha = 0.08 + Math.sin(time * 3 + i + ring) * 0.04;

      ctx.fillStyle = `hsla(${hue}, 90%, 55%, ${alpha})`;
      ctx.beginPath();
      ctx.moveTo(cx, cy);
      ctx.arc(cx, cy, r, a1, a2);
      ctx.closePath();
      ctx.fill();

      // Outline
      ctx.strokeStyle = `hsla(${hue}, 100%, 70%, ${alpha * 2})`;
      ctx.lineWidth = 0.5;
      ctx.stroke();
    }
  }
}

function drawParticleField() {
  const beat = getBeat();
  const kick = Math.pow(Math.max(0, 1 - beat * 5), 2);
  const count = 60;

  for (let i = 0; i < count; i++) {
    const seed = i * 7919;
    const px = ((seed * 13 + time * 30) % W + W) % W;
    const py = ((seed * 17 + time * 20 + Math.sin(seed + time) * 50) % H + H) % H;
    const hue = (time * 40 + i * 6) % 360;
    const size = 1 + Math.sin(time * 4 + i) * 1 + kick * 3;
    const alpha = 0.3 + Math.sin(time * 3 + i * 0.7) * 0.2;

    ctx.fillStyle = `hsla(${hue}, 100%, 70%, ${alpha})`;
    ctx.beginPath();
    ctx.arc(px, py, size, 0, Math.PI * 2);
    ctx.fill();
  }
}

function drawScanlines() {
  ctx.fillStyle = 'rgba(0,0,0,0.03)';
  for (let y = 0; y < H; y += 3) {
    ctx.fillRect(0, y, W, 1);
  }
}

function drawVignette() {
  const grad = ctx.createRadialGradient(W/2, H/2, Math.min(W,H)*0.2, W/2, H/2, Math.max(W,H)*0.7);
  grad.addColorStop(0, 'rgba(0,0,0,0)');
  grad.addColorStop(1, 'rgba(0,0,0,0.7)');
  ctx.fillStyle = grad;
  ctx.fillRect(0, 0, W, H);
}

// ── Main loop ──
let lastTime = 0;
function frame(ts) {
  if (!started) { requestAnimationFrame(frame); return; }
  const dt = Math.min((ts - lastTime) / 1000, 0.05);
  lastTime = ts;
  time += dt;
  beatPhase = getBeat();

  // Clear with slight trail
  ctx.fillStyle = 'rgba(0,0,0,0.15)';
  ctx.fillRect(0, 0, W, H);

  // Layers
  drawStainedGlass();
  drawLaserGrid();
  drawTunnel();
  drawParticleField();
  drawScanlines();
  drawVignette();

  // Beat-synced flash
  const kick = Math.pow(Math.max(0, 1 - beatPhase * 6), 4);
  if (kick > 0.5) {
    ctx.fillStyle = `rgba(255,255,255,${kick * 0.04})`;
    ctx.fillRect(0, 0, W, H);
  }

  // Cross glow on beat
  const cross = document.getElementById('cross');
  cross.style.opacity = 0.2 + kick * 0.4;

  requestAnimationFrame(frame);
}
requestAnimationFrame(frame);

// ── BPM control via scroll ──
window.addEventListener('wheel', e => {
  bpm = Math.max(60, Math.min(200, bpm + (e.deltaY > 0 ? -2 : 2)));
  document.getElementById('bpm').textContent = '♱ ' + bpm + ' BPM';
}, { passive: true });

// ── Verse cycle ──
let verseInterval;

window.enterChurch = function() {
  document.getElementById('start').classList.add('hidden');
  started = true;
  lastTime = performance.now();

  // Set initial scheme
  const s = NEON_SCHEMES[0];
  document.documentElement.style.setProperty('--glow', s.glow);
  document.documentElement.style.setProperty('--glow2', s.glow2);
  const el = document.getElementById('verse-text');
  const ref = document.getElementById('verse-ref');
  el.style.color = s.color;
  ref.style.color = s.color;
  el.textContent = VERSES[0].text;
  ref.textContent = '— ' + VERSES[0].ref;

  // Cycle verses every 8 seconds
  verseInterval = setInterval(nextVerse, 8000);
};

// Click anywhere for manual verse advance
document.addEventListener('click', e => {
  if (!started || e.target.closest('.start-overlay') || e.target.closest('.sloppy-bar')) return;
  clearInterval(verseInterval);
  nextVerse();
  verseInterval = setInterval(nextVerse, 8000);
});
</script>
<script src="/sloppy-header/sloppy-bar.js" data-position="bottom" data-minimized="true"></script>
<script src="/vibelib-extended.js"></script>
<script>
  // Compatibility Patch for Legacy Apps
  window.addEventListener("load", () => {
    if (window.SloppyKarma && window.VibeLib.Economy) {
      // Redirect old calls to new engine
      window.SloppyKarma.track = window.VibeLib.Economy.track;
    }
  });
</script>
</body>
</html>
