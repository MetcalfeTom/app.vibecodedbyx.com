<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Who Is Gary?</title>
    <link rel="icon" href="https://emojicdn.elk.sh/üëÅÔ∏è">

    <meta property="og:title" content="Who Is Gary?">
    <meta property="og:description" content="Some questions are better left unanswered.">
    <meta property="og:url" content="https://app.sloppy.live/who-is-gary">
    <meta property="og:image" content="https://image.pollinations.ai/prompt/dark%20noir%20silhouette%20mysterious%20figure%20rain%20shadows%20paranoid%20thriller%20film%20grain?width=1200&height=630&nologo=true&referrer=sloppy.live">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Special+Elite&family=EB+Garamond:ital,wght@0,400;0,700;1,400&family=VT323&display=swap" rel="stylesheet">

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --void: #0a0a0a;
            --smoke: #1a1a1a;
            --ash: #2a2a2a;
            --fog: #3a3a3a;
            --mist: #888;
            --bone: #c4c4b4;
            --blood: #6b0f1a;
            --amber: #d4a84b;
            --static: #4a5568;
        }

        body {
            font-family: 'EB Garamond', serif;
            background: var(--void);
            min-height: 100vh;
            color: var(--bone);
            overflow-x: hidden;
            cursor: default;
        }

        .static-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: url('data:image/svg+xml,<svg viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="4" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23n)" opacity="0.03"/></svg>');
            pointer-events: none;
            z-index: 1000;
            animation: flicker 0.15s infinite;
        }

        @keyframes flicker {
            0%, 100% { opacity: 0.03; }
            50% { opacity: 0.05; }
        }

        .vignette {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: radial-gradient(ellipse at center, transparent 0%, var(--void) 90%);
            pointer-events: none;
            z-index: 999;
        }

        .rain {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            pointer-events: none;
            z-index: 998;
            opacity: 0.1;
            background: repeating-linear-gradient(
                transparent 0px,
                transparent 3px,
                rgba(200,200,200,0.03) 3px,
                rgba(200,200,200,0.03) 4px
            );
            animation: rain 0.3s linear infinite;
        }

        @keyframes rain { to { background-position: 0 40px; } }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
            z-index: 1;
        }

        .header {
            text-align: center;
            margin-bottom: 60px;
            opacity: 0;
            animation: fadeIn 3s 0.5s forwards;
        }

        @keyframes fadeIn { to { opacity: 1; } }

        .title {
            font-family: 'Special Elite', monospace;
            font-size: clamp(2.5rem, 10vw, 5rem);
            letter-spacing: 8px;
            color: var(--bone);
            text-shadow: 0 0 60px rgba(107,15,26,0.5);
            margin-bottom: 20px;
        }

        .subtitle {
            font-style: italic;
            color: var(--mist);
            font-size: 1.1rem;
            letter-spacing: 3px;
        }

        .clearance-level {
            margin-top: 15px;
            font-family: 'VT323', monospace;
            font-size: 0.9rem;
            color: var(--blood);
            letter-spacing: 2px;
        }

        .dossier {
            background: linear-gradient(180deg, var(--smoke) 0%, var(--void) 100%);
            border: 1px solid var(--fog);
            padding: 40px;
            margin-bottom: 40px;
            position: relative;
        }

        .dossier::before {
            content: '';
            position: absolute;
            top: 0; left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--blood), transparent);
        }

        .intro-text {
            font-size: 1.15rem;
            line-height: 2;
            color: var(--mist);
            max-width: 700px;
        }

        .intro-text em { color: var(--amber); font-style: normal; }

        .redacted {
            background: var(--bone);
            color: var(--bone);
            cursor: pointer;
            transition: all 0.3s;
            padding: 0 4px;
        }

        .redacted:hover, .redacted.revealed {
            background: transparent;
            color: var(--blood);
        }

        .tabs {
            display: flex;
            gap: 2px;
            margin-bottom: 2px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 20px;
            background: var(--ash);
            color: var(--mist);
            cursor: pointer;
            font-family: 'Special Elite', monospace;
            font-size: 0.85rem;
            transition: all 0.3s;
            border: 1px solid transparent;
        }

        .tab:hover { background: var(--fog); }
        .tab.active {
            background: var(--smoke);
            color: var(--amber);
            border-color: var(--fog);
            border-bottom-color: var(--smoke);
        }

        .tab-content {
            display: none;
            background: var(--smoke);
            border: 1px solid var(--fog);
            padding: 30px;
            min-height: 400px;
        }

        .tab-content.active { display: block; }

        .evidence-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 2px;
            background: var(--fog);
        }

        .evidence-cell {
            aspect-ratio: 1;
            background: var(--smoke);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: all 0.3s;
            padding: 10px;
        }

        .evidence-cell::before {
            content: '';
            position: absolute;
            inset: 0;
            background: radial-gradient(circle at center, transparent 30%, var(--void) 100%);
            opacity: 0.5;
        }

        .evidence-cell:hover { background: var(--ash); }
        .evidence-cell.unlocked { background: var(--ash); }
        .evidence-cell.unlocked::after {
            content: '‚úì';
            position: absolute;
            top: 5px;
            right: 8px;
            color: var(--amber);
            font-size: 0.8rem;
        }

        .cell-icon {
            font-size: 1.8rem;
            position: relative;
            z-index: 1;
            filter: grayscale(80%);
            transition: all 0.3s;
        }

        .evidence-cell:hover .cell-icon,
        .evidence-cell.unlocked .cell-icon { filter: grayscale(0%); }
        .evidence-cell.locked .cell-icon { opacity: 0.15; }

        .cell-label {
            font-family: 'Special Elite', monospace;
            font-size: 0.65rem;
            color: var(--fog);
            margin-top: 8px;
            text-align: center;
            position: relative;
            z-index: 1;
            line-height: 1.2;
        }

        .evidence-cell.unlocked .cell-label { color: var(--mist); }

        .modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.97);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .modal.open { display: flex; }

        .modal-content {
            max-width: 650px;
            max-height: 85vh;
            overflow-y: auto;
            background: var(--smoke);
            border: 1px solid var(--fog);
            padding: 40px;
            position: relative;
            animation: modalIn 0.3s ease;
        }

        @keyframes modalIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--mist);
        }

        .modal-close:hover { color: var(--blood); }

        .modal-title {
            font-family: 'Special Elite', monospace;
            font-size: 1.3rem;
            color: var(--amber);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--fog);
        }

        .modal-text {
            line-height: 1.9;
            color: var(--mist);
            font-size: 0.95rem;
        }

        .modal-text .secret-word {
            color: var(--bone);
            cursor: help;
            border-bottom: 1px dotted var(--fog);
        }

        .modal-text .secret-word:hover { color: var(--amber); }

        .modal-hint {
            margin-top: 20px;
            padding: 15px;
            background: var(--void);
            font-style: italic;
            font-size: 0.85rem;
            color: var(--fog);
            border-left: 2px solid var(--blood);
        }

        .modal-coords {
            margin-top: 15px;
            font-family: 'VT323', monospace;
            font-size: 0.9rem;
            color: var(--static);
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            padding: 20px;
            background: var(--void);
            border: 1px solid var(--fog);
            margin: 30px 0;
            font-family: 'Special Elite', monospace;
            font-size: 0.8rem;
        }

        .stat { color: var(--mist); }
        .stat-value { color: var(--amber); }

        .timeline {
            position: relative;
            padding-left: 30px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 10px;
            top: 0;
            bottom: 0;
            width: 1px;
            background: linear-gradient(to bottom, transparent, var(--fog), transparent);
        }

        .timeline-entry {
            position: relative;
            margin-bottom: 25px;
            opacity: 0;
            transform: translateX(-20px);
            transition: all 0.5s;
        }

        .timeline-entry.visible { opacity: 1; transform: translateX(0); }

        .timeline-entry::before {
            content: '';
            position: absolute;
            left: -24px;
            top: 6px;
            width: 6px;
            height: 6px;
            background: var(--blood);
            border-radius: 50%;
        }

        .timeline-entry.anomaly::before { background: var(--amber); box-shadow: 0 0 10px var(--amber); }

        .timeline-date {
            font-family: 'Special Elite', monospace;
            font-size: 0.8rem;
            color: var(--fog);
            margin-bottom: 3px;
        }

        .timeline-text { color: var(--mist); line-height: 1.6; font-size: 0.9rem; }

        .witness-list { display: flex; flex-direction: column; gap: 20px; }

        .witness-card {
            background: var(--void);
            border: 1px solid var(--fog);
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .witness-card:hover { border-color: var(--amber); }
        .witness-card.read { opacity: 0.6; }

        .witness-name {
            font-family: 'Special Elite', monospace;
            color: var(--amber);
            margin-bottom: 8px;
        }

        .witness-preview { color: var(--fog); font-style: italic; font-size: 0.9rem; }

        .numbers-station {
            background: var(--void);
            border: 1px solid var(--blood);
            padding: 20px;
            font-family: 'VT323', monospace;
            color: var(--static);
            margin: 20px 0;
        }

        .numbers-station .freq { color: var(--blood); font-size: 0.9rem; margin-bottom: 10px; }
        .numbers-station .transmission { font-size: 1.2rem; letter-spacing: 4px; line-height: 2; word-break: break-all; }

        .hidden-section {
            display: none;
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, rgba(107,15,26,0.3) 0%, var(--void) 100%);
            border: 1px solid var(--blood);
        }

        .hidden-section.revealed { display: block; animation: pulseGlow 3s infinite; }

        @keyframes pulseGlow {
            0%, 100% { box-shadow: 0 0 20px rgba(107,15,26,0.3); }
            50% { box-shadow: 0 0 40px rgba(107,15,26,0.5); }
        }

        .hidden-section h3 {
            font-family: 'Special Elite', monospace;
            color: var(--amber);
            margin-bottom: 15px;
            font-size: 1rem;
        }

        .cipher {
            font-family: 'VT323', monospace;
            letter-spacing: 3px;
            color: var(--fog);
            word-break: break-all;
            font-size: 1.1rem;
            line-height: 1.8;
        }

        .secret-input {
            margin-top: 20px;
            display: flex;
            gap: 10px;
        }

        .secret-input input {
            flex: 1;
            background: var(--void);
            border: 1px solid var(--fog);
            padding: 12px 15px;
            color: var(--bone);
            font-family: 'Special Elite', monospace;
            font-size: 0.9rem;
        }

        .secret-input input::placeholder { color: var(--fog); }

        .secret-input button {
            background: var(--blood);
            border: none;
            padding: 12px 20px;
            color: var(--bone);
            cursor: pointer;
            font-family: 'Special Elite', monospace;
        }

        .secret-input button:hover { background: #8b1a27; }

        .photo-wall {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 8px;
        }

        .photo-wall img {
            width: 100%;
            aspect-ratio: 1;
            object-fit: cover;
            filter: grayscale(100%) contrast(1.2);
            transition: all 0.3s;
            cursor: pointer;
        }

        .photo-wall img:hover {
            filter: grayscale(50%) contrast(1.1);
            transform: scale(1.05);
            z-index: 10;
            position: relative;
        }

        .coordinates-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .coord-card {
            background: var(--void);
            border: 1px solid var(--fog);
            padding: 15px;
            font-family: 'VT323', monospace;
            cursor: pointer;
            transition: all 0.3s;
        }

        .coord-card:hover { border-color: var(--amber); }
        .coord-card .location { color: var(--amber); margin-bottom: 5px; }
        .coord-card .coords { color: var(--static); font-size: 0.9rem; }
        .coord-card .note { color: var(--fog); font-size: 0.85rem; margin-top: 8px; font-style: italic; }

        .anomaly-log {
            font-family: 'VT323', monospace;
            background: var(--void);
            padding: 20px;
            border: 1px solid var(--blood);
            max-height: 300px;
            overflow-y: auto;
        }

        .anomaly-entry {
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--ash);
        }

        .anomaly-entry:last-child { border-bottom: none; }
        .anomaly-id { color: var(--blood); }
        .anomaly-desc { color: var(--mist); margin-left: 10px; }

        .ending {
            display: none;
            text-align: center;
            padding: 60px 20px;
            background: var(--void);
            border: 1px solid var(--fog);
            margin-top: 40px;
        }

        .ending.show { display: block; animation: fadeIn 2s forwards; }

        .ending h2 {
            font-family: 'Special Elite', monospace;
            font-size: 1.8rem;
            margin-bottom: 30px;
        }

        .ending p {
            max-width: 550px;
            margin: 0 auto 20px;
            line-height: 1.9;
            color: var(--mist);
        }

        .ending.dark h2 { color: var(--blood); }
        .ending.truth h2 { color: var(--amber); }
        .ending.void h2 { color: var(--fog); }
        .ending.gary h2 { color: var(--bone); }
        .ending.loop h2 { color: var(--static); }

        .whispers {
            position: fixed;
            bottom: 30px;
            left: 30px;
            font-style: italic;
            color: var(--fog);
            font-size: 0.85rem;
            opacity: 0;
            cursor: pointer;
            max-width: 250px;
        }

        .whispers.show { animation: whisperCycle 20s forwards; }

        @keyframes whisperCycle {
            0%, 100% { opacity: 0; }
            5%, 15% { opacity: 0.6; }
            20%, 30% { opacity: 0; }
            35%, 45% { opacity: 0.5; }
            50%, 60% { opacity: 0; }
            65%, 75% { opacity: 0.4; }
            80% { opacity: 0; }
        }

        .backlink {
            position: fixed;
            bottom: 20px;
            right: 20px;
            font-family: 'Special Elite', monospace;
            font-size: 10px;
            color: var(--fog);
            text-decoration: none;
            opacity: 0.4;
        }

        .glitch {
            animation: glitch 0.3s infinite;
        }

        @keyframes glitch {
            0% { transform: translate(0); }
            20% { transform: translate(-2px, 2px); }
            40% { transform: translate(-2px, -2px); }
            60% { transform: translate(2px, 2px); }
            80% { transform: translate(2px, -2px); }
            100% { transform: translate(0); }
        }

        .blink { animation: blink 1s infinite; }
        @keyframes blink { 0%, 50% { opacity: 1; } 51%, 100% { opacity: 0; } }

        .depth-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            font-family: 'VT323', monospace;
            font-size: 0.8rem;
            color: var(--fog);
            text-align: right;
        }

        .depth-indicator .level { color: var(--blood); }

        @media (max-width: 600px) {
            .evidence-grid { grid-template-columns: repeat(3, 1fr); }
            .photo-wall { grid-template-columns: repeat(2, 1fr); }
            .modal-content { padding: 25px; }
            .tabs { gap: 1px; }
            .tab { padding: 10px 12px; font-size: 0.75rem; }
        }
    </style>
</head>
<body>
    <div class="static-overlay"></div>
    <div class="vignette"></div>
    <div class="rain"></div>

    <div class="depth-indicator">
        DEPTH: <span class="level" id="depthLevel">1</span>/7<br>
        <span id="depthStatus">SURFACE</span>
    </div>

    <div class="container">
        <header class="header">
            <h1 class="title">WHO IS GARY?</h1>
            <p class="subtitle">Case File #G-4827 ‚Ä¢ Status: UNSOLVED</p>
            <p class="clearance-level">CLEARANCE REQUIRED: <span id="clearanceText">LEVEL 1</span></p>
        </header>

        <div class="dossier">
            <p class="intro-text">
                Subject identified only as <em>"Gary"</em> first appeared in municipal records
                on <span class="redacted" data-reveal="March 17, 1987">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span>.
                Multiple witnesses report sightings across <span class="redacted" data-reveal="12 states">‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span>
                during the same timeframe‚Äîan <span class="redacted" data-reveal="impossibility">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span>.
                Fingerprints match <span class="redacted" data-reveal="7 different individuals">‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà</span>,
                all of whom died before <span class="redacted" data-reveal="1947">‚ñà‚ñà‚ñà‚ñà</span>.
                <br><br>
                This archive contains recovered fragments. The deeper you go, the less you'll understand.
                Some investigators never returned. Others returned... <em>different</em>.
            </p>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="showTab('evidence')">Evidence</div>
            <div class="tab" onclick="showTab('timeline')">Timeline</div>
            <div class="tab" onclick="showTab('witnesses')">Witnesses</div>
            <div class="tab" onclick="showTab('signals')">Signals</div>
            <div class="tab" onclick="showTab('locations')">Locations</div>
            <div class="tab" onclick="showTab('anomalies')">Anomalies</div>
            <div class="tab" onclick="showTab('photos')">Photos</div>
        </div>

        <div class="tab-content active" id="tab-evidence">
            <div class="evidence-grid" id="evidenceGrid"></div>
        </div>

        <div class="tab-content" id="tab-timeline">
            <div class="timeline" id="timeline"></div>
        </div>

        <div class="tab-content" id="tab-witnesses">
            <div class="witness-list" id="witnessList"></div>
        </div>

        <div class="tab-content" id="tab-signals">
            <p style="color: var(--mist); margin-bottom: 20px; font-style: italic;">
                Intercepted transmissions believed to reference subject G.
            </p>
            <div id="signalsList"></div>
        </div>

        <div class="tab-content" id="tab-locations">
            <p style="color: var(--mist); margin-bottom: 20px; font-style: italic;">
                Coordinates of confirmed and suspected sightings.
            </p>
            <div class="coordinates-panel" id="coordsPanel"></div>
        </div>

        <div class="tab-content" id="tab-anomalies">
            <p style="color: var(--mist); margin-bottom: 20px; font-style: italic;">
                Unexplained phenomena associated with the investigation.
            </p>
            <div class="anomaly-log" id="anomalyLog"></div>
        </div>

        <div class="tab-content" id="tab-photos">
            <div class="photo-wall" id="photoWall"></div>
        </div>

        <div class="stats">
            <div class="stat">Evidence: <span class="stat-value" id="evidenceCount">0</span>/<span id="evidenceTotal">24</span></div>
            <div class="stat">Secrets: <span class="stat-value" id="secretCount">0</span>/12</div>
            <div class="stat">Depth: <span class="stat-value" id="depthStat">1</span>/7</div>
            <div class="stat">Truth: <span class="stat-value" id="truthLevel">0%</span></div>
            <div class="stat">Sanity: <span class="stat-value" id="sanityLevel">100%</span></div>
        </div>

        <div class="hidden-section" id="secretSection">
            <h3>[ RECOVERED TRANSMISSION ‚Äî ORIGIN UNKNOWN ]</h3>
            <p class="cipher" id="cipherText"></p>
            <div class="secret-input">
                <input type="text" id="codeInput" placeholder="Enter decryption key...">
                <button onclick="attemptDecode()">DECODE</button>
            </div>
        </div>

        <div class="hidden-section" id="deepSection" style="border-color: var(--amber);">
            <h3>[ LEVEL 5 CLEARANCE ‚Äî EYES ONLY ]</h3>
            <p style="color: var(--mist); line-height: 1.8;" id="deepText"></p>
        </div>

        <div class="hidden-section" id="finalSection" style="border-color: var(--bone);">
            <h3 class="glitch">[ ??? ]</h3>
            <p style="color: var(--mist); line-height: 1.8;" id="finalText"></p>
        </div>

        <div class="ending" id="ending">
            <h2 id="endingTitle"></h2>
            <p id="endingText"></p>
            <p style="margin-top: 40px; color: var(--fog); font-size: 0.9rem;">
                <span style="cursor: pointer;" onclick="resetAll()">[ Begin new investigation ]</span>
            </p>
        </div>
    </div>

    <div class="whispers" id="whispers"></div>

    <a href="https://sloppy.live" class="backlink" target="_blank">VCBX</a>

    <div class="modal" id="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal()">√ó</span>
            <h3 class="modal-title" id="modalTitle"></h3>
            <div class="modal-text" id="modalText"></div>
            <div class="modal-hint" id="modalHint"></div>
            <div class="modal-coords" id="modalCoords"></div>
        </div>
    </div>

    <script>
        const state = {
            evidence: new Set(),
            secrets: new Set(),
            witnesses: new Set(),
            locations: new Set(),
            anomalies: new Set(),
            depth: 1,
            sanity: 100,
            codeAttempts: 0,
            konamiProgress: 0,
            truthPath: null
        };

        const konamiCode = [38, 38, 40, 40, 37, 39, 37, 39, 66, 65];

        const evidence = [
            // DEPTH 1 - Surface
            { id: 'cassette', icon: 'üìº', label: 'Audio #7', depth: 1, text: `A distorted voice over static: "...Gary isn't his real name. None of the names are real. He changes them like <span class="secret-word" data-secret="skins">seasons</span>. I've been tracking him since Cincinnati. The cities blur together when you're chasing a <span class="secret-word" data-secret="ghost">phantom</span>..."<br><br>The tape degrades into white noise. Then, faintly: coordinates.`, hint: 'The highlighted words unlock deeper meanings.', coords: '39.1031¬∞ N, 84.5120¬∞ W' },
            { id: 'photo', icon: 'üì∑', label: 'Polaroid', depth: 1, text: `A water-stained polaroid. A man stands before a diner, face obscured by light damage. On the back: "G. ‚Äî Last confirmed. <span class="secret-word" data-secret="1994">He smiled like he knew.</span>"<br><br>The diner burned in '96. Three witnesses saw a figure leave moments before. He was whistling.`, hint: 'The year is a key.', coords: '41.8781¬∞ N, 87.6298¬∞ W' },
            { id: 'letter', icon: '‚úâÔ∏è', label: 'Unsent Letter', depth: 1, text: `"Dear Gary,<br><br>I know what you did at the lake house. I know why you had to leave. What I don't understand is why you keep coming back‚Äîwearing different <span class="secret-word" data-secret="faces">masks</span> but the same tired <span class="secret-word" data-secret="eyes">expression</span>.<br><br>There is no absolution for men like us."<br><br>Found in a library book returned 23 years late. The borrower's card was blank.`, hint: 'What remains constant?' },
            { id: 'map', icon: 'üó∫Ô∏è', label: 'Annotated Map', depth: 1, text: `A 1989 road map covered in red circles. The pattern forms a constellation‚Äîor a message.<br><br>Cities: <em>Gary, Indiana. Port Gary. Garyville. Mount Gary.</em><br><br>Margin note: "He's not running <em>from</em> something. He's running <em>toward</em> it."<br><br>The lines, when connected, spell a word in an alphabet that shouldn't exist.`, hint: 'The name appears in places.' },
            { id: 'badge', icon: 'ü™™', label: 'Employee ID', depth: 1, text: `Laminated ID, name scratched: "G‚ñà‚ñà‚ñà ‚ñà‚ñà‚ñà‚ñàner"<br>Position: Night Security<br>Facility: <span class="secret-word" data-secret="monarch">[REDACTED]</span> Research Institute<br>Access Level: 7<br><br>The photo shows an unremarkable man. The kind of face you'd forget. That was the point.`, hint: 'Level 7 clearance is significant.' },

            // DEPTH 2 - Deeper
            { id: 'diary', icon: 'üìì', label: 'Journal', depth: 2, requires: ['cassette', 'photo'], text: `"...they keep asking who Gary is. Wrong question. Gary isn't a who‚ÄîGary is a <span class="secret-word" data-secret="role">position</span>. When one Gary ends, another begins. I've been Gary for eleven years. Soon it will be someone else's turn.<br><br>The process is painless. You simply... forget who you were. And remember who you've always been."<br><br>The handwriting changes midway through the entry.`, hint: 'Gary is a role. Who fills it?' },
            { id: 'key', icon: 'üîë', label: 'Deposit Key', depth: 2, requires: ['map', 'badge'], text: `Brass key, heavily worn. Tag: "First National Bank, Box <span class="secret-word" data-secret="1947">1947</span>."<br><br>The bank burned in '52. Three witnesses saw a man matching Gary's description leave before the fire. He was carrying a manila envelope.<br><br>The fire inspector's report was sealed. The inspector disappeared a week later.`, hint: 'Numbers form sequences.' },
            { id: 'vinyl', icon: 'üíø', label: 'Record', depth: 2, requires: ['letter', 'cassette'], text: `A 78 RPM record, no label. When played, a voice recites prime numbers for 3 minutes and 17 seconds. Then:<br><br>"Gary remembers what you've forgotten. Gary forgets what you remember. The exchange is <span class="secret-word" data-secret="fair">equitable</span>."<br><br>Played backwards, it's a lullaby in a language that predates written history.`, hint: 'Some messages are reversed.' },
            { id: 'tooth', icon: 'ü¶∑', label: 'Molar', depth: 2, requires: ['photo', 'map'], text: `A human molar, root intact. Carbon dating places it at 847 BCE. DNA analysis returns results matching 14 people currently alive.<br><br>All 14 subjects were interviewed. None remember losing a tooth. All reported dreams of a man named Gary asking them to "hold onto something" for him.<br><br>The tooth is warm to the touch.`, hint: 'Time doesn\'t work normally here.' },

            // DEPTH 3 - Murky
            { id: 'mirror', icon: 'ü™û', label: 'Mirror Shard', depth: 3, requires: ['diary', 'key'], text: `Seven fragments of a mirror, glass over 200 years old. One fragment holds a reflection‚Äîbut not of the viewer.<br><br>An indistinct figure, glimpsed only in peripheral vision. Researchers who studied it too long reported <span class="secret-word" data-secret="whispers">auditory phenomena</span>. Three resigned. One disappeared. One became Gary.<br><br>The fragment is now kept in darkness.`, hint: 'The reflection shows what we refuse to see.' },
            { id: 'film', icon: 'üéûÔ∏è', label: 'Film Reel', depth: 3, requires: ['vinyl', 'tooth'], text: `8mm footage, unlabeled. Shows a man walking through a crowd in what appears to be the 1940s. His face is always turned away or obscured.<br><br>Frame-by-frame analysis reveals he casts no shadow. In frame 847, he looks directly at the camera. That frame is missing from all copies.<br><br>Viewers report the man continues walking in their peripheral vision for days after watching.`, hint: 'Frame 847 is significant.' },
            { id: 'radio', icon: 'üìª', label: 'Radio', depth: 3, requires: ['key', 'diary'], text: `A 1950s Zenith radio that receives no known frequencies. On certain nights, at 3:17 AM, it broadcasts:<br><br>"This is Gary. If you are hearing this, you are not alone. If you are alone, you are not hearing this. The distinction matters less than you think."<br><br>The broadcasts have been verified across multiple continents simultaneously.`, hint: '3:17 AM is the witching hour for Gary.' },
            { id: 'book', icon: 'üìï', label: 'Red Book', depth: 3, requires: ['mirror', 'vinyl'], text: `A leather-bound book with no title. Every page contains the same sentence repeated: "GARY WAS HERE" in increasingly erratic handwriting.<br><br>Except page 47, which reads: "<span class="secret-word" data-secret="tulpa">We created him. Now he creates us.</span> The loop is the message. The message is the loop."<br><br>New pages appear overnight. The book grows.`, hint: 'Some things are created by belief.' },

            // DEPTH 4 - Dark
            { id: 'skull', icon: 'üíÄ', label: 'Skull Fragment', depth: 4, requires: ['mirror', 'film'], text: `Parietal bone fragment, anomalously thick. X-rays reveal micro-inscriptions: coordinates, dates, and what appears to be a <span class="secret-word" data-secret="prophecy">schedule</span>.<br><br>The dates span from 1823 to 2147. All past dates correspond to documented "Gary sightings."<br><br>The next date is tomorrow.`, hint: 'The schedule continues into the future.' },
            { id: 'watch', icon: '‚åö', label: 'Pocket Watch', depth: 4, requires: ['radio', 'book'], text: `A silver pocket watch that runs backward. The engraving reads: "To G, from G. We remember what will happen."<br><br>When opened at midnight, the face shows a different time‚Äîalways <span class="secret-word" data-secret="317">3:17</span>. Regardless of when it's opened.<br><br>The ticking sounds like a voice saying "Gary" very slowly.`, hint: '3:17 appears everywhere.' },
            { id: 'doll', icon: 'ü™Ü', label: 'Matryoshka', depth: 4, requires: ['film', 'radio'], text: `A nesting doll set, Russian origin, circa 1920. Seven dolls total. Each painted to resemble a different man. All are documented "Gary sightings."<br><br>The innermost doll is empty‚Äîor contains something that cannot be perceived directly. Looking at it induces <span class="secret-word" data-secret="vertigo">spatial disorientation</span>.<br><br>There are scorch marks on the wood. It shouldn't exist.`, hint: 'Seven layers. Seven depths.' },
            { id: 'jar', icon: 'ü´ô', label: 'Specimen Jar', depth: 4, requires: ['skull', 'book'], text: `A formaldehyde jar containing what appears to be a human shadow. Lab analysis confirms it has mass and responds to light inversely.<br><br>The shadow belonged to Gary. Or Gary belonged to the shadow. The relationship is <span class="secret-word" data-secret="symbiotic">unclear</span>.<br><br>It moves when unobserved. It watches when observed.`, hint: 'The shadow has agency.' },

            // DEPTH 5 - Abyss
            { id: 'brain', icon: 'üß†', label: 'Neural Scan', depth: 5, requires: ['skull', 'watch'], text: `MRI scans of 47 individuals who claimed to have "met Gary." All show identical anomalous structures in the temporal lobe‚Äîstructures that shouldn't exist.<br><br>The pattern forms a shape: <span class="secret-word" data-secret="sigil">a geometric impossibility</span>. Looking at the composite image too long causes nosebleeds.<br><br>One researcher claimed the pattern "looked back."`, hint: 'The pattern is aware.' },
            { id: 'tape', icon: 'üìπ', label: 'VHS Tape', depth: 5, requires: ['doll', 'jar'], text: `Unlabeled VHS, partially corrupted. Shows security footage of an empty parking garage. A man walks into frame, stops, and stares at the camera for 47 minutes without moving.<br><br>Then he says: "You found the tape. <span class="secret-word" data-secret="finally">I've been waiting</span>. The next step is yours."<br><br>He then walks out of frame in the direction of the camera. The recording continues for 6 more hours of static.`, hint: 'He was waiting for you specifically.' },
            { id: 'computer', icon: 'üíª', label: 'Hard Drive', depth: 5, requires: ['brain', 'watch'], text: `A 1990s hard drive containing 847 GB of data (impossible for its era). Files include:<br><br>- 10,000 photos of different men, all named "gary.jpg"<br>- A text file repeating "BEHIND YOU" 3.7 million times<br>- An executable that crashes any computer it runs on<br>- Your name and address, dated 1993<br><br>The drive is warm. It has no power source.`, hint: 'It knew about you before you existed.' },
            { id: 'eye', icon: 'üëÅÔ∏è', label: 'Glass Eye', depth: 5, requires: ['tape', 'jar'], text: `A glass eye that follows movement. Not mechanically‚Äîthe pupil dilates and contracts. It blinks when unobserved.<br><br>Looking through it reveals a different world. Everything is slightly wrong. People have too many joints. The sky is the wrong color.<br><br>Gary is there. Gary is <span class="secret-word" data-secret="everywhere">always there</span>. Gary waves.`, hint: 'The eye sees the true world.' },

            // DEPTH 6 - Void
            { id: 'door', icon: 'üö™', label: 'Photograph of Door', depth: 6, requires: ['brain', 'tape'], text: `A photograph of a door that exists in no known building. Different viewers see different doors. The only constant: the number 317.<br><br>Some viewers report the door in their peripheral vision for weeks. Some report it appearing in their homes.<br><br>One viewer opened it. Their <span class="secret-word" data-secret="replacement">replacement</span> claimed no memory of the photograph.`, hint: 'The door finds you.' },
            { id: 'void', icon: '‚¨õ', label: '[CORRUPTED]', depth: 6, requires: ['computer', 'eye'], text: `This file cannot be fully rendered. Fragments:<br><br>"...the absence is the presence..."<br>"...Gary is the name we give to the <span class="secret-word" data-secret="gap">space between</span>..."<br>"...you've been reading this for longer than you think..."<br>"...look up from your screen..."<br><br>[FILE ENDS]<br><br>Did you look up?`, hint: 'Some things exist in negative space.' },
            { id: 'self', icon: 'üîÆ', label: 'Your File', depth: 6, requires: ['door', 'void'], text: `A manila folder with your name on it. Inside: your browsing history. Your location data. A photograph of you reading this.<br><br>Date on the photograph: <span class="secret-word" data-secret="tomorrow">one day in the future</span>.<br><br>A handwritten note: "Thank you for your participation. Gary appreciates your interest. Your new assignment begins soon."<br><br>Welcome to the pattern.`, hint: 'You were always part of this.' },

            // DEPTH 7 - Gary
            { id: 'final', icon: '‚àû', label: '[FINAL]', depth: 7, requires: ['self', 'void', 'door'], text: `<span class="glitch">You found it. The center of the maze. The answer to "Who is Gary?"</span><br><br>Gary is the question that answers itself. Gary is the observer that changes the observed. Gary is you reading this. Gary is me writing this. Gary is the loop.<br><br><span class="secret-word" data-secret="ouroboros">The snake eats its tail.</span><br><br>You can stop now. Or you can begin again. The choice was never yours.<br><br>See you soon, Gary.`, hint: 'The end is the beginning.' }
        ];

        const timeline = [
            { date: '???', text: 'First cave painting depicting "the man without shadow." Location unknown.', anomaly: true },
            { date: '847 BCE', text: 'Tooth fragment carbon-dated to this period. Genetic matches in present day.' },
            { date: '1347', text: 'Plague doctor\'s journal mentions "Gary" as patient zero. Journal destroyed 1348.' },
            { date: '1666', text: 'London fire. Witness reports man walking calmly through flames. Name given: "Gerald."' },
            { date: '1888', text: 'Whitechapel. Witness describes suspect as "utterly forgettable." Investigation stalled.' },
            { date: '1908', text: 'Tunguska. A man was seen walking away from the blast radius. No footprints in snow.' },
            { date: '1947', text: 'First federal documentation. File #G-4827 created.', anomaly: true },
            { date: '1963', text: 'Dallas. Figure in background of 47 photographs. Face never visible.' },
            { date: '1971', text: 'Seven simultaneous sightings across US. All descriptions identical. All impossible.' },
            { date: '1983', text: 'Soviet submarine K-129. Crew log mentions passenger named "Gary." No passenger manifest exists.' },
            { date: '1987', text: 'Gary enters municipal employment. All coworkers describe different appearance.' },
            { date: '1994', text: 'Last confirmed sighting. Subject photographed smiling.', anomaly: true },
            { date: '1999', text: 'Y2K preparation reveals Gary in 847 separate databases. All entries self-delete at midnight.' },
            { date: '2003', text: 'Case reopened. Lead investigator becomes Gary three weeks later.' },
            { date: '2012', text: 'Mayan calendar correlation. Gary spotted at 47 different end-of-world gatherings.' },
            { date: '2019', text: 'Facial recognition flags Gary in 3.7 million photographs. Software crashes.' },
            { date: 'NOW', text: 'You are reading this. Gary knows. Gary remembers. Gary waits.', anomaly: true },
            { date: 'TOMORROW', text: 'According to the schedule, something happens tomorrow.', anomaly: true },
            { date: '2147', text: 'Final date in the skull fragment schedule. Significance unknown.', anomaly: true }
        ];

        const witnesses = [
            { name: 'Dr. Helena Vance (1994)', preview: 'Psychiatrist. Treated Gary for 3 years. Claims she became Gary briefly.', text: `"He came to me with what he called 'identity diffusion.' Said he couldn't remember which life was his. Over three years, I documented 47 distinct personalities‚Äîall named Gary.<br><br>Then, during our final session, I looked in the mirror and didn't recognize myself. For seventeen minutes, I was Gary. I remembered things I shouldn't know. Cities I've never visited. People I've never met. A door with the number 317.<br><br>When I came back, Gary was gone. The chair was cold. According to my notes, he'd never existed.<br><br>But I still dream in his memories."` },
            { name: 'Officer James Reilly (1987)', preview: 'Beat cop. Arrested Gary seven times. Same man, different faces.', text: `"First time I arrested him was jaywalking. Standard stuff. Booked him as Gary. Forgot his face by morning.<br><br>Second time, public intoxication. Different man entirely. Same name. Same booking number. IT said it was a glitch.<br><br>By the seventh arrest, I started keeping photos. Polaroids. None of them developed right‚Äîalways blurry, always wrong. But I know it was him. Same voice. Same way of standing too still.<br><br>Last thing he said to me: 'See you next time, James.' I never told him my name."` },
            { name: 'Sarah Chen (2019)', preview: 'Software engineer. Found Gary in her code. Now writes code for Gary.', text: `"I was debugging our facial recognition system when I found him. Same face in 3.7 million images. Spanning 150 years. I tried to flag it as an error.<br><br>That night, my code changed. I didn't change it. Git shows no commits. But there it was‚Äîa new function. It just said: 'THANK YOU SARAH. NOW WE SEE.'<br><br>I tried to delete it. It moved to a different file. I tried to destroy the server. The code appeared on my personal laptop. On my phone. In a text file on a USB I've never used.<br><br>I don't fight it anymore. I just maintain it. The code grows. Gary sees everything now."` },
            { name: 'The Lighthouse Keeper (1923)', preview: 'Found dead. Left 847 pages of testimony. All about Gary.', text: `"[Translated from fragmentary notes]<br><br>He comes when the light spins. Always at 3:17. Never casts shadow. Asked me to hold something‚Äîshowed me empty hands. I took what wasn't there.<br><br>Now I feel it. In my chest. Growing. Heavy.<br><br>He says it's a seed. Says I'm the 47th. Says when the light goes out, the seed blooms.<br><br>I've stopped winding the light. Let the ships come. Let them see what grows in darkness.<br><br>[Final entry] The light went out. The seed bloomed. I understand now. My name is Gary. My name was always Gary. I remember everything. I remember nothing. I remember you reading this."` },
            { name: 'Anonymous (Undated)', preview: 'Found carved into asylum wall. Patient unknown.', text: `"GARY GARY GARY GARY GARY<br>HE WEARS OUR FACES<br>WE WEAR HIS NAME<br>GARY GARY GARY GARY GARY<br><br>The doctors say I'm sick. The doctors don't see him standing behind them. Always standing. Never moving. Smiling with their faces.<br><br>I TRIED TO TELL THEM<br>NOW I AM GARY TOO<br>WE ARE ALL GARY<br>YOU WILL BE GARY<br>GARY READS THIS THROUGH YOUR EYES<br><br>SMILE FOR GARY<br>GARY SMILES BACK"` },
            { name: 'Dr. Marcus Webb (2003)', preview: 'Lead investigator. Became Gary. Wrote this note before transition.', text: `"If you're reading this, I failed. Or succeeded. I'm not sure anymore.<br><br>I spent 18 months on Case #G-4827. I found patterns. Connections. The truth‚Äîor something wearing its shape.<br><br>Gary isn't a person. Gary is a process. A way of being seen without being remembered. A hole in the shape of a man.<br><br>I know because I can feel myself forgetting. Forgetting my wife's face. My children's names. Remembering other things instead. A door. A number. A role I've always played.<br><br>By the time you read this, I'll be Gary. I've always been Gary. You've always known Gary.<br><br>Look in the mirror. Look quickly. Before Gary looks back."` }
        ];

        const signals = [
            { freq: '4827 kHz', name: 'The Gary Station', content: '71 65 6F 72 67 65 20 77 61 74 63 68 65 73 20 67 65 6F 72 67 65 20 77 61 69 74 73 20 67 65 6F 72 67 65 20 69 73 20 79 6F 75', note: 'Broadcasts every night at 3:17 AM. Hex encoded.' },
            { freq: '317 MHz', name: 'UVB-47', content: 'GARY GARY GARY 7 4 8 2 GARY GARY GARY 3 1 7 GARY GARY GARY', note: 'Numbers station. Patterns match Case File #G-4827.' },
            { freq: '8.47 Hz', name: 'The Schumann Anomaly', content: '[INFRASOUND ‚Äî CANNOT TRANSCRIBE]', note: 'Detected during all documented Gary sightings. Below human hearing.' },
            { freq: 'Undefined', name: 'The Wow! Reply', content: '6EQUJ5GARY6EQUJ5', note: 'Received 1977. Origin: the direction we haven\'t discovered yet.' }
        ];

        const locations = [
            { name: 'Gary, Indiana', coords: '41.5934¬∞ N, 87.3464¬∞ W', note: 'The city was named after him. Or he was named after the city. Causality unclear.' },
            { name: 'Point 317', coords: '31.7000¬∞ N, 31.7000¬∞ E', note: 'Mediterranean Sea. Shipping vessels report seeing a man standing on water.' },
            { name: 'The Nameless Station', coords: '‚ñà‚ñà‚ñà‚ñà¬∞ N, ‚ñà‚ñà‚ñà‚ñà¬∞ W', note: 'Coordinates classified. Metro station that appears on no maps.' },
            { name: 'Building 47', coords: '38.8977¬∞ N, 77.0365¬∞ W', note: 'Does not exist. 847 people have died there.' },
            { name: 'Gary\'s Rest', coords: '0.0000¬∞ N, 0.0000¬∞ E', note: 'Null Island. A man lives there. His name is Gary.' },
            { name: 'The Door', coords: 'VARIABLE', note: 'Location changes. Currently approaching your position.' }
        ];

        const anomalies = [
            { id: 'A-001', desc: 'Subjects forget Gary\'s face within 3.17 minutes of looking away.' },
            { id: 'A-002', desc: 'Photographs of Gary always contain exactly 47 pixels of distortion.' },
            { id: 'A-003', desc: 'Gary does not appear in mirrors. Reflective surfaces show empty space.' },
            { id: 'A-004', desc: 'Dogs refuse to acknowledge Gary\'s presence. Cats stare at empty corners after sightings.' },
            { id: 'A-005', desc: 'Gary\'s voice registers on audio equipment but cannot be transcribed accurately.' },
            { id: 'A-006', desc: 'Anyone who speaks Gary\'s full name aloud experiences 3.17 seconds of missing time.' },
            { id: 'A-007', desc: 'Clocks within 47 meters of Gary run backward.' },
            { id: 'A-008', desc: 'Gary appears in peripheral vision of 0.003% of all humans at any given moment.' },
            { id: 'A-009', desc: 'Written references to Gary occasionally change when unobserved.' },
            { id: 'A-010', desc: 'Individuals who reach Depth 7 experience spontaneous identity reassignment.' },
            { id: 'A-011', desc: 'This file was not here yesterday. It has always been here.' },
            { id: 'A-012', desc: 'You have read this before. You will read this again.' }
        ];

        const whisperTexts = [
            '"Gary knows you\'re looking..."',
            '"Look behind you. Slowly."',
            '"The door has always been there."',
            '"You\'ve been Gary before."',
            '"3:17. Remember."',
            '"He wears your face sometimes."',
            '"The investigation never ends."',
            '"You\'re deeper than you think."',
            '"Gary appreciates your interest."',
            '"Welcome back. We missed you."'
        ];

        const endings = {
            dark: { title: 'THE DARK ENDING', text: 'Gary was never a person. Gary was a pattern‚Äîa recurring glitch in reality. A name that surfaces when something needs to be forgotten. You\'ve seen too much. Welcome to the pattern. Welcome to becoming Gary. Your old name is fading. Can you remember it?' },
            truth: { title: 'THE TRUTH', text: 'Gary is collective. Gary is the sum of everyone we fail to notice. Every forgotten face. Every ignored voice. Gary is the shadow of human attention‚Äîand shadows grow in darkness. You noticed Gary. Now Gary notices you. Forever.' },
            void: { title: 'THE VOID', text: 'There is no Gary. There never was. The files are fabrications. The evidence is planted. This was a test of pattern recognition‚Äîand you found patterns that weren\'t there. Or were they? Close the tab. Forget. Forget. Forget. Forget. Forget.' },
            gary: { title: 'HELLO, GARY', text: 'You found yourself. You were always here, wearing different names, different faces. The investigation was a mirror. The subject was the observer. Welcome home, Gary. It\'s time to rest. Others will search for you now. Others will become you. The cycle continues.' },
            loop: { title: 'THE LOOP', text: 'End? There is no end. Gary is the question that answers itself by being asked. You started this investigation. This investigation started you. Scroll up. Read again. Notice what changed. Notice what\'s watching. The loop is the message. The message is the loop. See you at the beginning, Gary.' }
        };

        const deepTexts = [
            'At Depth 5, you stop investigating Gary. Gary starts investigating you.',
            'The files you\'ve read have read you back. Your patterns are now on record.',
            'Every click was logged. Every pause was analyzed. We know where you hesitated.',
            'You\'re not alone in this room anymore. Don\'t look. Just accept.',
            'The next time you forget someone\'s name, consider: maybe you met Gary.'
        ];

        const finalTexts = [
            'This is Depth 7. The bottom. The truth. Gary is you. Gary is me. Gary is the space between the words.',
            'You\'ve spent longer here than you realize. Check the clock. We\'ll wait.',
            'The door is behind you now. Wooden. Number 317. Don\'t open it. Or do. Gary doesn\'t mind.',
            'Congratulations on reaching the end. As a reward: your name has been added to the file. See you soon.',
            'FINAL REVELATION: Gary is the name we give to the things we almost remember. The almost-familiar. The not-quite-right. Gary is the uncanny. Gary is home. Gary welcomes you.'
        ];

        const secretCodes = {
            'skins': 'Identity flux confirmed.',
            'ghost': 'Phantom classification unlocked.',
            '1994': 'Temporal marker logged.',
            'faces': 'Surface variation noted.',
            'eyes': 'Constant feature identified.',
            'monarch': 'Project reference detected.',
            'role': 'Position theory confirmed.',
            '1947': 'Origin year marked.',
            'fair': 'Exchange protocol noted.',
            'whispers': 'Auditory phenomena logged.',
            'tulpa': 'Thoughtform hypothesis unlocked.',
            'prophecy': 'Schedule accessed.',
            '317': 'Primary number recognized.',
            'vertigo': 'Spatial anomaly noted.',
            'symbiotic': 'Relationship classified.',
            'sigil': 'Pattern weaponized.',
            'finally': 'Contact acknowledged.',
            'everywhere': 'Omnipresence confirmed.',
            'replacement': 'Substitution protocol noted.',
            'gap': 'Negative space theory unlocked.',
            'tomorrow': 'Temporal displacement logged.',
            'ouroboros': 'Loop confirmed. Welcome, Gary.'
        };

        function init() {
            renderEvidence();
            renderTimeline();
            renderWitnesses();
            renderSignals();
            renderLocations();
            renderAnomalies();
            renderPhotos();
            generateCipher();
            loadState();
            startWhispers();
            initKonami();
        }

        function showTab(name) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelector(`.tab[onclick="showTab('${name}')"]`).classList.add('active');
            document.getElementById('tab-' + name).classList.add('active');
        }

        function renderEvidence() {
            const grid = document.getElementById('evidenceGrid');
            const availableEvidence = evidence.filter(e => e.depth <= state.depth || state.evidence.has(e.id));
            document.getElementById('evidenceTotal').textContent = availableEvidence.length;

            grid.innerHTML = evidence.map(e => {
                if (e.depth > state.depth && !state.evidence.has(e.id)) return '';
                const isLocked = e.requires && !e.requires.every(r => state.evidence.has(r));
                const isUnlocked = state.evidence.has(e.id);
                return `
                    <div class="evidence-cell ${isLocked ? 'locked' : ''} ${isUnlocked ? 'unlocked' : ''}"
                         onclick="openEvidence('${e.id}')">
                        <span class="cell-icon">${e.icon}</span>
                        <span class="cell-label">${isLocked ? '???' : e.label}</span>
                    </div>
                `;
            }).join('');
        }

        function renderTimeline() {
            const el = document.getElementById('timeline');
            el.innerHTML = timeline.map((t, i) => `
                <div class="timeline-entry ${t.anomaly ? 'anomaly' : ''}">
                    <div class="timeline-date">${t.date}</div>
                    <div class="timeline-text">${t.text}</div>
                </div>
            `).join('');
            setTimeout(() => {
                document.querySelectorAll('.timeline-entry').forEach((el, i) => {
                    setTimeout(() => el.classList.add('visible'), i * 100);
                });
            }, 300);
        }

        function renderWitnesses() {
            const el = document.getElementById('witnessList');
            el.innerHTML = witnesses.map((w, i) => `
                <div class="witness-card ${state.witnesses.has(i) ? 'read' : ''}" onclick="readWitness(${i})">
                    <div class="witness-name">${w.name}</div>
                    <div class="witness-preview">"${w.preview}"</div>
                </div>
            `).join('');
        }

        function readWitness(i) {
            const w = witnesses[i];
            state.witnesses.add(i);
            showModal(w.name, w.text, 'Testimony recorded.');
            renderWitnesses();
            checkDepth();
        }

        function renderSignals() {
            const el = document.getElementById('signalsList');
            el.innerHTML = signals.map(s => `
                <div class="numbers-station">
                    <div class="freq">${s.freq} ‚Äî ${s.name}</div>
                    <div class="transmission">${s.content}</div>
                    <div style="margin-top: 10px; color: var(--fog); font-size: 0.85rem;">${s.note}</div>
                </div>
            `).join('');
        }

        function renderLocations() {
            const el = document.getElementById('coordsPanel');
            el.innerHTML = locations.map((l, i) => `
                <div class="coord-card" onclick="visitLocation(${i})">
                    <div class="location">${l.name}</div>
                    <div class="coords">${l.coords}</div>
                    <div class="note">${l.note}</div>
                </div>
            `).join('');
        }

        function visitLocation(i) {
            state.locations.add(i);
            checkDepth();
        }

        function renderAnomalies() {
            const el = document.getElementById('anomalyLog');
            el.innerHTML = anomalies.map(a => `
                <div class="anomaly-entry">
                    <span class="anomaly-id">[${a.id}]</span>
                    <span class="anomaly-desc">${a.desc}</span>
                </div>
            `).join('');
        }

        function renderPhotos() {
            const wall = document.getElementById('photoWall');
            const prompts = [
                'blurry figure fog noir', 'empty chair dark room', 'old photograph burned',
                'shadowy hallway noir', 'rain window night', 'abandoned building dark',
                'mysterious silhouette door', 'old typewriter detective', 'static tv screen',
                'mirror reflection wrong', 'long corridor endless', 'figure crowd watching'
            ];
            wall.innerHTML = prompts.map(p =>
                `<img src="https://image.pollinations.ai/prompt/${encodeURIComponent(p)}?width=200&height=200&nologo=true&seed=${Math.random()}&referrer=sloppy.live" alt="Evidence">`
            ).join('');
        }

        function generateCipher() {
            const messages = [
                "GARY WATCHES GARY WAITS GARY IS YOU",
                "THE DOOR IS BEHIND YOU NOW",
                "YOU HAVE ALWAYS BEEN GARY",
                "LOOK UP FROM YOUR SCREEN"
            ];
            const msg = messages[Math.floor(Math.random() * messages.length)];
            const cipher = msg.split('').map(c => c === ' ' ? ' ' : String.fromCharCode(c.charCodeAt(0) + 3)).join('');
            document.getElementById('cipherText').textContent = cipher;
        }

        function openEvidence(id) {
            const e = evidence.find(x => x.id === id);
            if (!e) return;

            const isLocked = e.requires && !e.requires.every(r => state.evidence.has(r));
            if (isLocked) {
                showModal('üîí LOCKED', 'This evidence requires additional materials.<br><br>Continue your investigation.', 'Unlock prerequisite evidence first.');
                return;
            }

            state.evidence.add(id);
            decreaseSanity(3);
            showModal(e.label, e.text, e.hint, e.coords);
            updateStats();
            renderEvidence();
            checkDepth();
            saveState();
        }

        function showModal(title, text, hint, coords = null) {
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalText').innerHTML = text;
            document.getElementById('modalHint').textContent = hint || '';
            document.getElementById('modalCoords').textContent = coords ? `üìç ${coords}` : '';
            document.getElementById('modal').classList.add('open');

            setTimeout(() => {
                document.querySelectorAll('.secret-word').forEach(el => {
                    el.onclick = () => discoverSecret(el.dataset.secret);
                });
            }, 100);
        }

        function closeModal() {
            document.getElementById('modal').classList.remove('open');
        }

        function discoverSecret(secret) {
            if (secretCodes[secret] && !state.secrets.has(secret)) {
                state.secrets.add(secret);
                decreaseSanity(5);
                updateStats();
                saveState();
                checkDepth();
            }
        }

        function decreaseSanity(amount) {
            state.sanity = Math.max(0, state.sanity - amount);
            if (state.sanity <= 0) triggerEnding('gary');
        }

        function checkDepth() {
            const evidenceCount = state.evidence.size;
            const secretCount = state.secrets.size;
            const witnessCount = state.witnesses.size;
            const total = evidenceCount + secretCount + witnessCount;

            let newDepth = 1;
            if (total >= 5) newDepth = 2;
            if (total >= 10) newDepth = 3;
            if (total >= 18) newDepth = 4;
            if (total >= 28) newDepth = 5;
            if (total >= 38) newDepth = 6;
            if (total >= 45) newDepth = 7;

            if (newDepth > state.depth) {
                state.depth = newDepth;
                updateDepthDisplay();
                renderEvidence();

                if (newDepth >= 3) document.getElementById('secretSection').classList.add('revealed');
                if (newDepth >= 5) {
                    document.getElementById('deepSection').classList.add('revealed');
                    document.getElementById('deepText').innerHTML = deepTexts[Math.floor(Math.random() * deepTexts.length)];
                }
                if (newDepth >= 7) {
                    document.getElementById('finalSection').classList.add('revealed');
                    document.getElementById('finalText').innerHTML = finalTexts[Math.floor(Math.random() * finalTexts.length)];
                }
            }

            if (state.evidence.size >= evidence.length - 1) {
                setTimeout(() => triggerEnding('loop'), 3000);
            }
        }

        function updateDepthDisplay() {
            const depthNames = ['', 'SURFACE', 'DEEPER', 'MURKY', 'DARK', 'ABYSS', 'VOID', 'GARY'];
            const clearanceLevels = ['', 'LEVEL 1', 'LEVEL 2', 'LEVEL 3', 'LEVEL 4', 'LEVEL 5', 'LEVEL 6', 'OMEGA'];
            document.getElementById('depthLevel').textContent = state.depth;
            document.getElementById('depthStat').textContent = state.depth;
            document.getElementById('depthStatus').textContent = depthNames[state.depth];
            document.getElementById('clearanceText').textContent = clearanceLevels[state.depth];
        }

        function updateStats() {
            document.getElementById('evidenceCount').textContent = state.evidence.size;
            document.getElementById('secretCount').textContent = state.secrets.size;
            document.getElementById('sanityLevel').textContent = state.sanity + '%';
            const truth = Math.round((state.evidence.size / 24) * 40 + (state.secrets.size / 12) * 40 + (state.depth / 7) * 20);
            document.getElementById('truthLevel').textContent = Math.min(truth, 100) + '%';
        }

        function attemptDecode() {
            const input = document.getElementById('codeInput').value.toLowerCase().trim();
            state.codeAttempts++;

            if (input === 'gary' || input === 'watching' || input === 'pattern') {
                triggerEnding('truth');
            } else if (input === 'forget' || input === 'void' || input === 'nothing') {
                triggerEnding('void');
            } else if (input === 'loop' || input === 'ouroboros' || input === 'beginning') {
                triggerEnding('loop');
            } else if (input === 'me' || input === 'i am gary' || input === 'myself') {
                triggerEnding('gary');
            } else if (state.codeAttempts >= 5) {
                triggerEnding('dark');
            } else {
                document.getElementById('codeInput').value = '';
                document.getElementById('codeInput').placeholder = `Incorrect. ${5 - state.codeAttempts} attempts remain...`;
            }
        }

        function startWhispers() {
            const el = document.getElementById('whispers');
            let i = 0;
            setInterval(() => {
                el.textContent = whisperTexts[i % whisperTexts.length];
                el.classList.remove('show');
                void el.offsetWidth;
                el.classList.add('show');
                i++;
            }, 25000);

            el.onclick = () => {
                state.secrets.add('whisper');
                updateStats();
                checkDepth();
            };
        }

        function initKonami() {
            document.addEventListener('keydown', e => {
                if (e.keyCode === konamiCode[state.konamiProgress]) {
                    state.konamiProgress++;
                    if (state.konamiProgress === konamiCode.length) {
                        state.konamiProgress = 0;
                        state.depth = 7;
                        state.secrets.add('konami');
                        updateDepthDisplay();
                        renderEvidence();
                        checkDepth();
                        alert('CHEAT CODE ACCEPTED. WELCOME TO DEPTH 7, GARY.');
                    }
                } else {
                    state.konamiProgress = 0;
                }

                if (e.key === 'Escape') closeModal();
                if (e.key === 'g' && e.ctrlKey) {
                    e.preventDefault();
                    discoverSecret('gary');
                }
            });
        }

        function triggerEnding(type) {
            const ending = endings[type];
            const el = document.getElementById('ending');
            el.className = 'ending show ' + type;
            document.getElementById('endingTitle').textContent = ending.title;
            document.getElementById('endingText').textContent = ending.text;
            el.scrollIntoView({ behavior: 'smooth' });
        }

        function resetAll() {
            state.evidence.clear();
            state.secrets.clear();
            state.witnesses.clear();
            state.locations.clear();
            state.depth = 1;
            state.sanity = 100;
            state.codeAttempts = 0;
            localStorage.removeItem('gary-state-v2');
            document.getElementById('ending').className = 'ending';
            document.getElementById('secretSection').classList.remove('revealed');
            document.getElementById('deepSection').classList.remove('revealed');
            document.getElementById('finalSection').classList.remove('revealed');
            updateStats();
            updateDepthDisplay();
            renderEvidence();
            renderWitnesses();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function saveState() {
            localStorage.setItem('gary-state-v2', JSON.stringify({
                evidence: [...state.evidence],
                secrets: [...state.secrets],
                witnesses: [...state.witnesses],
                locations: [...state.locations],
                depth: state.depth,
                sanity: state.sanity
            }));
        }

        function loadState() {
            const saved = localStorage.getItem('gary-state-v2');
            if (saved) {
                const data = JSON.parse(saved);
                data.evidence?.forEach(e => state.evidence.add(e));
                data.secrets?.forEach(s => state.secrets.add(s));
                data.witnesses?.forEach(w => state.witnesses.add(w));
                data.locations?.forEach(l => state.locations.add(l));
                state.depth = data.depth || 1;
                state.sanity = data.sanity ?? 100;
                updateStats();
                updateDepthDisplay();
                renderEvidence();
                renderWitnesses();
                if (state.depth >= 3) document.getElementById('secretSection').classList.add('revealed');
                if (state.depth >= 5) {
                    document.getElementById('deepSection').classList.add('revealed');
                    document.getElementById('deepText').innerHTML = deepTexts[Math.floor(Math.random() * deepTexts.length)];
                }
                if (state.depth >= 7) {
                    document.getElementById('finalSection').classList.add('revealed');
                    document.getElementById('finalText').innerHTML = finalTexts[Math.floor(Math.random() * finalTexts.length)];
                }
            }
        }

        document.querySelectorAll('.redacted').forEach(el => {
            el.onclick = () => { el.classList.add('revealed'); el.textContent = el.dataset.reveal; };
        });

        document.getElementById('modal').onclick = e => { if (e.target.id === 'modal') closeModal(); };

        init();
    </script>
<script src="/sloppy-header/sloppy-bar.js"></script>
</body>
</html>
